# 排序参数同步到地址栏测试文档

## 功能说明

现在 `sort_by` 和 `sort_order` 参数会通过 query 同步到地址栏上，支持：
1. 用户可以通过URL直接访问特定的排序状态
2. 支持浏览器的前进后退功能
3. 排序状态在页面刷新后保持

## 测试步骤

### 1. 基础排序测试
1. 打开角色列表页面
2. 点击表格列头的排序按钮（如价格列）
3. 观察地址栏是否出现 `?sort_by=price&sort_order=ASC` 或 `?sort_by=price&sort_order=DESC`
4. 再次点击排序按钮，观察排序方向是否改变，地址栏参数是否更新

### 2. 多列排序测试
1. 先对价格列进行排序
2. 再对等级列进行排序
3. 观察地址栏是否显示 `?sort_by=price,level&sort_order=ASC,DESC` 格式的参数

### 3. 路由同步测试
1. 设置排序后，复制当前URL
2. 在新标签页中打开该URL
3. 验证排序状态是否正确恢复

### 4. 浏览器前进后退测试
1. 设置排序状态A
2. 改变排序状态B
3. 点击浏览器后退按钮
4. 验证是否回到排序状态A

### 5. 重置功能测试
1. 设置排序状态
2. 点击重置按钮
3. 验证地址栏中的排序参数是否被清除

### 6. 其他操作保持排序测试
1. 设置排序状态
2. 进行搜索、翻页、改变等级范围等操作
3. 验证排序状态是否保持

## 预期结果

- ✅ 排序变化时，地址栏query参数同步更新
- ✅ 通过URL访问时，排序状态正确恢复
- ✅ 浏览器前进后退功能正常工作
- ✅ 重置功能清除排序参数
- ✅ 其他操作不影响排序状态

## 注意事项

- 排序参数使用 `sort_by` 和 `sort_order` 作为query参数名
- 多列排序用逗号分隔，如：`sort_by=price,level&sort_order=ASC,DESC`
- 使用 `$router.replace` 避免在浏览器历史中创建新记录
- 所有路由更新操作都会保持当前的排序参数
- **安全机制**: 只有当路由参数真正发生变化时才会更新路由，避免不必要的路由更新和潜在错误
- **工具方法**: 使用 `safeRouteUpdate()` 和 `hasRouteChanges()` 方法确保路由更新的安全性 