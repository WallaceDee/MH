(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[14],{1488:function(t){!function(e,a){t.exports=a()}(0,function(){"use strict";var t=1e3,e=6e4,a=36e5,i="millisecond",r="second",n="minute",s="hour",o="day",l="week",c="month",u="quarter",d="year",p="date",f="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],a=t%100;return"["+t+(e[(a-20)%10]||e[a]||e[0])+"]"}},g=function(t,e,a){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(a)+t},v={s:g,z:function(t){var e=-t.utcOffset(),a=Math.abs(e),i=Math.floor(a/60),r=a%60;return(e<=0?"+":"-")+g(i,2,"0")+":"+g(r,2,"0")},m:function t(e,a){if(e.date()<a.date())return-t(a,e);var i=12*(a.year()-e.year())+(a.month()-e.month()),r=e.clone().add(i,c),n=a-r<0,s=e.clone().add(i+(n?-1:1),c);return+(-(i+(a-r)/(n?r-s:s-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:d,w:l,d:o,D:p,h:s,m:n,s:r,ms:i,Q:u}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},y="en",w={};w[y]=_;var b="$isDayjsObject",$=function(t){return t instanceof D||!(!t||!t[b])},x=function t(e,a,i){var r;if(!e)return y;if("string"==typeof e){var n=e.toLowerCase();w[n]&&(r=n),a&&(w[n]=a,r=n);var s=e.split("-");if(!r&&s.length>1)return t(s[0])}else{var o=e.name;w[o]=e,r=o}return!i&&r&&(y=r),r||!i&&y},S=function(t,e){if($(t))return t.clone();var a="object"==typeof e?e:{};return a.date=t,a.args=arguments,new D(a)},k=v;k.l=x,k.i=$,k.w=function(t,e){return S(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var D=function(){function _(t){this.$L=x(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[b]=!0}var g=_.prototype;return g.parse=function(t){this.$d=function(t){var e=t.date,a=t.utc;if(null===e)return new Date(NaN);if(k.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var i=e.match(h);if(i){var r=i[2]-1||0,n=(i[7]||"0").substring(0,3);return a?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,n)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,n)}}return new Date(e)}(t),this.init()},g.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},g.$utils=function(){return k},g.isValid=function(){return!(this.$d.toString()===f)},g.isSame=function(t,e){var a=S(t);return this.startOf(e)<=a&&a<=this.endOf(e)},g.isAfter=function(t,e){return S(t)<this.startOf(e)},g.isBefore=function(t,e){return this.endOf(e)<S(t)},g.$g=function(t,e,a){return k.u(t)?this[e]:this.set(a,t)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(t,e){var a=this,i=!!k.u(e)||e,u=k.p(t),f=function(t,e){var r=k.w(a.$u?Date.UTC(a.$y,e,t):new Date(a.$y,e,t),a);return i?r:r.endOf(o)},h=function(t,e){return k.w(a.toDate()[t].apply(a.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(e)),a)},m=this.$W,_=this.$M,g=this.$D,v="set"+(this.$u?"UTC":"");switch(u){case d:return i?f(1,0):f(31,11);case c:return i?f(1,_):f(0,_+1);case l:var y=this.$locale().weekStart||0,w=(m<y?m+7:m)-y;return f(i?g-w:g+(6-w),_);case o:case p:return h(v+"Hours",0);case s:return h(v+"Minutes",1);case n:return h(v+"Seconds",2);case r:return h(v+"Milliseconds",3);default:return this.clone()}},g.endOf=function(t){return this.startOf(t,!1)},g.$set=function(t,e){var a,l=k.p(t),u="set"+(this.$u?"UTC":""),f=(a={},a[o]=u+"Date",a[p]=u+"Date",a[c]=u+"Month",a[d]=u+"FullYear",a[s]=u+"Hours",a[n]=u+"Minutes",a[r]=u+"Seconds",a[i]=u+"Milliseconds",a)[l],h=l===o?this.$D+(e-this.$W):e;if(l===c||l===d){var m=this.clone().set(p,1);m.$d[f](h),m.init(),this.$d=m.set(p,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},g.set=function(t,e){return this.clone().$set(t,e)},g.get=function(t){return this[k.p(t)]()},g.add=function(i,u){var p,f=this;i=Number(i);var h=k.p(u),m=function(t){var e=S(f);return k.w(e.date(e.date()+Math.round(t*i)),f)};if(h===c)return this.set(c,this.$M+i);if(h===d)return this.set(d,this.$y+i);if(h===o)return m(1);if(h===l)return m(7);var _=(p={},p[n]=e,p[s]=a,p[r]=t,p)[h]||1,g=this.$d.getTime()+i*_;return k.w(g,this)},g.subtract=function(t,e){return this.add(-1*t,e)},g.format=function(t){var e=this,a=this.$locale();if(!this.isValid())return a.invalidDate||f;var i=t||"YYYY-MM-DDTHH:mm:ssZ",r=k.z(this),n=this.$H,s=this.$m,o=this.$M,l=a.weekdays,c=a.months,u=a.meridiem,d=function(t,a,r,n){return t&&(t[a]||t(e,i))||r[a].slice(0,n)},p=function(t){return k.s(n%12||12,t,"0")},h=u||function(t,e,a){var i=t<12?"AM":"PM";return a?i.toLowerCase():i};return i.replace(m,function(t,i){return i||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return k.s(e.$y,4,"0");case"M":return o+1;case"MM":return k.s(o+1,2,"0");case"MMM":return d(a.monthsShort,o,c,3);case"MMMM":return d(c,o);case"D":return e.$D;case"DD":return k.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return d(a.weekdaysMin,e.$W,l,2);case"ddd":return d(a.weekdaysShort,e.$W,l,3);case"dddd":return l[e.$W];case"H":return String(n);case"HH":return k.s(n,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return h(n,s,!0);case"A":return h(n,s,!1);case"m":return String(s);case"mm":return k.s(s,2,"0");case"s":return String(e.$s);case"ss":return k.s(e.$s,2,"0");case"SSS":return k.s(e.$ms,3,"0");case"Z":return r}return null}(t)||r.replace(":","")})},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(i,p,f){var h,m=this,_=k.p(p),g=S(i),v=(g.utcOffset()-this.utcOffset())*e,y=this-g,w=function(){return k.m(m,g)};switch(_){case d:h=w()/12;break;case c:h=w();break;case u:h=w()/3;break;case l:h=(y-v)/6048e5;break;case o:h=(y-v)/864e5;break;case s:h=y/a;break;case n:h=y/e;break;case r:h=y/t;break;default:h=y}return f?h:k.a(h)},g.daysInMonth=function(){return this.endOf(c).$D},g.$locale=function(){return w[this.$L]},g.locale=function(t,e){if(!t)return this.$L;var a=this.clone(),i=x(t,e,!0);return i&&(a.$L=i),a},g.clone=function(){return k.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},_}(),M=D.prototype;return S.prototype=M,[["$ms",i],["$s",r],["$m",n],["$H",s],["$W",o],["$M",c],["$y",d],["$D",p]].forEach(function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),S.extend=function(t,e){return t.$i||(t(e,D,S),t.$i=!0),S},S.locale=x,S.isDayjs=$,S.unix=function(t){return S(1e3*t)},S.en=w[y],S.Ls=w,S.p={},S})},3152:function(t,e,a){"use strict";a.d(e,{h:function(){return i}});a(8111),a(2489),a(7588),a(1701);const i={methods:{getSkillImage(t=0){if(0===t)return"";const e=t.toString().padStart(4,"0");return`https://cbg-xyq.res.netease.com/images/skill/${e}.gif`},parsePetInfo(t){const e=window.parse_desc_info(t),a=this.parse_fashang_fafang(t),i=window.get_pet_attrs_info(e,{only_basic_attr:!1,fashang:a.fashang,fafang:a.fafang});return i},parse_fashang_fafang(t){try{const e=JSON.decode(window.decode_desc(t));return{fashang:e.fashang,fafang:e.fafang}}catch(e){return{}}},formatSkills({petData:t},e=2,a=8){try{const i=document.createElement("div"),{pet_tip_skill_grid:r}=window.show_pet_skill_in_grade(t.all_skill,t.sp_skill,e,a,{pet_skill_url:"https://cbg-xyq.res.netease.com/images/skill/",notice_node_name:"pet_tip_notice_msg",skill_panel_name:"pet_tip_skill_grid",enhance_skills:[],table_class:"tb03"},t);return r.forEach(t=>{t&&i.appendChild(t)}),i.innerHTML}catch(i){return console.error("格式化技能失败:",i),""}},getEnhanceInfo(t){var e,a={pet:{skill_id_list:[571,661],is_baobao:1},search:{is_hide_unreasonable_price_equips:1}},i=a.pet||{},r=t.is_time_lock;return r=r>0||"true"==r,r&&(e=t.time_lock_days),i.time_lock=r,i.time_lock_days=e,{time_lock:t.time_lock||!1,time_lock_days:t.time_lock_days||90,is_baobao:"是"===t.petData.is_baobao||!1,skill_id_list:i.skill_id_list||[]}},formatSkillsDiff(t,e){if(!t||!e||!e.all_skill)return"";const a=e.all_skill,i=a.split("|").filter(t=>t.trim()),r=t.split("|").filter(t=>t.trim()),n=r.filter(t=>!i.includes(t));return n.length>0?"+"+n.map(t=>window.CBG_GAME_CONFIG.xyq_pet_skills[t]).join("|"):""},formatTexing(t){if(!t)return"";try{const e=JSON.parse(t);return e.name||""}catch(e){return""}}}}},5782:function(t,e,a){"use strict";a.d(e,{A:function(){return f}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"batch-valuation-result",style:t.$attrs.style},[t.loading?e("div",{staticClass:"skeleton-container"},[e("el-skeleton",{attrs:{rows:12,animated:""}})],1):[e("div",{staticClass:"result-item",class:t.getOverviewClass(),staticStyle:{"min-height":"unset"}},[e("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.currentTotalValue/100,title:"估价总值","value-style":{fontSize:"28px",fontWeight:"bold"}}},[e("template",{slot:"formatter"},[e("span",{domProps:{innerHTML:t._s(t.formatPrice(t.currentTotalValue))}})])],2)],1),e("el-col",{attrs:{span:6}},[e("el-statistic",{attrs:{"group-separator":",",precision:0,value:t.successCount,title:"成功估价","value-style":{fontSize:"28px",fontWeight:"bold",color:"#67c23a"}}},[e("template",{slot:"suffix"},[e("span",{staticStyle:{color:"#909399","font-size":"16px"}},[t._v("/ "+t._s(t.totalCount))])])],2)],1)],1)],1),e("el-row",{staticStyle:{"flex-wrap":"wrap"},attrs:{type:"flex"}},t._l(t.currentList,function(a,i){return e("el-col",{key:a.equip_sn||i,staticClass:"result-item",class:t.getResultItemClass(a),attrs:{span:t.colSpan}},[e("el-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[e("el-col",{staticStyle:{width:"50px"}},[e("EquipmentImage",{attrs:{placement:"top",image:!1,equipment:t.getEquipImageProps(a),"lock-type":a.lock_type,size:"small",popoverWidth:300}})],1),e("el-col",{staticClass:"price-info",staticStyle:{width:"calc(100% - 50px)"}},[e("el-statistic",{attrs:{"value-style":t.getPriceStyle(a.confidence)}},[e("template",{slot:"formatter"},[e("span",{domProps:{innerHTML:t._s(t.formatPrice(a.estimated_price))}})])],2)],1)],1),e("div",{staticClass:"result-footer"},[e("SimilarEquipmentModal",{key:a.equip_sn,attrs:{equipment:a,"similar-data":t.similarData},on:{"valuation-updated":e=>t.handleValuationUpdated(e,i)}},[e("el-link",{staticStyle:{"font-weight":"bold"},attrs:{href:"javascript:void(0)",type:"primary"}},[t._v(t._s(a.name||`装备 ${i+1}`))])],1),a.error?e("el-tag",{attrs:{type:"danger",title:a.error}},[t._v("估价失败")]):e("el-tag",{attrs:{type:t.getConfidenceTagType(a.confidence)}},[t._v(" 置信度: "+t._s((100*a.confidence).toFixed(1))+"% ")])],1),e("div",{staticClass:"equip-tag-info"},[t.getEquipGemInfoAndBlueBlock(a.cDesc).gemLevel?e("el-tag",{attrs:{type:"success"}},[t._v(t._s(t.getEquipGemInfoAndBlueBlock(a.cDesc).gemLevel)+"锻")]):t._e(),t._l(t.getEquipGemInfoAndBlueBlock(a.cDesc).blueBlock,function(a){return e("el-tag",{key:a,attrs:{type:"primary"}},[t._v(t._s(a))])})],2)],1)}),1)],e("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center","margin-top":"20px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$emit("close")}}},[t._v("关闭")])],1)],2)},r=[],n=(a(8111),a(2489),a(1701),a(3016)),s=a(7548),o=a(6175),l=a(8770),c={name:"EquipBatchValuationResult",props:{results:{type:Array,required:!0},equipmentList:{type:Array,required:!0},totalValue:{type:Number,default:0},valuateParams:{type:Object,required:!0},loading:{type:Boolean,default:!1},colSpan:{type:Number,default:6}},data(){return{similarData:null,currentTotalValue:0,currentList:[]}},mixins:[o.G,l.B],components:{EquipmentImage:n.A,SimilarEquipmentModal:s.A},watch:{totalValue(t){this.currentTotalValue=t},results(t){const e=t.map((t,e)=>({...t,...this.equipmentList[e],resultIndex:e})),a=e.filter(t=>1===t.confidence),i=e.filter(t=>1!==t.confidence);a.sort((t,e)=>t.estimated_price-e.estimated_price),i.sort((t,e)=>t.confidence-e.confidence),this.currentList=[...i,...a]}},computed:{totalCount(){return this.results.length},successCount(){return this.results.filter(t=>!t.error).length}},mounted(){this.currentTotalValue=this.totalValue},methods:{handleValuationUpdated(t,e){this.results[e]&&(this.currentTotalValue=this.currentTotalValue-this.results[e].estimated_price+t.estimated_price),this.$set(this.results,e,t),console.log("估价数据更新完成:",t)},getConfidenceTagType(t){return t>=.9?"success":t>=.7?"":t>=.5?"info":t>=.3?"warning":"danger"},getResultItemClass(t){if(t.error)return"error";const e=t.confidence||0;return e>=.9?"confidence-high":e>=.7?"confidence-medium":e>=.5?"confidence-low":e>=.3?"confidence-very-low":"confidence-extremely-low"},getPriceStyle(t){const e={fontSize:"18px",fontWeight:"bold",justifyContent:"end"};return!t||t<.3?{...e,color:"#f56c6c"}:t<.5?{...e,color:"#e6a23c"}:t<.7?{...e,color:"#909399"}:t<.9?{...e,color:"#409eff"}:{...e,color:"#67c23a"}},getOverviewClass(){const t=this.totalCount>0?this.successCount/this.totalCount:0;return t>=.9?"confidence-high":t>=.7?"confidence-medium":t>=.5?"confidence-low":t>=.3?"confidence-very-low":"confidence-extremely-low"}}},u=c,d=a(1656),p=(0,d.A)(u,i,r,!1,null,"98149f66",null),f=p.exports},5868:function(t,e,a){"use strict";a.d(e,{A:function(){return D}});var i=function(){var t=this,e=t._self._c;return e("el-popover",{attrs:{"data-equip-sn":t.pet.equip_sn,placement:t.placement,width:"860",trigger:"click","popper-class":"similar-pet-popper"},on:{show:t.handleShow},scopedSlots:t._u([{key:"reference",fn:function(){return[t._t("default",function(){return[e("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary"}},[t._v("查看相似")])]})]},proxy:!0}],null,!0),model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?e("div",[t.valuationLoading?e("div",{staticClass:"loading-info"},[e("el-skeleton",{attrs:{rows:12,animated:""}})],1):t.similarData?e("div",[e("div",{staticClass:"similar-header"},[e("h4",[t._v("相似召唤兽 (共"+t._s(t.similarData.anchor_count)+"个) "),e("el-divider",{attrs:{direction:"vertical"}}),e("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("相似度阈值: "+t._s(t.similarData.similarity_threshold))]),e("el-divider",{attrs:{direction:"vertical"}}),e("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("最大锚点数: "+t._s(t.similarData.max_anchors))])],1),e("PetValuation",{attrs:{valuation:t.petValuation,"target-pet":t.pet,equip_sn:t.pet.equip_sn},on:{refresh:t.refresh}}),t.similarData.statistics?e("div",{staticClass:"stats"},[e("span",[t._v(" 价格范围: "),e("span",{domProps:{innerHTML:t._s(t.formatPrice(t.similarData.statistics.price_range.min))}}),t._v(" - "),e("span",{domProps:{innerHTML:t._s(t.formatPrice(t.similarData.statistics.price_range.max))}})]),e("span",[t._v(" 平均相似度: "+t._s(t.similarData.statistics.similarity_range.avg.toFixed(3))+" ")])]):t._e()],1),t.anchorsLoading||t.similarData?.anchors?.length?e("SimilarPetTable",{directives:[{name:"loading",rawName:"v-loading",value:t.anchorsLoading,expression:"anchorsLoading"}],attrs:{anchors:t.similarData.anchors,"element-loading-text":"正在加载相似召唤兽","target-pet":t.pet}}):e("el-empty",{attrs:{description:"暂无数据"}})],1):t._e()]):t._e()])},r=[],n=(a(8111),a(1701),a(8237),function(){var t=this,e=t._self._c;return e("div",{staticClass:"valuation-info",class:t.confidenceClass},[e("el-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[e("el-row",{attrs:{type:"flex",align:"middle"}},[e("PetImage",{attrs:{pet:t.targetPet.petData,trigger:"hover",equipFaceImg:t.targetPet.equip_face_img}}),e("span",{staticStyle:{"margin-left":"10px"},domProps:{innerHTML:t._s(t.formatFullPrice(t.targetPet))}})],1),e("div",{staticStyle:{width:"170px","flex-shrink":"0"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$emit("refresh")}}},[t._v("刷新")]),e("SimilarGetMore",{attrs:{"target-equipment":t.targetPet,type:"pet"}})],1)],1),e("div",{staticClass:"valuation-main"},[e("span",{staticClass:"valuation-label"},[t._v("召唤兽估价:")]),e("span",{staticClass:"valuation-price"},[t._v(t._s(t.valuation?(t.valuation.estimated_price_yuan+t.valuation.equip_estimated_price/100).toFixed(2)+"元":"-")+" ")]),e("span",{staticClass:"valuation-strategy"},[t._v("("+t._s(t.valuation?t.getStrategyName(t.valuation.strategy):"-")+")")]),t.priceRatio?e("span",{staticClass:"price-ratio",class:t.priceRatioClass},[e("el-tag",{attrs:{type:t.priceRatioTagType,"disable-transitions":""}},[t._v(" "+t._s(t.priceRatioText)+" ")])],1):t._e()]),e("div",{staticClass:"valuation-equip"},[e("el-tag",[t._v("裸宠:￥"+t._s(t.valuation.estimated_price_yuan))]),t._v(" "),e("el-divider",{attrs:{direction:"vertical"}}),e("el-tag",{attrs:{type:"success"}},[t._v("装备:￥"+t._s(t.valuation.equip_estimated_price/100))])],1),e("div",{staticClass:"valuation-details"},[e("span",{staticClass:"confidence-display",class:t.confidenceTextClass},[e("i",{class:t.confidenceIcon}),t._v(" 置信度: "+t._s(t.valuation?(100*t.valuation.confidence).toFixed(1)+"%":"-")+" "),e("span",{staticClass:"confidence-level"},[t._v(t._s(t.confidenceLevel))])]),e("span",[t._v("基于"+t._s(t.valuation?t.valuation.anchor_count+"个锚点":"-"))]),t.priceRatio?e("span",[t._v("估价比率: "+t._s((100*t.priceRatio).toFixed(1))+"%")]):t._e()])],1)}),s=[],o=a(6130),l=a(3152),c=a(8770),u=a(3605),d={name:"PetValuation",components:{PetImage:o.A,SimilarGetMore:u.A},mixins:[l.h,c.B],props:{valuation:{type:Object,default:null},targetPet:{type:Object,required:!0}},computed:{priceRatio(){if(!this.valuation||!this.valuation.estimated_price_yuan||!this.targetPet.price)return null;const t=parseFloat(this.valuation.estimated_price),e=parseFloat(this.targetPet.price);return 0===e?null:t/e},priceRatioText(){if(!this.priceRatio)return"";const t=this.priceRatio,e=100*Math.abs(t-1);return e<5?`估价极为贴合市场（±${e.toFixed(1)}%）`:e<10?`估价较为贴合（±${e.toFixed(1)}%）`:e<20?`估价有一定偏差（±${e.toFixed(1)}%）`:t>1?`估价高于市场（+${(100*(t-1)).toFixed(1)}%）`:`估价低于市场（-${(100*(1-t)).toFixed(1)}%）`},priceRatioClass(){if(!this.priceRatio)return"";const t=this.priceRatio;return t>1.2?"ratio-low":t<.8?"ratio-high":"ratio-normal"},priceRatioTagType(){if(!this.priceRatio)return"";const t=this.priceRatio,e=100*Math.abs(t-1);return e<5?"success":e<10?"info":e<20?"warning":"danger"},confidenceClass(){if(!this.valuation||!this.valuation.confidence)return"confidence-extremely-low";const t=this.valuation.confidence;return t>=.8?"confidence-high":t>=.6?"confidence-medium":t>=.4?"confidence-low":t>=.2?"confidence-very-low":"confidence-extremely-low"},confidenceTextClass(){if(!this.valuation||!this.valuation.confidence)return"text-danger";const t=this.valuation.confidence;return t>=.8?"text-success":t>=.6?"text-primary":t>=.4?"text-info":t>=.2?"text-warning":"text-danger"},confidenceIcon(){if(!this.valuation||!this.valuation.confidence)return"el-icon-warning";const t=this.valuation.confidence;return t>=.8?"el-icon-success":t>=.6?"el-icon-info":t>=.4?"el-icon-warning":"el-icon-error"},confidenceLevel(){if(!this.valuation||!this.valuation.confidence)return"极低";const t=this.valuation.confidence;return t>=.8?"高":t>=.6?"中":t>=.4?"较低":t>=.2?"很低":"极低"}},methods:{getStrategyName(t){const e={fair_value:"公允价值",market_price:"市场价格",weighted_average:"加权平均"};return e[t]||t}}},p=d,f=a(1656),h=(0,f.A)(p,n,s,!1,null,"0d7e64b0",null),m=h.exports,_=function(){var t=this,e=t._self._c;return e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.anchors,stripe:"","max-height":"300",sortable:"","sort-by":["price","similarity"],"sort-order":["ascending","descending"]}},[e("el-table-column",{attrs:{fixed:"",prop:"price",label:"价格 (元)",width:"140",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.server_name))]),e("div",{domProps:{innerHTML:t._s(t.formatFullPrice(a.row))}})]}}])}),e("el-table-column",{attrs:{fixed:"",label:"召唤兽",width:"70"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("pet-image",{attrs:{pet:t.row.petData,equipFaceImg:t.row.equip_face_img,trigger:"hover"}})]}}])}),e("el-table-column",{attrs:{prop:"similarity",label:"相似度",width:"80",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getSimilarityTagType(a.row.similarity)}},[t._v(" "+t._s(a.row.similarity)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"level",label:"等级",width:"140"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("p",{class:"是"===a.row.petData.is_baobao?"cBlue":"equip_desc_red"},[e("span",[t._v(t._s("是"===a.row.petData.is_baobao?"":"野生"))]),e("span",[t._v(t._s(a.row.equip_name)+t._s("是"===a.row.petData.is_baobao?"宝宝":"")+"/"+t._s(a.row.level)+"级")])]),e("p",[t._v("参战等级："+t._s(a.row.role_grade_limit)+"级")])]}}])}),e("el-table-column",{attrs:{prop:"growth",label:"成长",width:"60"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{domProps:{innerHTML:t._s(t.getColorNumber(a.row.growth,[1,1.3]))}})]}}])}),e("el-table-column",{attrs:{prop:"lx",label:"灵性",width:"60"}}),e("el-table-column",{attrs:{prop:"equip_list",label:"装备套装",width:"80"},scopedSlots:t._u([{key:"default",fn:function({row:{equip_list:e}}){return[t._v(" "+t._s(t.getEquipSuitEffect(e))+" ")]}}])}),e("el-table-column",{attrs:{label:"技能/特性",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"special-info"},[e("div",{staticClass:"pet-skills"},[a.row.all_skill?e("span",{staticClass:"skills-text"},[t._v(" "+t._s(t.formatSkillsDiff(a.row.all_skill,t.targetPet))+" ")]):t._e()]),a.row.texing?e("div",{staticClass:"pet-texing"},[e("span",{staticClass:"texing-text"},[t._v(" "+t._s(t.formatTexing(a.row.texing))+" ")])]):t._e()])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-link",{attrs:{href:t.getCBGLinkByType(a.row.eid,"pet"),type:"danger",target:"_blank"}},[t._v("藏宝阁")])]}}])})],1)},g=[],v=(a(2489),a(7588),a(6175)),y={name:"SimilarPetTable",components:{PetImage:o.A},mixins:[v.G,c.B,l.h],props:{anchors:{type:Array,default:()=>[]},targetPet:{type:Object,default:null}},methods:{getEquipSuitEffect(t){if(!t)return"";try{const e=JSON.parse(t).filter(t=>t),a={};e.forEach(t=>{if(t.desc){const e=t.desc.match(/#c4DBAF4套装效果：附加状态#c4DBAF4([^#]+)/);if(e&&e[1]){const t=e[1].trim();a[t]=(a[t]||0)+1}}});for(const[t,i]of Object.entries(a))return i>=3?t:t+`(${i}/3)`;return""}catch(e){return console.error("解析装备列表失败:",e),""}}}},w=y,b=(0,f.A)(w,_,g,!1,null,"3d8f62dc",null),$=b.exports,x={name:"SimilarPetModal",components:{PetValuation:m,SimilarPetTable:$},mixins:[c.B,l.h],props:{pet:{type:Object,required:!0},placement:{type:String,default:"left-end"},similarityThreshold:{type:Number,default:.8},maxAnchors:{type:Number,default:30}},data(){return{visible:!1,valuationLoading:!1,anchorsLoading:!1,error:!1,similarData:null,petValuation:{}}},computed:{loading(){return this.valuationLoading||this.anchorsLoading}},methods:{async handleShow(){this.similarData||await this.loadSimilarPets()},async refresh(){await this.loadSimilarPets()},async loadSimilarPets(){this.error=!1,this.petValuation={},this.similarData=null;try{await this.loadPetValuation(this.pet,this.similarityThreshold)}catch(t){console.error("加载相似召唤兽失败:",t),this.error=!0}},async loadPetValuation({petData:t,...e},a){try{this.valuationLoading=!0;const t=await this.$api.pet.getPetValuation({pet_data:e,strategy:"fair_value",similarity_threshold:a,max_anchors:this.maxAnchors}),r=t.data;if(this.petValuation=r,this.$emit("valuation-updated",r),this.similarData={anchor_count:r.anchor_count,similarity_threshold:r.similarity_threshold||a,max_anchors:r.max_anchors||this.maxAnchors,anchors:[],statistics:{price_range:r.anchor_count?{min:Math.min(...r.anchors.map(t=>t.price||0)),max:Math.max(...r.anchors.map(t=>t.price||0)),avg:r.anchors.reduce((t,e)=>t+(e.price||0),0)/r.anchors.length}:{min:0,max:0,avg:0},similarity_range:r.anchor_count?{min:Math.min(...r.anchors.map(t=>t.similarity||0)),max:Math.max(...r.anchors.map(t=>t.similarity||0)),avg:r.anchors.reduce((t,e)=>t+(e.similarity||0),0)/r.anchors.length}:{min:0,max:0,avg:0}}},this.valuationLoading=!1,r?.anchor_count>0&&r?.anchors?.length>0){this.anchorsLoading=!0;try{const t=await this.$api.pet.getPetList({page_size:99,equip_sn_list:r.anchors.map(t=>t.equip_sn)});if(this.anchorsLoading=!1,200===t.code&&t.data?.data){const e=t.data.data,a=e.map((t,e)=>{const a=this.parsePetInfo(t.desc);return t.similarity=r.anchors[e].similarity,t.features=r.anchors[e].features,t.petData=a,t});this.$set(this.similarData,"anchors",a)}else console.warn("未获取到相似召唤兽锚点数据:",t.message)}catch(i){console.error("查询相似召唤兽锚点失败:",i)}}}catch(i){throw console.error("召唤兽估价失败:",i),this.$notify.error({title:"估价请求失败",message:"网络请求异常，请稍后重试",duration:3e3}),i}finally{this.valuationLoading=!1,this.anchorsLoading=!1}}}},S=x,k=(0,f.A)(S,i,r,!1,null,"555b326e",null),D=k.exports}}]);
//# sourceMappingURL=14.129d479c.js.map