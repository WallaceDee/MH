"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[43],{9257:function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"equipment-list-view"},[t("el-card",{staticClass:"filters",attrs:{shadow:"never"}},[t("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[t("div",[t("span",{staticClass:"emoji-icon"},[e._v("🔍")]),e._v(" 筛选")])]),t("el-form",{attrs:{inline:!0,model:e.filters,size:"mini"},nativeOn:{submit:function(t){return t.preventDefault(),e.fetchEquipments.apply(null,arguments)}}},[t("el-form-item",{attrs:{label:"装备序列号"}},[t("el-input",{attrs:{placeholder:"装备序列号"},model:{value:e.filters.equip_sn,callback:function(t){e.$set(e.filters,"equip_sn",t)},expression:"filters.equip_sn"}})],1),t("el-form-item",{attrs:{label:"等级范围"}},[t("div",{staticStyle:{width:"500px"}},[t("el-slider",{attrs:{range:"",min:60,max:160,step:5,"show-input":"","show-input-controls":"",marks:e.levelMarks},on:{change:e.handleLevelRangeChange},model:{value:e.filters.level_range,callback:function(t){e.$set(e.filters,"level_range",t)},expression:"filters.level_range"}})],1)]),t("el-form-item",{attrs:{label:"价格范围"}},[t("el-input-number",{attrs:{placeholder:"最低价格",min:0,controls:!1},model:{value:e.filters.price_min,callback:function(t){e.$set(e.filters,"price_min",t)},expression:"filters.price_min"}}),e._v(" - "),t("el-input-number",{attrs:{placeholder:"最高价格",min:0,controls:!1},model:{value:e.filters.price_max,callback:function(t){e.$set(e.filters,"price_max",t)},expression:"filters.price_max"}})],1),t("el-form-item",{attrs:{label:"类型"}},[t("el-cascader",{attrs:{options:e.kindidOptions,placeholder:"请选择装备类型",multiple:"",clearable:"",filterable:"","collapse-tags":"","collapse-tags-tooltip":"",props:{multiple:!0,emitPath:!1}},on:{change:e.handleKindidChange},model:{value:e.filters.kindid,callback:function(t){e.$set(e.filters,"kindid",t)},expression:"filters.kindid"}})],1),e.showPetEquipType?t("el-form-item",{attrs:{label:"召唤兽装备类型"}},[t("el-cascader",{attrs:{options:e.petEquipTypeOptions,props:e.cascaderProps,placeholder:"请选择召唤兽装备类型",multiple:"",clearable:"",filterable:"","collapse-tags":"","collapse-tags-tooltip":""},model:{value:e.filters.equip_type,callback:function(t){e.$set(e.filters,"equip_type",t)},expression:"filters.equip_type"}})],1):e._e(),t("el-form-item",{attrs:{label:"特技"}},[t("el-select",{attrs:{placeholder:"请选择特技",multiple:"",clearable:"",filterable:""},model:{value:e.filters.equip_special_skills,callback:function(t){e.$set(e.filters,"equip_special_skills",t)},expression:"filters.equip_special_skills"}},e._l(e.equip_special_skills,function([e,i]){return t("el-option",{key:e,attrs:{label:i,value:e}})}),1)],1),t("el-form-item",{attrs:{label:"特效"}},[t("el-select",{attrs:{placeholder:"请选择特效",multiple:"",clearable:"",filterable:""},model:{value:e.filters.equip_special_effect,callback:function(t){e.$set(e.filters,"equip_special_effect",t)},expression:"filters.equip_special_effect"}},e._l(e.equip_special_effect,function(e,i){return t("el-option",{key:i,attrs:{label:"1"===i?e+"/超级简易":e,value:i}})}),1)],1),t("el-form-item",{attrs:{label:"套装"}},[t("el-cascader",{attrs:{options:e.suitOptions,placeholder:"请选择套装效果",separator:"",clearable:"",filterable:""},on:{change:e.handleSuitChange},model:{value:e.filters.suit_effect,callback:function(t){e.$set(e.filters,"suit_effect",t)},expression:"filters.suit_effect"}})],1),t("el-form-item",{attrs:{label:"镶嵌宝石"}},[t("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"镶嵌宝石",clearable:"",filterable:""},model:{value:e.filters.gem_value,callback:function(t){e.$set(e.filters,"gem_value",t)},expression:"filters.gem_value"}},e._l(e.gems_name,function(i,l){return t("el-option",{key:l,attrs:{value:l,label:i}},[t("el-row",{attrs:{type:"flex",justify:"space-between"}},[t("el-col",{staticStyle:{width:"34px",height:"34px","margin-right":"10px"}},[t("el-image",{staticStyle:{width:"34px",height:"34px",cursor:"pointer"},attrs:{src:e.getImageUrl(e.gem_image[l]+".gif"),fit:"cover",referrerpolicy:"no-referrer"}})],1),t("el-col",{staticStyle:{width:"100px"}},[e._v(" "+e._s(i)+" ")])],1)],1)}),1),t("el-input-number",{staticStyle:{width:"120px"},attrs:{size:"mini",min:0,max:16,step:1,placeholder:"锻练等级","controls-equip_type":"right"},model:{value:e.filters.gem_level,callback:function(t){e.$set(e.filters,"gem_level",t)},expression:"filters.gem_level"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.fetchEquipments}},[e._v("查询")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.equipments,stripe:""},on:{"sort-change":e.handleSortChange}},[t("el-table-column",{attrs:{prop:"eid",label:"操作",width:"100",fixed:""},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-link",{attrs:{href:e.getCBGLinkByType(i.row.eid,"equip"),type:"danger",target:"_blank"}},[e._v("藏宝阁")]),t("el-divider",{attrs:{direction:"vertical"}}),t("SimilarEquipmentModal",{key:i.row.equip_sn,attrs:{equipment:i.row}})]}}])}),t("el-table-column",{attrs:{fixed:"",label:"装备",width:" 70"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("EquipmentImage",{attrs:{equipment:e.row}})]}}])}),t("el-table-column",{attrs:{fixed:"",prop:"price",label:"价格 (元)",width:"100",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[e._v(" "+e._s(i.row.server_name)+" "),t("div",{domProps:{innerHTML:e._s(e.formatFullPrice(i.row))}})]}}])}),t("el-table-column",{attrs:{prop:"highlight",label:"亮点",width:"100",align:"center",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{domProps:{innerHTML:e._s(e.gen_highlight(i.row.highlight))}})]}}])}),t("el-table-column",{attrs:{prop:"dynamic_tags",label:"动态",width:"100",align:"center",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{domProps:{innerHTML:e._s(e.gen_dynamic_tags(i.row.dynamic_tags))}})]}}])}),t("el-table-column",{attrs:{prop:"gem_level",label:"宝石",width:"100",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"gem-container"},[i.row.gem_level||i.row.jinglian_level||i.row.xiang_qian_level?t("el-badge",{staticClass:"gem-badge",attrs:{value:1*i.row.gem_level||1*i.row.jinglian_level||1*i.row.xiang_qian_level}},[t("div",{staticClass:"gem-images"},e._l(e.getGemImageByGemValue(i.row),function(e){return t("el-image",{key:e,staticStyle:{width:"30px",height:"30px",cursor:"pointer","margin-right":"2px"},attrs:{src:e,fit:"cover",referrerpolicy:"no-referrer"}})}),1)]):e._e()],1)]}}])}),t("el-table-column",{attrs:{prop:"special_effect",label:"特技/特效",width:"120",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"equip_desc_blue",attrs:{"data-specia-effet":i.row.special_effect,"data-special-skill":i.row.special_skill},domProps:{innerHTML:e._s(e.formatSpecialSkillsAndEffects(i.row))}})]}}])}),t("el-table-column",{attrs:{prop:"suit_effect",label:"套装",width:"160",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"equip_desc_blue",domProps:{innerHTML:e._s(e.formatSuitEffect(i.row))}})]}}])}),t("el-table-column",{attrs:{prop:"agg_added_attrs",label:"附加属性",width:"150",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"cBlue",domProps:{innerHTML:e._s(e.formatAddedAttrs(i.row.agg_added_attrs))}})]}}])}),t("el-table-column",{attrs:{prop:"equip_level",label:"等级",width:"80",sortable:"custom"}}),t("el-table-column",{attrs:{prop:"all_damage",label:"总伤",width:"80",sortable:"custom"}}),t("el-table-column",{attrs:{prop:"init_damage",label:"初伤",width:"80",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticClass:"cBlue"},[e._v(e._s(i.row.init_damage||i.row.damage||i.row.shanghai||""))])]}}])}),t("el-table-column",{attrs:{prop:"init_wakan",label:"初灵",width:"80",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticClass:"cBlue"},[e._v(e._s(i.row.init_wakan||(i.row.magic_damage?`法术伤害 +${i.row.magic_damage}`:"")))])]}}])}),t("el-table-column",{attrs:{prop:"init_defense",label:"初防",width:"80",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticClass:"cBlue"},[e._v(e._s(i.row.init_defense||i.row.defense||i.row.fangyu||(i.row.magic_defense?`法术防御 +${i.row.magic_defense}`:"")))])]}}])}),t("el-table-column",{attrs:{prop:"init_hp",label:"初血",width:"80",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticClass:"cBlue"},[e._v(e._s(i.row.init_hp||i.row.qixue||""))])]}}])}),t("el-table-column",{attrs:{prop:"init_dex",label:"初敏",width:"80",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticClass:"cBlue"},[e._v(e._s(i.row.init_dex||i.row.speed||""))])]}}])}),t("el-table-column",{attrs:{prop:"update_time",label:"创建、更新",width:"200"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{type:"info"}},[e._v(e._s(i.row.create_time))]),t("el-tag",[e._v(e._s(i.row.update_time))])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-link",{attrs:{href:"javascript:void(0)",type:"danger"},nativeOn:{click:function(t){return e.handleDelete(i.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.page_size,"page-sizes":[10,100,200,300,400],layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"current-change":e.handlePageChange,"size-change":e.handleSizeChange}})],1)],1)},a=[],s=(i(4114),i(8111),i(2489),i(7588),i(1701),i(7548)),r=i(3016),n=i(6175),o=i(8770);for(var p in window.petEquipTypes=[{key:"1",catagory:"铠甲",items:[]},{key:"2",catagory:"项圈",items:[]},{key:"3",catagory:"护腕",items:[]}],window.CBG_GAME_CONFIG.equip_info)if(p>=9101&&p<=9316){const e=window.CBG_GAME_CONFIG.equip_info[p],t=e.desc.match(/等级(\d+)/)[1];p>=9101&&p<=9116?window.petEquipTypes[0].items.push({...e,keyIndex:parseInt(p),level:t}):p>=9201&&p<=9216?window.petEquipTypes[1].items.push({...e,keyIndex:parseInt(p),level:t}):p>=9301&&p<=9316&&window.petEquipTypes[2].items.push({...e,keyIndex:parseInt(p),level:t})}const c=[{value:-1,label:"人物装备",children:[{value:-3,label:"武器",children:window.AUTO_SEARCH_CONFIG.weapon_armors.filter(([e])=>window.is_weapon_equip(e)).map(([e,t])=>({value:e,label:t}))},{value:-4,label:"防具",children:window.AUTO_SEARCH_CONFIG.weapon_armors.filter(([e])=>!window.is_weapon_equip(e)).map(([e,t])=>({value:e,label:t}))}]},{value:-2,label:"灵饰",children:window.lingshiKinds.map(([e,t])=>({value:e,label:t}))},{value:29,label:"召唤兽装备"}];var u={name:"EquipmentList",components:{SimilarEquipmentModal:s.A,EquipmentImage:r.A},mixins:[n.G,o.B],data(){return{tableLoading:!1,kindidOptions:c,equip_special_skills:window.AUTO_SEARCH_CONFIG.equip_special_skills,equip_special_effect:window.AUTO_SEARCH_CONFIG.equip_special_effect,equipments:[],filters:{equip_sn:"",level_range:[60,160],price_min:void 0,price_max:void 0,kindid:[],equip_type:[],equip_special_skills:[],equip_special_effect:[],suit_effect:[],gem_value:void 0,gem_level:void 0,sort_by:"",sort_order:""},pagination:{page:1,page_size:10,total:0},levelMarks:{80:"80",100:"100",120:"120"},suitOptions:[],gems_name:window.AUTO_SEARCH_CONFIG.gems_name,gem_image:{1:"4011",2:"4002",3:"4012",4:"4004",5:"4003",6:"4010",7:"4005",8:"4007",9:"4006",10:"4008",11:"4009",12:"1108_4249",4244:"4244","755_4036":"755_4036","756_4037":"756_4037","757_4038":"757_4038"},petEquipTypes:window.petEquipTypes,cascaderProps:{value:"keyIndex",label:"name",children:"items",multiple:!0,emitPath:!1},tableKey:0,isInitializing:!0}},computed:{showPetEquipType(){return this.filters.kindid&&this.filters.kindid.includes(29)},petEquipTypeOptions(){return this.petEquipTypes.map(e=>({keyIndex:e.key,name:e.catagory,items:e.items.map(e=>({keyIndex:e.keyIndex,name:`${e.name}（${e.level}级）`,level:e.level}))}))}},watch:{showPetEquipType(){this.tableKey+=1}},methods:{async handleDelete(e){try{await this.$confirm(`确定要删除装备 ${e.equip_name||e.equip_sn} 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t=await this.$api.equipment.deleteEquipment(e.equip_sn);200===t.code?(this.$notify.success({title:"成功",message:"装备删除成功"}),await this.fetchEquipments()):this.$notify.error({title:"错误",message:t.message||"删除失败"})}catch(t){"cancel"!==t&&(console.error("删除装备失败:",t),this.$notify.error({title:"错误",message:"删除装备失败"}))}},async fetchEquipments(){try{this.tableLoading=!0;const e={...this.filters,page:this.pagination.page,page_size:this.pagination.page_size};if(this.filters.level_range&&Array.isArray(this.filters.level_range)&&(e.level_min=this.filters.level_range[0],e.level_max=this.filters.level_range[1],delete e.level_range),this.filters.suit_effect&&Array.isArray(this.filters.suit_effect)&&2===this.filters.suit_effect.length){const[t,i]=this.filters.suit_effect,l=i.split("_").pop();"added_status"===t?e.suit_added_status=l:"suit_effects"===t?e.suit_effect=l:"transform_skills"===t?e.suit_transform_skills=l:"transform_charms"===t&&(e.suit_transform_charms=l),e.suit_added_status||e.suit_effect||e.suit_transform_skills||e.suit_transform_charms||delete e.suit_effect}else delete e.suit_effect;Object.keys(e).forEach(t=>{(null===e[t]||""===e[t]||Array.isArray(e[t])&&0===e[t].length)&&delete e[t]}),e.kindid&&e.kindid.includes(29)||delete e.equip_type,e.equip_type&&Array.isArray(e.equip_type)&&0===e.equip_type.length&&delete e.equip_type;const t=await this.$api.equipment.getEquipmentList(e);200===t.code?(this.equipments=t.data.data||[],this.pagination.total=t.data.total||0,this.pagination.page=t.data.page||this.pagination.page):this.$notify.error({title:"错误",message:t.message||"获取装备列表失败"})}catch(e){console.error("获取装备列表失败:",e),this.$notify.error({title:"错误",message:"获取装备列表失败"})}finally{this.tableLoading=!1}},handleSizeChange(e){this.pagination.page_size=e,this.pagination.page=1,this.fetchEquipments()},handlePageChange(e){this.pagination.page=e,this.fetchEquipments()},handleSortChange({prop:e,order:t}){this.filters.sort_by=e,this.filters.sort_order="ascending"===t?"asc":"desc",this.fetchEquipments()},formatGems(e,t){if(!e||e<=0)return"";let i=[];return i.length>0?(i.push(`锻炼等级：${e}`),i.join("<br />")):`锻炼等级：${e}`},getGemNameById(e){if(window.AUTO_SEARCH_CONFIG&&window.AUTO_SEARCH_CONFIG.gems_name){const t=window.AUTO_SEARCH_CONFIG.gems_name[e.toString()];if(t)return t}return`宝石${e}`},getGemImageByGemValue({gem_value:e,kindid:t,fangyu:i,speed:l}){const a=(()=>{try{return 29===t?i?["755_4036"]:l?["757_4038"]:["756_4037"]:JSON.parse(e||'["4244"]')}catch(a){console.error("解析宝石数据失败:",a,e)}return[]})();return a.map(e=>{if(this.gem_image[e])return this.getImageUrl(this.gem_image[e]+".gif")})},formatAddedAttrs(e){if(!e)return"";try{let t=JSON.parse(e);if(Array.isArray(t)&&t.length>0)return t=t.map(e=>"string"===typeof e?e:`${e.attr_type} +${e.attr_value}`),t.join("<br />")}catch(t){console.error("解析附加属性失败:",t,e)}return""},handleLevelRangeChange(e){this.filters.level_range=e},handleSuitChange(e){this.filters.suit_effect=e},handleKindidChange(e){e&&e.includes(29)||(this.filters.equip_type=[])}},mounted(){this.initSuitOptions(),this.fetchEquipments()}},d=u,_=i(1656),f=(0,_.A)(d,l,a,!1,null,"83a57e02",null),m=f.exports}}]);
//# sourceMappingURL=43.dabeb078.js.map