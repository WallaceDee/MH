"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[985],{8460:function(t,e,i){i.r(e),i.d(e,{default:function(){return J}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"role-list"},[e("el-card",{staticClass:"filters",attrs:{shadow:"never"}},[e("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[e("div",[e("span",{staticClass:"emoji-icon"},[t._v("🔍")]),t._v(" 筛选")])]),e("el-form",{staticClass:"search-form",attrs:{model:t.searchForm,inline:!0}},[e("el-form-item",{attrs:{label:"选择月份"}},[e("el-date-picker",{attrs:{clearable:!1,type:"month",placeholder:"选择月份",format:"yyyy-MM","value-format":"yyyy-MM"},on:{change:t.handleDateChange},model:{value:t.searchForm.selectedDate,callback:function(e){t.$set(t.searchForm,"selectedDate",e)},expression:"searchForm.selectedDate"}})],1),e("el-form-item",{attrs:{label:"人物等级"}},[e("el-input-number",{staticStyle:{width:"60px"},attrs:{controls:!1,min:0,max:175,size:"mini"},on:{change:t.handleLevelChange},model:{value:t.searchForm.level_min,callback:function(e){t.$set(t.searchForm,"level_min",e)},expression:"searchForm.level_min"}}),e("span",{staticClass:"mx-2"},[t._v("-")]),e("el-input-number",{staticStyle:{width:"60px"},attrs:{controls:!1,min:0,max:175,size:"mini"},on:{change:t.handleLevelChange},model:{value:t.searchForm.level_max,callback:function(e){t.$set(t.searchForm,"level_max",e)},expression:"searchForm.level_max"}}),e("div",{staticClass:"level-quick-select"},t._l([109,129,155,159,175],function(i){return e("el-tag",{key:i,staticStyle:{cursor:"pointer","margin-right":"4px"},attrs:{size:"mini",effect:t.getLevelEffect(i)},on:{click:function(e){return t.handleQuickLevelSelect(i)}}},[t._v(" "+t._s(i)+"级 ")])}),1)],1),e("el-form-item",{attrs:{label:"物品数量≤"}},[e("el-input",{staticStyle:{width:"60px"},attrs:{clearable:""},model:{value:t.searchForm.equip_num,callback:function(e){t.$set(t.searchForm,"equip_num",t._n(e))},expression:"searchForm.equip_num"}})],1),e("el-form-item",{attrs:{label:"宠物数量≤"}},[e("el-input",{staticStyle:{width:"60px"},attrs:{clearable:""},model:{value:t.searchForm.pet_num,callback:function(e){t.$set(t.searchForm,"pet_num",t._n(e))},expression:"searchForm.pet_num"}})],1),e("el-form-item",{attrs:{label:"宠物等级≥"}},[e("el-input",{staticStyle:{width:"60px"},attrs:{clearable:""},model:{value:t.searchForm.pet_num_level,callback:function(e){t.$set(t.searchForm,"pet_num_level",t._n(e))},expression:"searchForm.pet_num_level"}})],1),e("el-form-item",{attrs:{label:"接受还价"}},[e("el-checkbox",{attrs:{"true-label":"1","false-label":""},model:{value:t.searchForm.accept_bargain,callback:function(e){t.$set(t.searchForm,"accept_bargain",e)},expression:"searchForm.accept_bargain"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("搜索")]),e("el-button",{on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1),e("el-checkbox-group",{model:{value:t.checkedList,callback:function(e){t.checkedList=e},expression:"checkedList"}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"roleTable",staticStyle:{width:"100%",border:"1px solid #9ea0bf"},attrs:{data:t.stickyRoleList.concat(t.tableData),stripe:""},on:{"sort-change":t.handleSortChange}},[e("el-table-column",{attrs:{width:"110",align:"center",fixed:"left"},scopedSlots:t._u([{key:"header",fn:function(){return[t.stickyRoleList.length>0?e("el-link",{staticClass:"cell",staticStyle:{"font-size":"12px","font-weight":"bold",color:"#909399","white-space":"nowrap"},attrs:{underline:!1,href:"javascript:void(0);"},nativeOn:{click:function(e){return t.clearAllStickyRoles.apply(null,arguments)}}},[t._v("批量解锁 ("+t._s(t.stickyRoleList.length)+")")]):t._e()]},proxy:!0},{key:"default",fn:function(i){return[e("div",{staticClass:"sticky-wrapper"},[e("RoleImage",{key:i.row.eid,attrs:{other_info:i.row.other_info,roleInfo:i.row.roleInfo}}),e("el-checkbox",{attrs:{label:i.row.eid},on:{change:t.handleSingleCheckboxChange}},[t._v("锁定")])],1),e("el-link",{staticStyle:{"white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden",display:"block","font-size":"12px"},attrs:{href:t.getCBGLinkByType(i.row.eid,"role"),type:"danger",target:"_blank"}},[t._v(" "+t._s(i.row.seller_nickname||i.row.seller_nickname))])]}}])}),e("el-table-column",{attrs:{prop:"sum_exp",label:"门派/等级/经验",width:"160",align:"center",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{staticClass:"vertical-middle"},[1===i.row.is_split_independent_role?e("i",{staticClass:"icon-chai"}):t._e(),1===i.row.is_split_main_role?e("i",{staticClass:"icon-zheng"}):t._e(),t._v(" "+t._s(i.row.server_name)+"/ "+t._s(t.get_school_name(i.row.school))+" ")]),e("div",{staticClass:"js-level cGray"},[t._v(t._s(i.row.level)+"级/"+t._s(i.row.sum_exp)+"亿")])]}}])}),e("el-table-column",{attrs:{prop:"highlight",label:"亮点",width:"100",align:"center",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{domProps:{innerHTML:t._s(t.gen_highlight(i.row.highlight))}})]}}])},[t._v("> ")]),e("el-table-column",{attrs:{prop:"dynamic_tags",label:"动态",width:"100",align:"center",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{domProps:{innerHTML:t._s(t.gen_dynamic_tags(i.row.dynamic_tags))}})]}}])}),e("el-table-column",{attrs:{prop:"price",label:"价格 (元)",width:"140",sortable:"custom",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{domProps:{innerHTML:t._s(t.formatFullPrice(i.row))}}),void 0!==t.get_price_change(i.row)?e("el-tag",{attrs:{type:t.get_price_change(i.row)<0?"danger":"success"}},[e("i",{class:"el-icon-"+(t.get_price_change(i.row)<0?"bottom":"top"),style:"color: #"+(t.get_price_change(i.row)<0?"F56C6C;":"67C23A")},[t._v(t._s(t.get_price_change(i.row)))])]):t._e()]}}])}),e("el-table-column",{attrs:{label:"估价",width:"220",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"role-valuation-cell"},[e("div",[e("el-tag",[t._v("👤"),e("span",{staticStyle:{"font-size":"12px"},domProps:{innerHTML:t._s(t.formatFullPriceWithoutPerfix({price:i.row.base_price}))}})]),t.get_equip_num(i.row.roleInfo)>0?e("el-tag",[t._v("⚔️"),e("span",{staticStyle:{"font-size":"12px"},domProps:{innerHTML:t._s(t.formatFullPriceWithoutPerfix({price:i.row.equip_price}))}})]):t._e(),t.get_pet_num(i.row.roleInfo)>0?e("el-tag",[t._v("🐲"),e("span",{staticStyle:{"font-size":"12px"},domProps:{innerHTML:t._s(t.formatFullPriceWithoutPerfix({price:i.row.pet_price}))}})]):t._e()],1),e("el-tag",{attrs:{type:"success"}},[t._v("总估价： "),e("span",{staticStyle:{"font-size":"12px"},domProps:{innerHTML:t._s(t.formatFullPriceWithoutPerfix({price:i.row.base_price+i.row.equip_price+i.row.pet_price}))}})])],1)]}}])}),e("el-table-column",{attrs:{label:"装备估价",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("SimilarRoleModal",{attrs:{role:i.row,"search-params":{selectedDate:t.searchForm.selectedDate,roleType:t.roleType}},on:{"update-role-price":t.handleRolePriceUpdate}},[e("div",[e("el-link",{attrs:{type:"primary",href:"javascript:void(0)"}},[t._v("👤 裸号")])],1)]),t.get_equip_num(i.row.roleInfo)>0?e("div",[e("el-link",{attrs:{type:"primary",href:"javascript:void(0)"},nativeOn:{click:function(e){return t.handleEquipPrice(i.row,i.$index)}}},[t._v("⚔️ "+t._s(t.get_equip_num(i.row.roleInfo))+"件")])],1):t._e(),t.get_pet_num(i.row.roleInfo)>0?e("el-link",{attrs:{type:"primary",href:"javascript:void(0)"},nativeOn:{click:function(e){return t.handlSummonePrice(i.row,i.$index)}}},[t._v("🐲 "+t._s(t.get_pet_num(i.row.roleInfo))+"只 ")]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"history_price",label:"历史价格",width:"120",align:"center",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(i){return t._l(JSON.parse(i.row.history_price),function(i,s){return e("div",{key:s,staticStyle:{"text-decoration":"line-through",filter:"grayscale(100%)"},attrs:{title:i.timestamp},domProps:{innerHTML:t._s(t.formatFullPrice(i.price,!0))}})})}}])}),e("el-table-column",{attrs:{prop:"accept_bargain",label:"还价",width:"80",align:"center",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(i){return[1==i.row.accept_bargain?e("el-tag",{attrs:{type:"success"}},[t._v("接受")]):e("el-tag",{attrs:{type:"danger"}},[t._v("拒绝")])]}}])}),e("el-table-column",{attrs:{prop:"collect_num",label:"收藏",width:"80",align:"center",sortable:"custom"}}),e("el-table-column",{attrs:{label:"修炼/控制力","min-width":"400",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[t._l(i.row.roleInfo.role_xiulian,function(i){return e("el-tag",{key:i.name},[t._v(t._s(i.name.replace("修炼",""))+t._s(i.info))])}),e("br"),t._l(i.row.roleInfo.pet_ctrl_skill,function(i){return e("el-tag",{key:i.name},[t._v(t._s(i.name)+t._s(i.grade))])})]}}])}),e("el-table-column",{attrs:{prop:"update_time",label:"创建、更新",width:"200"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-tag",{attrs:{type:"info"}},[t._v(t._s(i.row.create_time))]),e("el-tag",[t._v(t._s(i.row.update_time))])]}}])}),e("el-table-column",{attrs:{prop:"server",label:"操作",width:"100",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-link",{attrs:{href:"javascript:void(0)",type:"danger"},nativeOn:{click:function(e){return t.handleDelete(i.row)}}},[t._v("删除")]),"normal"===t.roleType?e("el-link",{attrs:{type:"primary",href:"javascript:void(0)"},nativeOn:{click:function(e){return t.changeRoleType(i.row)}}},[t._v("转为锚点")]):e("el-link",{attrs:{type:"primary",href:"javascript:void(0)"},nativeOn:{click:function(e){return t.changeRoleType(i.row)}}},[t._v("移除锚点")])]}}])})],1)],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,total:t.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next"},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("el-dialog",{attrs:{visible:t.valuationDialogVisible,width:"1000px","close-on-click-modal":!1,"close-on-press-escape":!1,"custom-class":"batch-valuation-dialog"},on:{"update:visible":function(e){t.valuationDialogVisible=e}}},[e("span",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[e("el-tag",{attrs:{size:"mini"}},[t._v(t._s(t.valuationDialogTitle.server_name))]),t._v(" / "),e("el-tag",{attrs:{type:"info",size:"mini"}},[t._v(t._s(t.valuationDialogTitle.school))]),t._v("/ "),e("el-link",{attrs:{href:t.getCBGLinkByType(t.valuationDialogTitle.eid),target:"_blank"}},[t._v(t._s(t.valuationDialogTitle.nickname))])],1),e("EquipBatchValuationResult",{attrs:{results:t.valuationResults,"total-value":t.valuationTotalValue,"equipment-list":t.valuationEquipmentList,"valuate-params":t.batchValuateParams,loading:t.valuationLoading},on:{close:t.closeValuationDialog}})],1),e("el-dialog",{attrs:{visible:t.petValuationDialogVisible,width:"900px","close-on-click-modal":!1,"close-on-press-escape":!1,"custom-class":"batch-valuation-dialog"},on:{"update:visible":function(e){t.petValuationDialogVisible=e}}},[e("span",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[e("el-tag",{attrs:{size:"mini"}},[t._v(t._s(t.petValuationDialogTitle.server_name))]),t._v(" / "),e("el-tag",{attrs:{type:"info",size:"mini"}},[t._v(t._s(t.petValuationDialogTitle.school))]),t._v("/ "),e("el-link",{attrs:{href:t.getCBGLinkByType(t.petValuationDialogTitle.eid),target:"_blank"}},[t._v(t._s(t.petValuationDialogTitle.nickname))])],1),e("PetBatchValuationResult",{attrs:{results:t.petValuationResults,"total-value":t.petValuationTotalValue,"pet-list":t.petValuationList,"valuate-params":t.batchValuateParams,loading:t.petValuationLoading},on:{close:t.closePetValuationDialog}})],1)],1)},a=[],l=(i(4114),i(8111),i(2489),i(116),i(7588),i(1701),i(8237),i(3579),i(1488)),o=i.n(l),n=i(5782),r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pet-batch-valuation-result"},[t.loading?e("div",{staticClass:"skeleton-container"},[e("el-skeleton",{attrs:{rows:12,animated:""}})],1):[e("div",{staticClass:"result-item",class:t.getOverviewClass(),staticStyle:{"min-height":"unset","margin-bottom":"10px"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:t.totalValue/100,title:"估价总值",prefix:"¥","value-style":{fontSize:"28px",fontWeight:"bold",color:"#67c23a"}}})],1),e("el-col",{attrs:{span:6}},[e("el-statistic",{attrs:{"group-separator":",",precision:0,value:t.successCount,title:"成功估价","value-style":{fontSize:"28px",fontWeight:"bold",color:"#67c23a"}}},[e("template",{slot:"suffix"},[e("span",{staticStyle:{color:"#909399","font-size":"16px"}},[t._v("/ "+t._s(t.totalCount))])])],2)],1)],1)],1),e("el-row",{staticStyle:{"flex-wrap":"wrap"}},t._l(t.results,function(i,s){return e("el-col",{key:s,attrs:{span:8}},[e("div",{staticClass:"result-item-wrapper"},[e("div",{staticClass:"result-item",class:t.getResultItemClass(i)},[e("div",{staticClass:"result-header"},[e("span",{staticClass:"item-index"},[t._v(t._s(t.petList[s].pet_detail.pet_name||`召唤兽 ${s+1}`)+"-"+t._s(t.petList[s].equip_level)+"级")]),i.error||i.skip_reason?i.skip_reason?e("span",{staticClass:"skip-badge",attrs:{title:i.skip_reason}},[t._v(" 跳过估价 ")]):e("span",{staticClass:"error-badge",attrs:{title:i.error}},[t._v(" 估价失败 ")]):e("span",{staticClass:"confidence-badge",class:t.getConfidenceBadgeClass(i.confidence)},[t._v(" 置信度: "+t._s((100*i.confidence).toFixed(1))+"% ")])]),e("el-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[e("el-col",{staticStyle:{width:"50px"}},[e("PetImage",{attrs:{placement:"top",pet:t.petList[s].pet_detail,size:"small",equip_sn:t.petList[s].equip_sn,equipFaceImg:t.petList[s].pet_detail.icon}}),e("SimilarPetModal",{attrs:{pet:t.genPetData(t.petList[s])},on:{"valuation-updated":e=>t.handlePetValuationUpdated(e,s)}},[e("el-link",{staticStyle:{"font-weight":"bold"},attrs:{href:"javascript:void(0)",type:"primary"}},[t._v(t._s(t.petList[s].pet_detail?.name||`召唤兽 ${s+1}`))])],1)],1),e("el-col",{staticClass:"price-info",attrs:{span:12}},[e("el-statistic",{attrs:{"group-separator":",",precision:2,value:(i.estimated_price+i.equip_estimated_price)/100,title:"估价",prefix:"¥","value-style":{color:"#f56c6c",fontSize:"18px",fontWeight:"bold"}}})],1)],1),t.petList[s]?e("div",{staticClass:"pet-details"},[e("div",{staticClass:"skip-reason"},[i.skip_reason?e("el-tag",{attrs:{type:"warning",size:"mini"}},[e("i",{staticClass:"el-icon-warning"}),t._v(" "+t._s(i.skip_reason)+" ")]):i.error?e("el-tag",{attrs:{type:"danger",size:"mini"}},[e("i",{staticClass:"el-icon-error"}),t._v(" "+t._s(i.error)+" ")]):e("el-tag",{attrs:{type:"success",size:"mini"}},[e("i",{staticClass:"el-icon-success"}),t._v(" 估价成功 ")])],1),e("div",{staticClass:"pet-info"},[e("el-tag",{attrs:{size:"mini",type:"是"===t.petList[s].is_baobao?"success":"danger"}},[t._v(t._s("是"===t.petList[s].is_baobao?"宝宝":"野生"))]),e("el-tag",{attrs:{size:"mini"}},[t._v(t._s(t.petList[s].equip_level)+"级")]),e("el-tag",{attrs:{size:"mini",type:"success"}},[t._v(t._s(t.petList[s].growth))])],1),e("div",{staticClass:"pet-skills"},[e("span",{staticClass:"skill-label"},[t._v("技能:")]),e("div",{staticClass:"mini-icon",domProps:{innerHTML:t._s(t.formatSkills({petData:{...t.petList[s].pet_detail,sp_skill:t.petList[s].pet_detail.genius}}))}})]),e("div",{staticClass:"pet-equips"},[e("span",{staticClass:"skill-label"},[t._v("装备:"),t.getEquipListLength(t.petList[s])>0?[e("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary",href:"javascript:void(0)"}},[t._v("￥"+t._s((i.equip_estimated_price/100).toFixed(2)))]),e("el-link",{staticStyle:{"font-size":"12px","margin-left":"5px"},attrs:{type:"danger"},on:{click:function(e){return t.showEquipValuation(t.petList[s])}}},[t._v("查看估价")])]:t._e()],2),e("table",{staticClass:"tb03 size50",staticStyle:{margin:"unset","margin-top":"3px"},attrs:{cellspacing:"0",cellpadding:"0"}},[e("tr",t._l(t.getEquipList(t.petList[s]),function(i,s){return e("td",{key:s},[i?e("EquipmentImage",{attrs:{placement:"bottom",image:!1,equipment:t.getEquipImageProps(i),size:"small",popoverWidth:300,width:"40px",height:"40px"}}):e("span",[t._v(" ")])],1)}),0)])])]):t._e()],1)])])}),1)],e("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center","margin-top":"20px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$emit("close")}}},[t._v("关闭")])],1),e("el-dialog",{attrs:{"append-to-body":"",title:t.valuationDialogTitle,visible:t.valuationDialogVisible,width:"760px","close-on-click-modal":!1,"close-on-press-escape":!1,"custom-class":"batch-valuation-dialog"},on:{"update:visible":function(e){t.valuationDialogVisible=e}}},[e("EquipBatchValuationResult",{staticStyle:{width:"720px"},attrs:{colSpan:8,results:t.valuationResults,"total-value":t.valuationTotalValue,"equipment-list":t.valuationEquipmentList,"valuate-params":t.valuateParams,loading:t.valuationLoading},on:{close:t.closeValuationDialog}})],1)],2)},c=[],_=i(6130),u=i(3016),h=i(5868),d=i(3152),p=i(6175),g={name:"PetBatchValuationResult",props:{results:{type:Array,required:!0},petList:{type:Array,required:!0},totalValue:{type:Number,default:0},valuateParams:{type:Object,required:!0},loading:{type:Boolean,default:!1}},mixins:[d.h,p.G],data(){return{currentTotalValue:0,valuationDialogVisible:!1,valuationResults:[],valuationTotalValue:0,valuationEquipmentList:[],valuationLoading:!1,valuationDialogTitle:""}},watch:{totalValue(t){this.currentTotalValue=t}},computed:{totalCount(){return this.results.length},successCount(){return this.results.filter(t=>!t.error).length}},components:{PetImage:_.A,EquipmentImage:u.A,SimilarPetModal:h.A,EquipBatchValuationResult:n.A},methods:{getEquipListLength(t){try{return this.getEquipList(t).filter(t=>t).length}catch(e){return 0}},getEquipList(t){try{return JSON.parse(t.equip_list).splice(0,3)}catch(e){return[null,null,null]}},async showEquipValuation(t){try{const i=t.equip_list||"[]";let s=[];try{s=JSON.parse(i)}catch(e){return console.error("解析装备列表失败:",e),void this.$notify.error("装备列表格式错误")}const a=s.filter((t,e)=>t&&t.desc&&e<3).map(t=>({kindid:29,desc:t.desc}));if(0===a.length)return void this.$notify.warning("该召唤兽没有携带装备");this.valuationDialogVisible=!0,this.valuationLoading=!0,this.valuationResults=[],this.valuationTotalValue=0,this.valuationEquipmentList=s,this.valuationDialogTitle=`召唤兽装备估价结果 - ${t.pet_detail?.pet_name||"未知召唤兽"}`;const l=await this.$api.equipment.batchEquipmentValuation({equipment_list:a,strategy:"fair_value",similarity_threshold:this.valuateParams.similarity_threshold,max_anchors:this.valuateParams.max_anchors});if(200===l.code){const t=l.data,e=t.results||[],i=e.reduce((t,e)=>t+(e.estimated_price||0),0);if(0===e.length)return this.$notify.warning("该召唤兽没有携带装备或装备估价失败"),void this.closeValuationDialog();this.valuationResults=e,this.valuationTotalValue=i,this.valuationLoading=!1}else this.$notify.error(l.message||"装备估价失败"),this.closeValuationDialog()}catch(i){console.error("装备估价失败:",i),this.$notify.error("装备估价失败"),this.closeValuationDialog()}},closeValuationDialog(){this.valuationDialogVisible=!1,this.valuationResults=[],this.valuationTotalValue=0,this.valuationEquipmentList=[],this.valuationLoading=!1,this.valuationDialogTitle=""},genPetData(t){return{...t,petData:t.pet_detail,equip_face_img:t.pet_detail.icon}},handlePetValuationUpdated(t,e){if(this.results[e]){const i=this.results[e].estimated_price+(this.results[e].equip_estimated_price||0),s=t.estimated_price+(t.equip_estimated_price||0);this.currentTotalValue=this.currentTotalValue-i+s}this.$set(this.results,e,t),console.log("宠物估价数据更新完成:",t)},getOverviewClass(){const t=this.totalCount>0?this.successCount/this.totalCount:0;return t>=.9?"confidence-high":t>=.7?"confidence-medium":t>=.5?"confidence-low":t>=.3?"confidence-very-low":"confidence-extremely-low"},getResultItemClass(t){if(t.error)return"error";const e=t.confidence||0;return e>=.9?"confidence-high":e>=.7?"confidence-medium":e>=.5?"confidence-low":e>=.3?"confidence-very-low":"confidence-extremely-low"},getConfidenceBadgeClass(t){return t>=.9?"confidence-badge-high":t>=.7?"confidence-badge-medium":t>=.5?"confidence-badge-low":t>=.3?"confidence-badge-very-low":"confidence-badge-extremely-low"}}},m=g,v=i(1656),f=(0,v.A)(m,r,c,!1,null,"e31a7d3a",null),y=f.exports,b=function(){var t=this,e=t._self._c;return e("el-popover",{attrs:{"data-role-eid":t.role.eid,placement:t.placement,width:"800",trigger:"click","popper-class":"similar-role-popper"},on:{show:t.handleShow},scopedSlots:t._u([{key:"reference",fn:function(){return[t._t("default",function(){return[e("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary"}},[t._v("查看相似")])]})]},proxy:!0}],null,!0),model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?e("div",[t.valuationLoading?e("div",{staticClass:"loading-info"},[e("el-skeleton",{attrs:{rows:12,animated:""}})],1):t.similarData?e("div",[e("div",{staticClass:"similar-header"},[e("h4",[t._v("相似角色 (共"+t._s(t.similarData.anchor_count)+"个) "),e("el-divider",{attrs:{direction:"vertical"}}),e("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("相似度阈值: "+t._s(t.similarData.similarity_threshold))]),e("el-divider",{attrs:{direction:"vertical"}}),e("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("最大锚点数: "+t._s(t.similarData.max_anchors))])],1),e("div",{staticClass:"valuation-info",class:t.confidenceClass},[e("el-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[e("el-row",{attrs:{type:"flex",align:"middle"}},[e("RoleImage",{key:t.role.eid,attrs:{other_info:t.role.other_info,roleInfo:t.role.roleInfo}}),e("div",{staticStyle:{"margin-left":"10px"}},[e("div",{staticClass:"role-basic-info"},[e("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v(" "+t._s(t.getServerHeatLabel(t.role.serverid)||"其他")+"/"+t._s(t.role.server_name))]),t._v(" / "),e("el-tag",{attrs:{type:"primary",size:"mini"}},[t._v(t._s(t.role.level))]),t._v(" / "),e("el-tag",{attrs:{type:"info",size:"mini"}},[t._v(t._s(t.role.roleInfo.basic_info.school))])],1)])],1),e("div",{staticStyle:{width:"100px","flex-shrink":"0",display:"flex","justify-content":"flex-end"}},[e("el-button",{attrs:{type:"primary",size:"mini",loading:t.loading},on:{click:t.refresh}},[t._v("刷新")])],1)],1),e("div",{staticClass:"valuation-main"},[e("span",{staticClass:"valuation-label"},[t._v("角色估价:")]),e("span",{staticClass:"valuation-price"},[t._v(t._s(t.similarData.valuation?.estimated_price_yuan||"-")+"元")]),e("span",{staticClass:"valuation-strategy"},[t._v("("+t._s(t.getStrategyName(t.similarData.valuation?.strategy))+")")])]),e("div",{staticClass:"valuation-details"},[e("span",{staticClass:"confidence-display",class:t.confidenceTextClass},[e("i",{class:t.confidenceIcon}),t._v(" 置信度: "+t._s(t.similarData.valuation?(100*t.similarData.valuation.confidence).toFixed(1)+"%":"-")+" "),e("span",{staticClass:"confidence-level"},[t._v(t._s(t.confidenceLevel))])]),e("span",[t._v("基于"+t._s(t.similarData.anchor_count)+"个锚点")])])],1),t.similarData.statistics?e("div",{staticClass:"stats"},[e("span",[t._v(" 价格范围: "),e("span",{domProps:{innerHTML:t._s(t.formatPrice(t.similarData.statistics.price_range.min))}}),t._v(" - "),e("span",{domProps:{innerHTML:t._s(t.formatPrice(t.similarData.statistics.price_range.max))}})]),e("span",[t._v("平均相似度: "+t._s(t.similarData.statistics.similarity_range.avg.toFixed(3)))])]):t._e()]),t.anchorsLoading||t.similarData.anchors?.length?e("SimilarRoleTable",{directives:[{name:"loading",rawName:"v-loading",value:t.anchorsLoading,expression:"anchorsLoading"}],attrs:{anchors:t.similarData.anchors,"element-loading-text":"正在加载相似角色"}}):e("el-empty",{attrs:{description:"暂无相似角色数据"}})],1):t._e()]):t._e()])},k=[],w=function(){var t=this,e=t._self._c;return e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.anchors,stripe:"","max-height":"400",sortable:"","sort-by":["price","similarity"],"sort-order":["ascending","descending"]}},[e("el-table-column",{attrs:{fixed:"",prop:"price",label:"价格 (元)",width:"100",sortable:""},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",{domProps:{innerHTML:t._s(t.formatPrice(i.row.price))}})]}}])}),e("el-table-column",{attrs:{prop:"similarity",label:"相似度",width:"80",sortable:"",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-tag",{attrs:{type:t.getSimilarityTagType(i.row.similarity)}},[t._v(" "+t._s(i.row.similarity.toFixed(3))+" ")])]}}])}),e("el-table-column",{attrs:{prop:"nickname",label:"角色",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("RoleImage",{attrs:{roleInfo:t.row.roleInfo,other_info:t.row.other_info}})]}}])}),e("el-table-column",{attrs:{prop:"server_name",label:"服务器",width:"90"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"server-info"},[e("div",[e("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v(t._s(t.getServerHeatLabel(i.row.serverid)||"其他"))])],1),e("div",[e("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v(t._s(i.row.server_name))])],1),i.row.is_cross_server?e("div",{staticClass:"cross-server-tag"},[e("el-tag",{attrs:{size:"mini",type:"info"}},[t._v("跨服")])],1):t._e()])]}}])}),e("el-table-column",{attrs:{prop:"school_desc",label:"等级/门派",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-tag",{attrs:{size:"mini"}},[t._v(" "+t._s(i.row.level)+" ")]),e("el-tag",{attrs:{type:"success",size:"mini"}},[t._v(" "+t._s(i.row.roleInfo.basic_info.school)+" ")])]}}])}),e("el-table-column",{attrs:{label:"修炼信息","min-width":"70"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"cultivation-info"},[e("div",{staticClass:"cultivation-row"},[e("span",{staticClass:"cultivation-values"},[t._v(" "+t._s(i.row.features.expt_ski1||0)+"/"+t._s(i.row.features.expt_ski2||0)+"/"+t._s(i.row.features.expt_ski3||0)+"/"+t._s(i.row.features.expt_ski4||0)+" ")])]),e("div",{staticClass:"cultivation-row"},[e("span",{staticClass:"cultivation-values"},[t._v(" "+t._s(i.row.features.beast_ski1||0)+"/"+t._s(i.row.features.beast_ski2||0)+"/"+t._s(i.row.features.beast_ski3||0)+"/"+t._s(i.row.features.beast_ski4||0)+" ")])]),i.row.total_cultivation?e("div",{staticClass:"cultivation-row"},[e("span",{staticClass:"cultivation-label"},[t._v("总修炼:")]),e("span",{staticClass:"cultivation-values total-cultivation"},[t._v(t._s(i.row.total_cultivation))])]):t._e()])]}}])}),e("el-table-column",{attrs:{label:"特殊属性","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"special-attributes"},[i.row.sum_exp?e("div",{staticClass:"attr-item"},[e("span",{staticClass:"attr-label"},[t._v("总经验:")]),e("span",{staticClass:"attr-value"},[t._v(t._s(i.row.sum_exp)+"亿")])]):t._e(),i.row.all_new_point?e("div",{staticClass:"attr-item"},[e("span",{staticClass:"attr-label"},[t._v("乾元丹:")]),e("span",{staticClass:"attr-value special-value"},[t._v(t._s(i.row.all_new_point)+"点")])]):t._e(),i.row.three_fly_lv?e("div",{staticClass:"attr-item"},[e("span",{staticClass:"attr-label"},[t._v("化圣:")]),e("span",{staticClass:"attr-value special-value"},[t._v(t._s(i.row.three_fly_lv)+"重")])]):t._e(),i.row.school_history_count>1?e("div",{staticClass:"attr-item"},[e("span",{staticClass:"attr-label"},[t._v("转门派:")]),e("span",{staticClass:"attr-value"},[t._v(t._s(i.row.school_history_count)+"次")])]):t._e()])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"80",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-link",{attrs:{href:t.getCBGLinkByType(i.row.eid),type:"danger",target:"_blank"}},[t._v("藏宝阁")])]}}])})],1)},x=[],C=i(8770),q=function(){var t=this,e=t._self._c;return e("el-popover",{attrs:{width:715,"data-equip-sn":t.$attrs.equip_sn,placement:"right",trigger:"click","popper-class":"role-info-popover"},scopedSlots:t._u([{key:"reference",fn:function(){return[t._t("default"),e("el-image",{staticStyle:{display:"block"},style:t.imageStyle,attrs:{src:t.imageUrl,fit:"cover",referrerpolicy:"no-referrer"}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])])]},proxy:!0}],null,!0),model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?e("div",{attrs:{id:"role_info_box"}},[e("el-tabs",{staticClass:"role-info-tabs tabCont",model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t.basic_info?e("el-tab-pane",{attrs:{label:"人物/修炼",name:"role_basic"}},[e("div",{staticClass:"cols",staticStyle:{width:"320px"}},[e("div",{staticClass:"subTab"},[e("h4",{staticClass:"subTabLeft role_basic_attr_tab",class:{off:0!==t.currentDisplayIndex},on:{click:function(e){return t.toggle_display(0)}}},[t._v(" 人物状态 ")]),e("h4",{staticClass:"subTabRight role_basic_attr_tab",class:{off:1!==t.currentDisplayIndex},on:{click:function(e){return t.toggle_display(1)}}},[t._v(" 输出/抗性 ")])]),e("table",{directives:[{name:"show",rawName:"v-show",value:0===t.currentDisplayIndex,expression:"currentDisplayIndex === 0"}],staticClass:"tb02 role_basic_attr_table",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[e("colgroup",[e("col",{attrs:{width:"180"}}),e("col",{attrs:{width:"140"}})]),e("tr",[e("td",[e("strong",[t._v("级别：")]),t._v(t._s(t.basic_info.role_level))]),e("td",[e("strong",[t._v("名称：")]),t._v(t._s(t.htmlEncode(t.basic_info.nickname)))])]),e("tr",[e("td",[e("strong",[t._v("角色：")]),t._v(t._s(t.basic_info.role_kind_name))]),e("td",[e("strong",[t._v("人气：")]),t._v(t._s(t.basic_info.pride))])]),e("tr",[e("td",[e("strong",[t._v("帮派：")]),t._v(t._s(t.basic_info.org))]),e("td",[e("strong",[t._v("帮贡：")]),t._v(t._s(t.basic_info.org_offer))])]),e("tr",[e("td",[e("strong",[t._v("门派：")]),e("span",{attrs:{id:"kindName"}},[t._v(t._s(t.basic_info.school))])]),e("td",[e("strong",[t._v("门贡：")]),t._v(t._s(t.basic_info.school_offer))])]),e("tr",[e("td",[e("strong",[t._v("气血：")]),t._v(t._s(t.basic_info.hp_max))]),e("td",[e("strong",[t._v("体质：")]),t._v(t._s(t.basic_info.cor_all))])]),e("tr",[e("td",[e("strong",[t._v("魔法：")]),t._v(t._s(t.basic_info.mp_max))]),e("td",[e("strong",[t._v("魔力：")]),t._v(t._s(t.basic_info.mag_all))])]),e("tr",[e("td",[e("strong",[t._v("命中：")]),t._v(t._s(t.basic_info.att_all))]),e("td",[e("strong",[t._v("力量：")]),t._v(t._s(t.basic_info.str_all))])]),e("tr",[e("td",[e("strong",[t._v("伤害：")]),t._v(t._s(t.basic_info.damage_all))]),e("td",[e("strong",[t._v("耐力：")]),t._v(t._s(t.basic_info.res_all))])]),e("tr",[e("td",[e("strong",[t._v("防御：")]),t._v(t._s(t.basic_info.def_all))]),e("td",[e("strong",[t._v("敏捷：")]),t._v(t._s(t.basic_info.spe_all))])]),e("tr",[e("td",[e("strong",[t._v("速度：")]),t._v(t._s(t.basic_info.dex_all))]),e("td",[e("strong",[t._v("潜力：")]),t._v(t._s(t.basic_info.point))])]),e("tr",[void 0!==t.basic_info.fa_shang?e("td",[e("strong",[t._v("法伤：")]),t._v(t._s(t.basic_info.fa_shang)+" ")]):e("td",[e("strong",[t._v("躲避：")]),t._v(t._s(t.basic_info.dod_all))]),e("td",[e("strong",[t._v("靓号特效：")]),t._v(t._s(t.basic_info.is_niceid))])]),e("tr",[void 0!==t.basic_info.fa_fang?e("td",[e("strong",[t._v("法防：")]),t._v(t._s(t.basic_info.fa_fang)+" ")]):e("td",[e("strong",[t._v("灵力：")]),t._v(t._s(t.basic_info.mag_def_all))]),e("td",[e("strong",[t._v("成就点数：")]),t._v(t._s(t.basic_info.chengjiu))])]),e("tr",[e("td",[e("strong",[t._v("获得经验：")]),t._v(t._s(t.basic_info.upexp))]),e("td",[e("strong",[t._v("已用潜能果数量：")]),t._v(t._s(t.basic_info.qian_neng_guo))])]),e("tr",[e("td",[t.basic_info.qian_yuan_dan&&void 0===t.basic_info.qian_yuan_dan.new_value?e("span",[e("strong",[t._v("已兑换乾元丹数量：")]),t._v(t._s(t.basic_info.qian_yuan_dan.old_value)+" ")]):e("span",[e("strong",[t._v("新版乾元丹数量：")]),t._v(t._s(t.basic_info.qian_yuan_dan.new_value)+" ")])]),e("td",[e("strong",[t._v("总经验：")]),t._v(t._s(t.basic_info.sum_exp)+" "),t.basic_info.ach_info?e("i",{staticClass:"question hoverTips"},[e("span",{staticClass:"hoverTipsDetail"},[t._v(t._s(t.basic_info.ach_info))])]):t._e()])]),e("tr",[e("td",[e("strong",[t._v("月饼粽子机缘：")]),t._v(t._s((t.basic_info.add_point||0)+(t.basic_info.ji_yuan||0))+"/"+t._s(t.extraAttrPoints)+" "),t.extraAttrPoints>0?e("i",{staticClass:"question hoverTips"},[e("span",{staticClass:"hoverTipsDetail"},[t._v(" 月饼粽子食用量："+t._s(t.basic_info.add_point)),e("br"),e("br"),t._v("已获得机缘属性："+t._s(t.basic_info.ji_yuan)+" ")])]):t._e()]),e("td",[e("strong",[t._v("原始种族：")]),e("span",{domProps:{innerHTML:t._s(t.basic_info.ori_race)}})])]),e("tr",[e("td",[e("strong",[t._v("历史门派：")]),t._v(t._s(t.basic_info.changesch))]),e("td",[e("strong",[t._v("属性保存方案：")]),t._v(t._s(t.basic_info.propkept))])]),e("tr",[e("td",[e("strong",[t._v("飞升/渡劫/化圣：")]),t._v(t._s(t.basic_info.fly_status))]),t.basic_info.role_level>=120?e("td",[e("strong",[t._v("生死劫：")]),t._v(t._s(t.basic_info.shengsijie)+" ")]):e("td")])]),e("table",{directives:[{name:"show",rawName:"v-show",value:1===t.currentDisplayIndex,expression:"currentDisplayIndex === 1"}],staticClass:"tb02 role_basic_attr_table",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[t.basic_info.other_attr?[e("colgroup",[e("col",{attrs:{width:"160"}}),e("col",{attrs:{width:"160"}})]),e("tr",[e("td",{attrs:{colspan:"2"}},[e("strong",{staticStyle:{"font-size":"16px",color:"white"}},[t._v("输出")])])]),e("tr",[e("td",[e("strong",[t._v("灵力：")])]),e("td",[t._v(t._s(t.basic_info.other_attr["14"]))])]),e("tr",[e("td",[e("strong",[t._v("物理暴击等级：")])]),e("td",[t._v(" "+t._s(t.basic_info.other_attr["6"])+"("+t._s((10*t.basic_info.other_attr["6"]/Math.max(30,t.basic_info.role_level)||0).toFixed(2))+"%) ")])]),e("tr",[e("td",[e("strong",[t._v("穿刺等级：")])]),e("td",[t._v(" "+t._s(t.basic_info.other_attr["8"])+"("+t._s((3*t.basic_info.other_attr["8"]/Math.max(30,t.basic_info.role_level)||0).toFixed(2))+"%) ")])]),e("tr",[e("td",[e("strong",[t._v("狂暴等级：")])]),e("td",[t._v(" "+t._s(t.basic_info.other_attr["5"])+"("+t._s((3*t.basic_info.other_attr["5"]/Math.max(30,t.basic_info.role_level)||0).toFixed(2))+"%) ")])]),e("tr",[e("td",[e("strong",[t._v("法术暴击等级：")])]),e("td",[t._v(" "+t._s(t.basic_info.other_attr["7"])+"("+t._s((10*t.basic_info.other_attr["7"]/Math.max(30,t.basic_info.role_level)||0).toFixed(2))+"%) ")])]),e("tr",[e("td",[e("strong",[t._v("法术伤害结果：")])]),e("td",[t._v(t._s(t.basic_info.other_attr["12"]))])]),e("tr",[e("td",[e("strong",[t._v("封印命中等级：")])]),e("td",[t._v(" "+t._s(t.basic_info.other_attr["1"])+"("+t._s((10*t.basic_info.other_attr["1"]/Math.max(30,t.basic_info.role_level+25)||0).toFixed(2))+"%) ")])]),e("tr",[e("td",[e("strong",[t._v("治疗能力：")])]),e("td",[t._v(t._s(t.basic_info.other_attr["3"]))])]),e("tr",[e("td",{attrs:{colspan:"2"}},[e("strong",{staticStyle:{"font-size":"16px",color:"white"}},[t._v("抗性")])])]),e("tr",[e("td",[e("strong",[t._v("抗物理暴击等级：")])]),e("td",[t._v(" "+t._s(t.basic_info.other_attr["9"])+"("+t._s((10*t.basic_info.other_attr["9"]/Math.max(30,t.basic_info.role_level)||0).toFixed(2))+"%) ")])]),e("tr",[e("td",[e("strong",[t._v("格挡值：")])]),e("td",[t._v(t._s(t.basic_info.other_attr["11"]))])]),e("tr",[e("td",[e("strong",[t._v("抗法术暴击等级：")])]),e("td",[t._v(" "+t._s(t.basic_info.other_attr["10"])+"("+t._s((10*t.basic_info.other_attr["10"]/Math.max(30,t.basic_info.role_level)||0).toFixed(2))+"%) ")])]),e("tr",[e("td",[e("strong",[t._v("抵抗封印等级：")])]),e("td",[t._v(" "+t._s(t.basic_info.other_attr["2"])+"("+t._s((10*t.basic_info.other_attr["2"]/Math.max(30,t.basic_info.role_level+25)||0).toFixed(2))+"%) ")])]),e("tr",[e("td",[e("strong",[t._v("气血回复效果：")])]),e("td",[t._v(t._s(t.basic_info.other_attr["4"]))])]),e("tr",[e("td",[e("strong",[t._v("躲避：")])]),e("td",[t._v(t._s(t.basic_info.other_attr["13"]))])])]:[e("colgroup",[e("col",{attrs:{width:"320"}})]),e("tr",[e("td",[e("br"),t._v("重新寄售后才能显示")])])]],2)]),e("div",{staticClass:"cols",staticStyle:{width:"320px"}},[e("h4",[t._v("角色修炼及宠修")]),e("table",{staticClass:"tb02",staticStyle:{float:"left"},attrs:{width:"49%",cellspacing:"0",cellpadding:"0"}},t._l(t.role_xiulian,function(i,s){return e("tr",{key:s},[e("th",{attrs:{width:"100"}},[t._v(t._s(i.name)+"：")]),e("td",{staticStyle:{"white-space":"nowrap"}},[t._v(t._s(i.info))])])}),0),e("table",{staticClass:"tb02",staticStyle:{float:"right"},attrs:{width:"49%",cellspacing:"0",cellpadding:"0"}},[void 0!==t.yu_shou_shu?e("tr",[e("th",{attrs:{width:"100"}},[t._v("育兽术：")]),e("td",[t._v(t._s(t.yu_shou_shu))])]):t._e(),t._l(t.pet_ctrl_skill,function(i,s){return e("tr",{key:s},[e("th",{attrs:{width:"100"}},[t._v(t._s(i.name)+"：")]),e("td",[t._v(t._s(i.grade))])])})],2),e("div",{staticClass:"blank9",staticStyle:{clear:"both"}}),e("div",{staticClass:"blank9"}),e("h4",[t._v("积分 其他")]),e("table",{staticClass:"tb02",attrs:{width:"92%",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("th",{attrs:{width:"80"}},[t._v("比武积分：")]),e("td",[t._v(t._s(t.basic_info.hero_score))]),e("th",{attrs:{width:"80"}},[t._v("剑会积分：")]),e("td",[t._v(t._s(t.basic_info.sword_score))])]),e("tr",[e("th",{attrs:{width:"80"}},[t._v("三界功绩：")]),e("td",[t._v(t._s(t.basic_info.sanjie_score))]),e("th",{attrs:{width:"80"}},[t._v("副本积分：")]),e("td",[t._v(t._s(t.basic_info.dup_score))])]),e("tr",[e("th",{attrs:{width:"80"}},[t._v("神器积分：")]),e("td",[t._v(t._s(t.basic_info.shenqi_score))]),e("th"),e("td")])])])]):t._e(),t.school_skill?e("el-tab-pane",{attrs:{label:"技能",name:"role_skill"}},[e("div",{staticClass:"cols",staticStyle:{width:"200px"}},[e("h4",[t._v("师门技能")]),e("div",{staticClass:"skill"},[t.school_skill.length>7?e("p",{staticClass:"textCenter cDYellow"},[t._v("师门技能信息有误")]):0==t.school_skill.length?e("p",{staticClass:"textCenter cDYellow"},[t._v("师门技能都是0")]):e("ul",{attrs:{id:"school_skill_lists"}},[e("li",{staticStyle:{left:"60px",top:"0"}},[e("img",{attrs:{referrerpolicy:"no-referrer",src:t.school_skill2_icon,data_equip_name:t.school_skill2_name,data_skill_type:"school_skill",data_equip_desc:t.school_skill2_desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(t.school_skill2_grade))]),e("h5",[t._v(t._s(t.school_skill2_name))])]),e("li",{staticStyle:{left:"0",top:"50px"}},[e("img",{attrs:{referrerpolicy:"no-referrer",src:t.school_skill3_icon,data_equip_name:t.school_skill3_name,data_skill_type:"school_skill",data_equip_desc:t.school_skill3_desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(t.school_skill3_grade))]),e("h5",[t._v(t._s(t.school_skill3_name))])]),e("li",{staticStyle:{left:"120px",top:"50px"}},[e("img",{attrs:{referrerpolicy:"no-referrer",src:t.school_skill4_icon,data_equip_name:t.school_skill4_name,data_skill_type:"school_skill",data_equip_desc:t.school_skill4_desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(t.school_skill4_grade))]),e("h5",[t._v(t._s(t.school_skill4_name))])]),e("li",{staticStyle:{left:"0",top:"140px"}},[e("img",{attrs:{referrerpolicy:"no-referrer",src:t.school_skill5_icon,data_equip_name:t.school_skill5_name,data_skill_type:"school_skill",data_equip_desc:t.school_skill5_desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(t.school_skill5_grade))]),e("h5",[t._v(t._s(t.school_skill5_name))])]),e("li",{staticStyle:{left:"120px",top:"140px"}},[e("img",{attrs:{referrerpolicy:"no-referrer",src:t.school_skill6_icon,data_equip_name:t.school_skill6_name,data_skill_type:"school_skill",data_equip_desc:t.school_skill6_desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(t.school_skill6_grade))]),e("h5",[t._v(t._s(t.school_skill6_name))])]),e("li",{staticStyle:{left:"60px",top:"94px"}},[e("img",{attrs:{referrerpolicy:"no-referrer",src:t.school_skill1_icon,data_equip_name:t.school_skill1_name,data_skill_type:"school_skill",data_equip_desc:t.school_skill1_desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(t.school_skill1_grade))]),e("h5",[t._v(t._s(t.school_skill1_name))])]),e("li",{staticStyle:{left:"60px",top:"200px"}},[e("img",{attrs:{referrerpolicy:"no-referrer",src:t.school_skill7_icon,data_equip_name:t.school_skill7_name,data_skill_type:"school_skill",data_equip_desc:t.school_skill7_desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(t.school_skill7_grade))]),e("h5",[t._v(t._s(t.school_skill7_name))])])])])]),e("div",{staticClass:"cols",staticStyle:{width:"442px","margin-left":"18px"}},[e("h4",[t._v("生活技能")]),e("div",{staticClass:"blank12"}),t.life_skill&&t.life_skill.length>0?e("div",[e("table",{staticClass:"skillTb",attrs:{cellspacing:"0",cellpadding:"0",id:"life_skill_lists"}},t._l(t.skillRows(t.life_skill,7),function(i,s){return e("tr",{key:s},t._l(i,function(i,s){return e("td",{key:s},[e("img",{attrs:{referrerpolicy:"no-referrer",src:i.skill_icon,width:"40",height:"40",data_equip_name:i.name,data_skill_type:"life_skill",data_equip_desc:i.desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(i.skill_grade))]),e("h5",[t._v(t._s(i.skill_name))])])}),0)}),0)]):e("div",{staticClass:"textCenter",staticStyle:{"padding-bottom":"30px"}},[t._v("无")]),e("div",{staticClass:"blank9"}),e("h4",[t._v("剧情技能")]),e("div",{staticClass:"blank12"}),t.ju_qing_skill&&t.ju_qing_skill.length>0?e("div",[e("table",{staticClass:"skillTb",attrs:{cellspacing:"0",cellpadding:"0",id:"juqing_skill_lists"}},t._l(t.skillRows(t.ju_qing_skill,7),function(i,s){return e("tr",{key:s},t._l(i,function(i,s){return e("td",{key:s},[e("img",{attrs:{referrerpolicy:"no-referrer",src:i.skill_icon,width:"40",height:"40",data_equip_name:i.name,data_skill_type:"ju_qing_skill",data_equip_desc:i.desc,data_tip_box:"RoleSkillTipsBox"}}),e("p",[t._v(t._s(i.skill_grade))]),e("h5",[t._v(t._s(i.skill_name))])])}),0)}),0)]):e("div",{staticClass:"textCenter",staticStyle:{"padding-bottom":"30px"}},[t._v("无")]),e("p",{staticClass:"textRight cDYellow"},[t._v("剩余技能点："+t._s(t.left_skill_point))]),e("div",{staticClass:"blank9"}),e("h4",[t._v("熟练度")]),e("table",{staticClass:"tb02",attrs:{width:"92%",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("th",{attrs:{width:"100"}},[t._v("打造熟练度：")]),e("td",[t._v(t._s(t.shuliandu.smith_skill))]),e("th",{attrs:{width:"100"}},[t._v("裁缝熟练度：")]),e("td",[t._v(t._s(t.shuliandu.sew_skill))])])])])]):t._e(),e("el-tab-pane",{attrs:{label:"道具/法宝",name:"role_equips"}},[e("div",{staticClass:"cols",staticStyle:{width:"350px"}},[e("h4",[t._v("道具")]),e("table",{staticStyle:{margin:"0 auto"},attrs:{width:"80%",cellspacing:"3",cellpadding:"3",id:"RoleUsingEquips"}},[e("tr",[e("td",{attrs:{colspan:"3"}},[e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0"}},[e("tr",[e("td",[e("ItemPopover",{attrs:{id:"role_using_equip_187",equipment:t.get_using_equip(187)}})],1),e("td",[e("ItemPopover",{attrs:{id:"role_using_equip_187",equipment:t.get_using_equip(188)}})],1),e("td",[e("ItemPopover",{attrs:{id:"role_using_equip_187",equipment:t.get_using_equip(190)}})],1),e("td",[e("ItemPopover",{attrs:{id:"role_using_equip_187",equipment:t.get_using_equip(189)}})],1)])])])]),e("tr",[e("td",[e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0"}},[e("tr",[e("td",[e("ItemPopover",{attrs:{id:"role_using_equip_1",equipment:t.get_using_equip(1)}})],1)]),e("tr",[e("td",[e("ItemPopover",{attrs:{id:"role_using_equip_6",equipment:t.get_using_equip(6)}})],1)]),e("tr",[e("td",[e("ItemPopover",{attrs:{id:"role_using_equip_5",equipment:t.get_using_equip(5)}})],1)])])]),e("td",[e("table",{staticClass:"tb02",attrs:{cellspacing:"0",cellpadding:"0"}},[e("tr",[e("th",[t._v("现金：")]),e("td",[t._v(t._s(t.basic_info.cash))])]),e("tr",[e("th",[t._v("存银：")]),e("td",[t._v(t._s(t.basic_info.saving))])]),e("tr",[e("th",[t._v("储备：")]),e("td",[t._v(t._s(t.basic_info.learn_cash))])]),e("tr",[e("th",[t._v("善恶：")]),e("td",[t._v(t._s(t.basic_info.badness))])]),e("tr",[e("th",[t._v("仙玉：")]),e("td",[t._v(t._s(t.basic_info.xianyu))])]),e("tr",[e("th",[t._v("精力：")]),e("td",[t._v(t._s(t.basic_info.energy))])])])]),e("td",[e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0"}},[e("tr",[e("td",[e("ItemPopover",{attrs:{equipment:t.get_using_equip(4),id:"role_using_equip_4"}})],1)]),e("tr",[e("td",[e("ItemPopover",{attrs:{equipment:t.get_using_equip(2),id:"role_using_equip_2"}})],1)]),e("tr",[e("td",[e("ItemPopover",{attrs:{equipment:t.get_using_equip(3),id:"role_using_equip3"}})],1)])])])])]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleStoreEquips"}},t._l(t.storeEquipsRows,function(i,s){return e("tr",{key:s},[t._l(i,function(t,i){return e("td",{key:i},[e("ItemPopover",{attrs:{id:"store_equip_tips"+(5*s+i+1),equipment:t?{equip_sn:t.equip_sn,equip_face_img:t.small_icon,equip_name:t.name,equip_type_desc:t.static_desc,large_equip_desc:t.desc,lock_type:t.lock_type}:null}})],1)}),t._l(5-i.length,function(t){return e("td",{key:"empty-"+t},[e("ItemPopover",{attrs:{equipment:null}})],1)})],2)}),0),t.split_equips&&t.split_equips.length?e("div",{staticClass:"blank9"}):t._e(),t.split_equips&&t.split_equips.length?e("h4",[t._v("拆卖道具")]):t._e(),t.split_equips&&t.split_equips.length?e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"3",id:"RoleSplitEquips"}},t._l(t.splitEquipsRows,function(i,s){return e("tr",{key:s},[t._l(i,function(i,s){return e("td",{key:s},[e("a",{staticStyle:{display:"block",width:"100%",height:"100%"},attrs:{href:t.getCBGLinkByType(i.eid,"equip"),target:"_blank",tid:"gl03odgw",data_trace_text:i.eid}},[e("ItemPopover",{attrs:{equipment:t.get_using_equip(i)}})],1)])}),t._l(5-i.length,function(t){return e("td",{key:"empty-"+t})})],2)}),0):t._e()]),e("div",{staticClass:"cols",staticStyle:{width:"300px","margin-left":"25px"}},[e("div",{staticClass:"cols",staticStyle:{width:"145px","margin-left":"0"}},[e("h4",[t._v("神器")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb03 size50",staticStyle:{"table-layout":"fixed"},attrs:{cellspacing:"0",cellpadding:"0",id:"RoleStoreShenqi"}},[e("tr",[e("el-popover",{attrs:{trigger:"click",placement:"bottom","popper-class":"shenqi-info-popover"},scopedSlots:t._u([{key:"reference",fn:function(){return[t.shenqi?e("td",{staticClass:"shenqi_td",staticStyle:{background:"#c0b9dd"},attrs:{id:"shenqi",data_equip_name:t.shenqi.name,data_equip_type:t.shenqi.type,data_equip_desc:t.shenqi.desc,data_equip_type_desc:t.shenqi.static_desc}},[e("ItemPopover",{attrs:{equipment:{equip_face_img:t.shenqi.icon,equip_name:t.shenqi.name,equip_type_desc:t.shenqi.static_desc,large_equip_desc:t.shenqi.desc}}})],1):t._e()]},proxy:!0}],null,!1,2357829030)},[e("div",{staticClass:"shenqi-modal",attrs:{id:"shenqiModal"}},[e("h4",{staticClass:"modal-head"},[t._v(" 神器属性 "),e("span",{staticClass:"modal-close-btn",attrs:{id:"shenqiCloseBtn"}})]),e("div",{staticClass:"shenqi-modal-content"},[t.shenqi?.isNew?e("ul",{staticClass:"shenqi-tab"},t._l(3,function(i){return e("li",{key:i,class:["tab-item","js_shenqi_tab",t.shenqi_components["shenqi"+i]?t.shenqi_components["shenqi"+i]&&t.shenqi_components["shenqi"+i].actived?"active":"":"disable"],attrs:{"data-index":i-1},on:{click:function(e){return t.switchShenqiTab(i-1)}}},[t._v(" 第"+t._s(["一","二","三"][i-1])+"套属性 ")])}),0):t._e(),e("div",{staticClass:"shenqi-list"},t._l(t.shenqi_components,function(i,s){return e("div",{key:s,staticClass:"js_shenqi_panel",style:{display:i.actived?"":"none"}},t._l(i.components,function(i,s){return e("div",{key:s,staticClass:"shenqi-itme"},[e("div",{staticClass:"shenqi-item-left"},[e("img",{attrs:{referrerpolicy:"no-referrer",src:i.buweiPic}})]),e("div",{staticClass:"col-r"},[e("ul",{staticClass:"shenqi-item-center"},t._l(i.wuxing,function(i,s){return e("li",{key:s},[1!==i.status?e("div",{staticClass:"img-wrap"},[e("img",{attrs:{referrerpolicy:"no-referrer",src:i.lingxiPic}})]):e("div",[e("div",{staticClass:"img-wrap"},[e("img",{attrs:{referrerpolicy:"no-referrer",src:i.lingxiPic}}),i.wuxing_affix_text?e("span",{staticClass:"cizhui"},[t._v(t._s(i.wuxing_affix_text))]):t._e()]),e("p",[t._v(t._s(i.wuxingText))])])])}),0),e("ul",{staticClass:"shenqi-item-right"},t._l(i.wuxing,function(i,s){return e("li",{key:s},[t._v(" "+t._s(i.attr)+" ")])}),0)])])}),0)}),0)])])]),t.huoshenta?e("td",{staticClass:"shenqi_td",staticStyle:{background:"#c0b9dd"},attrs:{data_equip_name:t.huoshenta.name,data_equip_type:t.shenqi?.type,data_equip_desc:t.huoshenta.desc,data_equip_type_desc:""}},[e("ItemPopover",{attrs:{equipment:{equip_face_img:t.huoshenta.icon,equip_name:t.huoshenta.name,large_equip_desc:t.huoshenta.desc}}})],1):t._e(),t.shenqi||t.huoshenta?t._e():e("td",{staticStyle:{background:"rgb(192, 185, 221)"}})],1)])]),e("div",{staticClass:"cols",staticStyle:{width:"145px","margin-right":"0"}},[e("h4",[t._v("已装备灵宝")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb03 size50",staticStyle:{"table-layout":"fixed"},attrs:{cellspacing:"0",cellpadding:"0"}},[e("tr",{attrs:{id:"RoleUsingLingbao"}},[t._l(t.using_lingbao.concat([null,null]).slice(0,2),function(t,i){return[t?e("td",{key:"lingbao-"+i,staticStyle:{background:"#c0b9dd"},attrs:{data_equip_name:t.name,data_equip_type:t.type,data_equip_desc:t.desc,data_equip_type_desc:t.static_desc}},[e("ItemPopover",{attrs:{equipment:{equip_face_img:t.icon,equip_name:t.name,equip_type_desc:t.static_desc,large_equip_desc:t.desc}}})],1):e("td",{key:"empty-"+i,staticStyle:{background:"#c0b9dd"}})]})],2)])])]),e("div",{staticClass:"cols",staticStyle:{width:"300px","margin-left":"24px"}},[e("div",{staticClass:"blank12"}),e("h4",[t._v("未装备灵宝")]),e("div",{staticClass:"blank9"}),e("div",{staticStyle:{"max-height":"125px",width:"274px",overflow:"auto","overflow-x":"hidden",margin:"0 auto"}},[e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleNoUsingLingbao"}},t._l(t.nousingLingbaoRows,function(i,s){return e("tr",{key:s},[t._l(i,function(t,i){return[t?e("td",{key:"lingbao-"+i,staticStyle:{background:"#c0b9dd"},attrs:{data_equip_name:t.name,data_equip_type:t.type,data_equip_desc:t.desc,data_equip_type_desc:t.static_desc}},[e("ItemPopover",{attrs:{equipment:{equip_face_img:t.icon,equip_name:t.name,equip_type_desc:t.static_desc,large_equip_desc:t.desc}}})],1):e("td",{key:"empty-"+i,staticStyle:{background:"#c0b9dd"}})]})],2)}),0)]),e("div",{staticClass:"blank12"}),e("h4",[t._v("已装备法宝")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleUsingFabao"}},[e("tr",t._l(4,function(i){return e("td",{key:"fabao-"+i,staticStyle:{background:"#c0b9dd"}},[e("ItemPopover",{attrs:{equipment:t.get_using_fabao(i),align:"middle"}})],1)}),0)]),e("div",{staticClass:"blank12"}),e("h4",[t._v(" 未装备的所有法宝 "),void 0!==t.unused_fabao_sum?e("span",[t._v("("+t._s(t.unused_fabao_sum)+"/"+t._s(t.fabao_storage_size)+")")]):t._e()]),e("div",{staticClass:"blank9"}),e("div",{staticStyle:{height:"205px",width:"274px",overflow:"auto","overflow-x":"hidden",margin:"0 auto"},attrs:{id:"fabao_table_wrapper"}},[e("table",{staticClass:"tb03 size50",staticStyle:{"table-layout":"fixed"},attrs:{width:"256",cellspacing:"0",cellpadding:"0",id:"RoleStoreFabao"}},t._l(t.storeFabaoRows,function(i,s){return e("tr",{key:s},[t._l(i,function(i,s){return i?e("td",{key:s,staticStyle:{background:"#c0b9dd"}},[e("ItemPopover",{attrs:{equipment:t.get_using_fabao(i)}})],1):t._e()}),t._l(5-i.length,function(t){return e("td",{key:"empty-"+t,staticStyle:{background:"#c0b9dd"}})})],2)}),0)]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb02",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("th",{attrs:{width:"100"}},[t._v("行囊扩展：")]),e("td",[t._v(t._s(t.basic_info.package_num))])])])])]),e("el-tab-pane",{attrs:{label:"召唤兽/孩子",name:"role_pets"}},[e("div",{staticClass:"cols",staticStyle:{width:"190px"}},[t.split_pets&&t.split_pets.length?e("div",[e("h4",[t._v("拆卖召唤兽")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb03 size50 pet-split-tb",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleSplitPets"}},[0===t.split_pets.length?e("tr",[e("td",{staticClass:"noData"},[t._v("无")])]):t._l(t.splitPetsRows,function(i,s){return e("tr",{key:s},[t._l(i,function(i,a){return e("td",{key:a},[e("div",{staticClass:"pet-split-img-wrap"},[e("img",{class:{on:t.current_pet&&t.current_pet.equip_sn===i.equip_sn},attrs:{referrerpolicy:"no-referrer",src:i.icon,data_idx:3*s+a},on:{click:function(e){return t.onPetAvatarClick(i)}}})]),e("a",{staticClass:"btn-pet-detail",attrs:{href:t.getCBGLinkByType(i.eid,"equip"),tid:"57i8um2f",data_trace_text:i.eid,target:"_blank"}},[t._v("查看详情")])])}),t._l(3-i.length,function(i){return e("td",{key:"empty-"+i,staticStyle:{width:"54px",height:"54px",display:"none"}},[t._v("   ")])})],2)})],2)]):t._e(),e("h4",[t._v("召唤兽("+t._s(t.pet_info.length)+"/"+t._s(t.allow_pet_count)+")")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0",id:"RolePets"}},[0===t.pet_info.length?e("tr",[e("td",{staticClass:"noData"},[t._v("无")])]):t._l(t.petInfoRows,function(s,a){return e("tr",{key:a},[t._l(s,function(s,l){return e("td",{key:l,staticStyle:{width:"54px",height:"54px",cursor:"pointer",position:"relative"}},[e("img",{class:{on:t.current_pet&&t.current_pet.equip_sn===s.equip_sn},attrs:{referrerpolicy:"no-referrer",src:s.icon,data_idx:3*a+l},on:{click:function(e){return t.onPetAvatarClick(s)}}}),t.getPetRightLock(s)?.length>0?e("div",{staticStyle:{position:"absolute",width:"14px",right:"0px",top:"0px"}},t._l(t.getPetRightLock(s),function(t){return e("img",{key:t,staticStyle:{height:"14px",width:"14px",display:"block"},attrs:{src:i(1900)(`./time_lock_${t}.webp`)}})}),0):t._e(),t.getPetLeftLock(s)?.length>0?e("div",{staticStyle:{position:"absolute",width:"14px",left:"0px",top:"0px"}},t._l(t.getPetLeftLock(s),function(t){return e("img",{key:t,staticStyle:{height:"14px",width:"14px",display:"block"},attrs:{src:i(1900)(`./time_lock_${t}.webp`)}})}),0):t._e()])}),t._l(3-s.length,function(i){return e("td",{key:"empty-"+i,staticStyle:{width:"54px",height:"54px",display:"none"}},[t._v("   ")])})],2)})],2),e("div",{staticClass:"blank12"}),e("h4",[t._v("孩子")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleChilds"}},[0===t.child_info.length?e("tr",[e("td",{staticClass:"noData"},[t._v("无")])]):t._l(t.childListRows,function(i,s){return e("tr",{key:s},[t._l(i,function(i,a){return e("td",{key:a,staticStyle:{width:"54px",height:"54px",cursor:"pointer"}},[e("img",{class:{on:t.current_pet&&t.current_pet.equip_sn===i.equip_sn&&t.current_pet.index===a},attrs:{referrerpolicy:"no-referrer",src:i.icon,data_idx:2*s+a},on:{click:function(e){return t.onPetAvatarClick({index:a,...i})}}})])}),t._l(2-i.length,function(i){return e("td",{key:"empty-"+i,staticStyle:{width:"54px",height:"54px",display:"none"}},[t._v("   ")])})],2)})],2),e("div",{staticClass:"blank12"}),e("h4",[t._v("特殊召唤兽")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb02",attrs:{cellspacing:"0",cellpadding:"0"}},[void 0===t.special_pet_info?e("tr",[e("td",{staticClass:"noData",attrs:{colspan:"3"}},[t._v("未知")])]):0===t.special_pet_info.length?e("tr",[e("td",{staticClass:"noData",attrs:{colspan:"3"}},[t._v("无")])]):[t._l(t.special_pet_info,function(i,s){return[e("tr",{key:s},[e("th",[t._v(t._s(i.cName))]),e("td",[t._v(t._s(i.all_skills[0].name))]),e("td",[t._v(t._s(i.all_skills[0].value))])]),t._l(i.all_skills.slice(1),function(i,s){return e("tr",{key:s},[e("td",[t._v(" ")]),e("td",[t._v(t._s(i.name))]),e("td",[t._v(t._s(i.value))])])})]})]],2),e("div",{staticClass:"blank12"}),e("h4",[t._v("召唤兽心得技能")]),e("table",{staticClass:"tb02",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[e("tbody",[e("tr",[e("th",{attrs:{width:"100"}},[t._v("已解锁技能数：")]),e("td",{staticClass:"sbook-skill-val",attrs:{id:"show_more_sbook_skill"}},[t.sbook_skill&&t.sbook_skill.length>0?e("span",{staticClass:"text-underline",attrs:{title:t.sbook_skill.join(",")}},[t._v(t._s(t.sbook_skill.length)+"/"+t._s(t.sbook_skill_total))]):e("span",[t._v("无")])])])])])]),e("div",{staticClass:"cols",staticStyle:{width:"456px","margin-left":"18px"},attrs:{id:"pet_detail_panel"}},[0===t.pet_info.length&&0===t.child_info.length&&0===t.split_pets.length?e("div",[e("h4",[t._v("详细信息")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb02 petZiZhiTb",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("td",{staticClass:"noData",staticStyle:{"text-align":"center"}},[t._v("无")])])])]):t.current_pet?e("PetDetail",{attrs:{current_pet:t.current_pet}}):t._e()],1)]),e("el-tab-pane",{attrs:{label:"坐骑",name:"role_riders"}},[e("div",{staticClass:"cols",staticStyle:{width:"320px"}},[e("h4",[t._v("坐骑")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleRiders"}},[t.rider_info.length<=0?e("tr",[e("td",{staticClass:"noData"},[t._v("无")])]):t._l(t.riderRows,function(i,s){return e("tr",{key:s},[t._l(i,function(i,a){return e("td",{key:a,staticStyle:{width:"54px",height:"54px",cursor:"pointer"}},[e("img",{class:{on:t.current_rider_index===`${s}-${a}`},attrs:{referrerpolicy:"no-referrer",src:i.icon,width:"50",height:"50",data_idx:5*s+a},on:{click:function(e){t.current_rider_index=`${s}-${a}`}}})])}),t._l(5-i.length,function(t){return e("td",{key:"empty-"+t,staticStyle:{display:"none"}})})],2)})],2),e("div",{staticClass:"blank12"}),e("div",{attrs:{id:"rider_detail_panel"}},[e("table",{staticClass:"tb02",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("th",[t._v("类型：")]),e("td",[t._v(t._s(t.currentRider.type_name))]),e("th",[t._v("主属性：")]),e("td",[t._v(t._s(t.currentRider.mattrib))])]),e("tr",[e("th",[t._v("等级：")]),e("td",[t._v(t._s(t.currentRider.grade))]),e("th",[t._v(" ")]),e("td",[t._v(" ")])]),e("tr",[e("th",[t._v("成长：")]),e("td",[t._v(t._s(t.currentRider.exgrow))]),e("th",[t._v(" ")]),e("td",[t._v(" ")])])]),e("div",{staticClass:"blank12"}),t.currentRider&&t.currentRider.all_skills&&t.currentRider.all_skills.length>0?e("div",[e("table",{staticClass:"skillTb",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleRiderSkill"}},t._l(t.riderSkillRows,function(i,s){return e("tr",{key:s},[t._l(i,function(i,s){return e("td",{key:s},[e("img",{attrs:{title:i.name+" ("+i.grade+"级)\n"+i.desc,referrerpolicy:"no-referrer",src:i.icon,width:"40",height:"40",data_equip_name:i.name,data_skill_type:"riderSkill",data_equip_desc:i.desc,data_equip_level:i.grade}}),e("p",[t._v(t._s(i.grade))])])}),t._l(6-i.length,function(t){return e("td",{key:"empty-"+t})})],2)}),0)]):t._e()]),e("h4",[t._v("携带玄灵珠")]),e("div",{staticClass:"blank9"}),e("div",{staticClass:"roleModuleScroller",staticStyle:{"max-height":"22em"}},[e("table",{staticClass:"tb03 size50",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleXunlingzhu"}},[t.rider_plan_list.length>0?e("tr",t._l(t.rider_plan_list,function(i,s){return e("td",{key:s,staticStyle:{width:"54px",height:"54px",cursor:"pointer"}},[1==i.type?e("img",{class:{on:t.current_rider_plan_index===s},attrs:{referrerpolicy:"no-referrer",src:t.ResUrl+"/images/big/56973.gif",width:"50",height:"50",data_idx:s},on:{click:function(e){t.current_rider_plan_index=s}}}):2==i.type?e("img",{class:{on:t.current_rider_plan_index===s},attrs:{referrerpolicy:"no-referrer",src:t.ResUrl+"/images/big/56974.gif",width:"50",height:"50",data_idx:s},on:{click:function(e){t.current_rider_plan_index=s}}}):t._e(),0==s?e("span",[t._v("第一套")]):1==s?e("span",[t._v("第二套")]):t._e()])}),0):e("tr",[e("td",{staticClass:"noData"},[t._v("无")])])]),e("div",{staticClass:"blank12"}),e("div",{attrs:{id:"xuanlingzhu_detail_panel"}},[t.currentRiderPlan?e("div",[e("table",{staticClass:"tb02",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[1===t.currentRiderPlan.type?e("tr",[e("th",{staticStyle:{width:"48px"}},[t._v("类型：")]),e("td",[t._v(t._s(t.currentRiderPlan.level)+"级回春")]),e("th",[t._v(" ")]),e("td",[t._v(" ")])]):t._e(),1===t.currentRiderPlan.type?e("tr",[e("th",{staticStyle:{width:"48px"}},[t._v("效果：")]),e("td",[t._v(' 战斗中"召唤"召唤兽或孩子时，恢复自身'+t._s(t.EquipLevel*t.currentRiderPlan.level)+"点气血和"+t._s(t.currentRiderPlan.level)+"点愤怒。 ")])]):t._e(),2===t.currentRiderPlan.type?e("tr",[e("th",{staticStyle:{width:"48px"}},[t._v("类型：")]),e("td",[t._v(t._s(t.currentRiderPlan.level)+"级破军")]),e("th",[t._v(" ")]),e("td",[t._v(" ")])]):t._e(),2===t.currentRiderPlan.type?e("tr",[e("th",{staticStyle:{width:"48px"}},[t._v("效果：")]),e("td",[t._v(' 战斗中"召唤"召唤兽或孩子时，有'+t._s(12.5*t.currentRiderPlan.level)+"%几率提升自身1%伤害，持续到战斗结束。 ")])]):t._e()])]):t._e()])])]),e("div",{staticClass:"cols",staticStyle:{float:"right",width:"320px","margin-right":"28px","margin-bottom":"10px"}},[e("h4",[t._v("限量祥瑞")]),e("div",{staticClass:"blank9"}),void 0==t.nosale_xiangrui?e("div",[e("p",{staticClass:"textCenter cDYellow"},[t._v("祥瑞信息未知")])]):e("div",{staticClass:"roleModuleScroller",staticStyle:{"max-height":"22em"}},[e("table",{staticClass:"tb02",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleXiangRui"}},[t.nosale_xiangrui.length<=0?e("tr",[e("td",{staticClass:"noData"},[t._v("无")])]):t._l(t.nosale_xiangrui,function(i){return e("tr",{key:i.name},[e("th",{class:{enhance:t.limitedSkinList.includes(i.name)}},[t._v(t._s(i.name))]),e("td",[t._v(" 技能： "),i.skill_name?e("span",[t._v(" "+t._s(i.skill_name)+" "),i.skill_level?e("span",[t._v(" "+t._s(i.skill_level))]):t._e()]):e("span",[t._v("无")])])])})],2)])]),e("div",{staticClass:"cols",staticStyle:{float:"right",clear:"right",width:"320px","margin-right":"28px"}},[e("h4",[t._v("普通祥瑞")]),e("div",{staticClass:"blank9"}),void 0==t.xiangrui?e("div",[e("p",{staticClass:"textCenter cDYellow"},[t._v("祥瑞信息未知")])]):e("div",{staticClass:"roleModuleScroller",staticStyle:{"max-height":"22em"}},[e("table",{staticClass:"tb02",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleXiangRui"}},[t.xiangrui.length<=0?e("tr",[e("td",{staticClass:"noData"},[t._v("无")])]):[e("tr",[e("th",[t._v("祥瑞总数")]),e("td",[t._v(t._s(t.normal_xiangrui_num?t.normal_xiangrui_num:t.totalXiangruiNum))])]),t._l(t.xiangrui,function(i){return e("tr",{key:i.name},[e("th",[t._v(t._s(i.name))]),e("td",[t._v(" 技能： "),i.skill_name?e("span",[t._v(" "+t._s(i.skill_name)+" "),i.skill_level?e("span",[t._v(" "+t._s(i.skill_level))]):t._e()]):e("span",[t._v("无")])])])})]],2)])])]),e("el-tab-pane",{attrs:{label:"锦衣/外观",name:"role_clothes"}},[e("div",{staticClass:"cols tab-jinyi",staticStyle:{width:"320px"}},[e("div",{staticClass:"module"},[e("h4",[t._v("彩果染色")]),e("div",{staticClass:"blank9"}),void 0!==t.basic_info.body_caiguo&&void 0!==t.basic_info.box_caiguo?e("table",{staticClass:"tb02",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("th",{attrs:{width:"55%"}},[t._v("身上染色折算彩果数：")]),e("td",[t._v(t._s(t.basic_info.body_caiguo))])]),e("tr",[e("th",[t._v("衣柜已保存染色方案：")]),e("td",[t._v(t._s(t.basic_info.box_caiguo))])]),e("tr",[e("td",{staticClass:"cGray",staticStyle:{"font-size":"12px","padding-left":"0px","padding-right":"0px"},attrs:{colspan:"2"}},[t._v(" （衣柜保存的染色方案包括花豆染色方案和彩果染色方案） ")])]),e("tr",[e("th",[t._v("所有染色折算彩果数：")]),e("td",[t._v(t._s(t.basic_info.total_caiguo))])])]):void 0!==t.basic_info.caiguo?e("p",{staticClass:"textCenter cDYellow"},[t._v(" 角色拥有折算彩果总量："+t._s(t.basic_info.caiguo)+" ")]):e("p",{staticClass:"textCenter cDYellow"},[t._v("彩果信息未知")])]),void 0!==t.new_clothes?e("div",t._l(t.titleConf,function(i,s){return e("div",{key:s,staticClass:"module module-jinyi"},[e("h4",[t._v(t._s(i.title))]),e("p",{staticClass:"jinyi-num"},[t._v(t._s(i.title)+"总数："+t._s(t.getClothesList(i.key).length))]),t.getClothesList(i.key)?e("ul",{staticClass:"jinyi-attr-list"},t._l(t.getClothesList(i.key),function(i,s){return e("li",{key:s,staticClass:"item"},[t._v(" "+t._s(i.name)+" ")])}),0):t._e()])}),0):t._e()]),e("div",{staticClass:"cols",staticStyle:{width:"320px","margin-left":"18px"}},[e("h4",[t._v("锦衣道具栏")]),e("div",{staticClass:"blank9"}),void 0===t.clothes&&void 0===t.new_clothes?e("p",{staticClass:"textCenter cDYellow"},[t._v(" 锦衣信息未知 ")]):void 0!==t.new_clothes?e("div",[e("ul",{staticClass:"xianyu-wrap"},[e("li",[e("i",{staticClass:"icon icon-xianyu"}),t._v("仙玉: "+t._s(t.basic_info.xianyu))]),e("li",[e("i",{staticClass:"icon icon-xianyu-jifen"}),t._v("仙玉积分: "+t._s(t.basic_info.xianyu_score)+" ")]),e("li",[e("i",{staticClass:"icon icon-qicai-jifen"}),t._v("七彩积分: "+t._s(t.basic_info.qicai_score))])]),e("div",{staticClass:"new-jinyi-list"},[e("p",{staticClass:"jinyi-num"},[t._v("锦衣总数："+t._s(t.basic_info.total_avatar))]),t._l(t.new_clothes,function(i,s){return e("div",{key:s,class:"module module-jinyi module-jinyi—"+s},[e("p",{staticClass:"jinyi-sub-title"},[t._v(t._s(i.title))]),i.list.length>0?e("ul",{staticClass:"jinyi-attr-list"},t._l(i.list,function(i,s){return e("li",{key:s,staticClass:"item",style:t.limitedSkinList.includes(i.name.split("·")[0])?"background:rgba(255, 102, 0, 0.5);color:rgb(0,255,0);":""},[t._v(" "+t._s(i.name)+" ")])}),0):e("p",{staticClass:"empty"},[t._v("无")])])})],2)]):e("div",[e("div",{staticClass:"roleModuleScroller",staticStyle:{"max-height":"22em"}},[e("table",{staticClass:"tb02",attrs:{cellspacing:"0",cellpadding:"0",id:"RoleClothesi"}},[t.clothes.length<=0?e("tr",[e("td",{staticClass:"noData"},[t._v("无")])]):[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v(" 锦衣总数 : "),e("span",{staticStyle:{color:"white"}},[t._v(t._s(t.getTotalAvatar()))])]),e("th",[t._v(" ")])]),t._l(t.clothesRows,function(i,s){return e("tr",{key:s},t._l(i,function(i,s){return e("th",{key:s,staticStyle:{"text-align":"left"}},[t._v(" "+t._s(i?i.name:"")+" ")])}),0)})]],2)])]),e("div",{staticClass:"blank9"})])]),e("el-tab-pane",{attrs:{label:"玩家之家",name:"role_home"}},[e("div",{staticClass:"cols tab-home",staticStyle:{width:"320px"}},[e("div",{staticClass:"module"},[e("h4",[t._v("房屋信息")]),e("div",{staticClass:"blank9"}),e("table",{staticClass:"tb02",attrs:{width:"92%",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("td",[e("strong",[t._v("婚否：")]),t._v(t._s(t.basic_info.is_married))]),e("td",[e("strong",[t._v("同袍：")]),t._v(t._s(t.basic_info.is_tongpao))])]),e("tr",[e("td",[e("strong",[t._v("居住房屋：")]),t._v(t._s(t.basic_info.fangwu_info))]),t.basic_info.fangwu_owner_info?e("td",[e("strong",[t._v("是否产权所有人：")]),t._v(t._s(t.basic_info.fangwu_owner_info))]):t._e()]),e("tr",[e("td",[e("strong",[t._v("庭院等级：")]),t._v(t._s(t.basic_info.tingyuan_info))]),e("td",[e("strong",[t._v("牧场：")]),t._v(t._s(t.basic_info.muchang_info))])]),e("tr",[e("td",[e("strong",[t._v("社区：")]),t._v(t._s(t.basic_info.community_info))])]),e("tr",[e("td",{attrs:{colspan:"3"}},[e("strong",[t._v("房契：")]),t._v(t._s(t.basic_info.house_fangqi))])])]),e("div",{staticClass:"module module-jinyi"},[e("h4",[t._v("窗景")]),e("p",{staticClass:"jinyi-num"},[t._v("窗景总数："+t._s(t.house.house_indoor_view_cnt))]),t.house.house_indoor_view&&t.house.house_indoor_view.length?e("ul",{staticClass:"jinyi-attr-list roleplay-attr-list"},t._l(t.house.house_indoor_view,function(i){return e("li",{key:i.name,staticClass:"item"},[t._v(t._s(i.name))])}),0):t._e()]),e("div",{staticClass:"module module-jinyi"},[e("h4",[t._v("庭院主题")]),e("p",{staticClass:"jinyi-num"},[t._v("庭院主题总数："+t._s(t.house.house_yard_map_cnt))]),t.house.house_yard_map&&t.house.house_yard_map.length?e("ul",{staticClass:"jinyi-attr-list roleplay-attr-list"},t._l(t.house.house_yard_map,function(i){return e("li",{key:i.name,staticClass:"item"},[t._v(t._s(i.name))])}),0):t._e()]),e("div",{staticClass:"module module-jinyi"},[e("h4",[t._v("庭院特效")]),e("p",{staticClass:"jinyi-num"},[t._v("庭院特效总数："+t._s(t.house.house_yard_animate_cnt))]),t.house.house_yard_animate&&t.house.house_yard_animate.length?e("ul",{staticClass:"jinyi-attr-list roleplay-attr-list"},t._l(t.house.house_yard_animate,function(i){return e("li",{key:i.name,staticClass:"item"},[t._v(t._s(i.name))])}),0):t._e()]),e("div",{staticClass:"module module-jinyi"},[e("h4",[t._v("庭院饰品")]),e("p",{staticClass:"jinyi-num"},[t._v("庭院饰品总数："+t._s(t.house.house_yard_fur_cnt))]),t.house.house_yard_fur&&t.house.house_yard_fur.length?e("ul",{staticClass:"jinyi-attr-list roleplay-attr-list"},t._l(t.house.house_yard_fur,function(i){return e("li",{key:i.name,staticClass:"item"},[t._v(t._s(i.name)+"*"+t._s(i.count))])}),0):t._e()])])]),e("div",{staticClass:"cols",staticStyle:{width:"320px","margin-left":"18px"}},[e("div",{staticClass:"module module-jinyi module-roleplay"},[e("h4",[t._v("建材")]),e("p",{staticClass:"jinyi-num"},[t._v("建材总数："+t._s(t.house.house_building_material_cnt))]),t.house.house_building_material&&t.house.house_building_material.length?e("ul",{staticClass:"jinyi-attr-list roleplay-attr-list"},t._l(t.house.house_building_material,function(i){return e("li",{key:i.name,staticClass:"item"},[e("span",[t._v(t._s(i.name))]),t._v("*"+t._s(i.count)+" ")])}),0):t._e()]),e("div",{staticClass:"module module-jinyi"},[e("h4",[t._v("家具")]),e("p",{staticClass:"jinyi-num"},[t._v("家具总数："+t._s(t.house.house_jiaju_num))]),t.house.house_jiaju&&t.house.house_jiaju.length?e("ul",{staticClass:"jinyi-attr-list roleplay-attr-list"},t._l(t.house.house_jiaju,function(i){return e("li",{key:i.name,staticClass:"item"},[e("span",[t._v(t._s(i.name))]),t._v("*"+t._s(i.count)+" ")])}),0):t._e()]),e("div",{staticClass:"blank9"})])])],1)],1):t._e()])},S=[],R=i(8883),L=i(9645);const D=5;var P={name:"RoleImage",components:{ItemPopover:R.A,PetDetail:L.A},mixins:[C.B],props:{size:{type:String,default:"small"},width:{type:String,default:"50px"},height:{type:String,default:"50px"},cursor:{type:String,default:"pointer"},placement:{type:String,default:"right"},popoverWidth:{type:String,default:"400px"},other_info:{type:String,default:""},roleInfo:{type:Object,required:!0}},data(){return{limitedSkinList:window.limitedSkinList||[],ResUrl:window.ResUrl,shenqi_visible:!1,visible:!1,activeName:"role_basic",basic_info:null,school_skill:null,life_skill:null,ju_qing_skill:null,shuliandu:null,left_skill_point:0,role_xiulian:[],pet_ctrl_skill:[],yu_shou_shu:void 0,currentDisplayIndex:0,not_using_equips:null,split_equips:null,shenqi:null,huoshenta:null,using_lingbao:null,nousing_lingbao:null,nousing_fabao:null,using_fabao:null,unused_fabao_sum:null,fabao_storage_size:null,shenqi_components:{},split_pets:[],pet_info:[],child_info:[],special_pet_info:[],sbook_skill:[],allow_pet_count:0,sbook_skill_total:0,current_pet:null,rider_info:[],current_rider_index:"0-0",rider_plan_list:[],current_rider_plan_index:0,xiangrui:[],nosale_xiangrui:[],normal_xiangrui_num:0,EquipLevel:159,clothes:null,new_clothes:null,house:null,titleConf:[{title:"称谓特效",key:"title_effect"},{title:"施法/攻击特效",key:"perform_effect"},{title:"冒泡框",key:"chat_effect"},{title:"头像框",key:"icon_effect"},{title:"彩饰-队标",key:"achieve_show"}]}},computed:{currentRider(){const[t,e]=this.current_rider_index.split("-").map(Number),i=this.rider_info[t*D+e];return i||{}},currentRiderPlan(){return this.rider_plan_list[this.current_rider_plan_index]||null},imageUrl(){const t=this.other_info?window.get_role_icon(this.other_info):"";return window.ResUrl+"/images/role_icon/small/"+t+".gif"},imageStyle(){return{display:"block",width:this.width,height:this.height,cursor:this.cursor}},extraAttrPoints(){const t=window.ServerTime?+window.ServerTime.split("-")[0]:(new Date).getFullYear();return 3*(t-2004+1)},school_skill1_icon(){return this.school_skill&&this.school_skill[0]?this.school_skill[0].skill_icon:""},school_skill1_name(){return this.school_skill&&this.school_skill[0]?this.school_skill[0].skill_name:""},school_skill1_grade(){return this.school_skill&&this.school_skill[0]?this.school_skill[0].skill_grade:""},school_skill1_desc(){return this.school_skill&&this.school_skill[0]?this.school_skill[0].desc:""},school_skill2_icon(){return this.school_skill&&this.school_skill[1]?this.school_skill[1].skill_icon:""},school_skill2_name(){return this.school_skill&&this.school_skill[1]?this.school_skill[1].skill_name:""},school_skill2_grade(){return this.school_skill&&this.school_skill[1]?this.school_skill[1].skill_grade:""},school_skill2_desc(){return this.school_skill&&this.school_skill[1]?this.school_skill[1].desc:""},school_skill3_icon(){return this.school_skill&&this.school_skill[2]?this.school_skill[2].skill_icon:""},school_skill3_name(){return this.school_skill&&this.school_skill[2]?this.school_skill[2].skill_name:""},school_skill3_grade(){return this.school_skill&&this.school_skill[2]?this.school_skill[2].skill_grade:""},school_skill3_desc(){return this.school_skill&&this.school_skill[2]?this.school_skill[2].desc:""},school_skill4_icon(){return this.school_skill&&this.school_skill[3]?this.school_skill[3].skill_icon:""},school_skill4_name(){return this.school_skill&&this.school_skill[3]?this.school_skill[3].skill_name:""},school_skill4_grade(){return this.school_skill&&this.school_skill[3]?this.school_skill[3].skill_grade:""},school_skill4_desc(){return this.school_skill&&this.school_skill[3]?this.school_skill[3].desc:""},school_skill5_icon(){return this.school_skill&&this.school_skill[4]?this.school_skill[4].skill_icon:""},school_skill5_name(){return this.school_skill&&this.school_skill[4]?this.school_skill[4].skill_name:""},school_skill5_grade(){return this.school_skill&&this.school_skill[4]?this.school_skill[4].skill_grade:""},school_skill5_desc(){return this.school_skill&&this.school_skill[4]?this.school_skill[4].desc:""},school_skill6_icon(){return this.school_skill&&this.school_skill[5]?this.school_skill[5].skill_icon:""},school_skill6_name(){return this.school_skill&&this.school_skill[5]?this.school_skill[5].skill_name:""},school_skill6_grade(){return this.school_skill&&this.school_skill[5]?this.school_skill[5].skill_grade:""},school_skill6_desc(){return this.school_skill&&this.school_skill[5]?this.school_skill[5].desc:""},school_skill7_icon(){return this.school_skill&&this.school_skill[6]?this.school_skill[6].skill_icon:""},school_skill7_name(){return this.school_skill&&this.school_skill[6]?this.school_skill[6].skill_name:""},school_skill7_grade(){return this.school_skill&&this.school_skill[6]?this.school_skill[6].skill_grade:""},school_skill7_desc(){return this.school_skill&&this.school_skill[6]?this.school_skill[6].desc:""},storeEquipsRows(){const t=5,e=this.not_using_equips||[],i=e.length;let s=parseInt(i/t)+(i%t?1:0);s=s<4?4:s;const a=[];for(let l=0;l<s;l++){const i=e.slice(l*t,(l+1)*t);a.push(i)}return a},splitEquipsRows(){if(!this.split_equips||0===this.split_equips.length)return[];const t=5,e=[];for(let i=0;i<this.split_equips.length;i+=t)e.push(this.split_equips.slice(i,i+t));return e},nousingLingbaoRows(){const t=5,e=this.nousing_lingbao||[],i=Math.max(1,Math.ceil(e.length/t)),s=[];for(let a=0;a<i;a++){const i=[];for(let s=0;s<t;s++){const l=a*t+s;i.push(e[l]||null)}s.push(i)}return s},storeFabaoRows(){if(!this.nousing_fabao||0===this.nousing_fabao.length)return[];const t=5,e=[];for(let i=0;i<this.nousing_fabao.length;i+=t)e.push(this.nousing_fabao.slice(i,i+t));while(e.length<4)e.push([]);return e},splitPetsRows(){const t=3,e=this.split_pets||[],i=e.length,s=0===i?1:parseInt(i/t)+(i%t?1:0),a=[];for(let l=0;l<s;l++){const i=e.slice(l*t,(l+1)*t);a.push(i)}return a},petInfoRows(){const t=3,e=this.pet_info||[],i=e.length,s=0===i?1:parseInt(i/t)+(i%t?1:0),a=[];for(let l=0;l<s;l++){const i=e.slice(l*t,(l+1)*t);a.push(i)}return a},childListRows(){const t=2,e=this.child_info||[],i=e.length,s=0===i?1:parseInt(i/t)+(i%t?1:0),a=[];for(let l=0;l<s;l++){const i=e.slice(l*t,(l+1)*t);a.push(i)}return a},riderRows(){const t=D,e=this.rider_info||[],i=e.length,s=parseInt(i/t)+(i%t?1:0),a=[];for(let l=0;l<s;l++){const i=e.slice(l*t,(l+1)*t);a.push(i)}return a},totalXiangruiNum(){const t=this.nosale_xiangrui?this.nosale_xiangrui.length:0,e=this.basic_info?this.basic_info.total_horse:0;if(!e&&this.xiangrui){const t=this.xiangrui.length;return t>=10?"大于等于10":t}return e-t},riderSkillRows(){if(!this.currentRider||!this.currentRider.all_skills)return[];const t=6,e=this.currentRider.all_skills,i=e.length;let s=parseInt(i/t)+(i%t?1:0);0===s&&(s=1);const a=[];for(let l=0;l<s;l++){const i=e.slice(l*t,(l+1)*t);a.push(i)}return a},clothesRows(){const t=2,e=[];for(let i=0;i<this.clothes.length;i+=t){const s=this.clothes.slice(i,i+t);while(s.length<t)s.push(null);e.push(s)}return e}},watch:{visible:{handler(t){t&&this.getLimitedSkinConfig()},immediate:!0}},mounted(){this.roleInfo.basic_info&&(this.basic_info=this.roleInfo.basic_info||{},this.role_xiulian=this.roleInfo.role_xiulian||[],this.pet_ctrl_skill=this.roleInfo.pet_ctrl_skill||[],this.yu_shou_shu=this.roleInfo.role_skill.yu_shou_shu,this.school_skill=this.roleInfo.role_skill.school_skill,this.life_skill=this.roleInfo.role_skill.life_skill,this.ju_qing_skill=this.roleInfo.role_skill.ju_qing_skill,this.shuliandu=this.roleInfo.role_skill.shuliandu,this.left_skill_point=this.roleInfo.left_skill_point||0,this.using_equips=this.roleInfo.using_equips||[],this.not_using_equips=this.roleInfo.not_using_equips||[],this.split_equips=this.roleInfo.split_equips||[],this.shenqi=this.roleInfo.shenqi||null,this.huoshenta=this.roleInfo.huoshenta||null,this.shenqi_components=this.roleInfo.shenqi_components||{},this.using_lingbao=this.roleInfo.using_lingbao||[],this.nousing_lingbao=this.roleInfo.nousing_lingbao||[],this.nousing_fabao=this.roleInfo.nousing_fabao||[],this.using_fabao=this.roleInfo.using_fabao||[],this.unused_fabao_sum=this.roleInfo.unused_fabao_sum,this.fabao_storage_size=this.roleInfo.fabao_storage_size,this.split_pets=this.roleInfo.split_pets||[],this.pet_info=this.roleInfo.pet_info||[],this.pet_info.length>0?this.current_pet=this.pet_info[0]:this.split_pets.length>0?this.current_pet=this.split_pets[0]:this.child_info.length>0&&(this.current_pet=this.child_info[0]),this.child_info=this.roleInfo.child_info||[],this.special_pet_info=this.roleInfo.special_pet_info||[],this.sbook_skill=this.roleInfo.sbook_skill||[],this.allow_pet_count=this.roleInfo.allow_pet_count||0,this.sbook_skill_total=this.roleInfo.sbook_skill_total||0,this.rider_info=this.roleInfo.rider_info||[],this.rider_plan_list=this.roleInfo.rider_plan_list||[],this.xiangrui=this.roleInfo.xiangrui||[],this.nosale_xiangrui=this.roleInfo.nosale_xiangrui||[],this.normal_xiangrui_num=this.roleInfo.normal_xiangrui_num||0,this.rider_info.length>0&&(this.current_rider_index="0-0"),this.rider_plan_list.length>0&&(this.current_rider_plan_index=0),this.EquipLevel=this.basic_info.role_level,this.clothes=this.roleInfo.clothes||null,this.new_clothes=this.roleInfo.new_clothes||null,this.house=this.roleInfo.house||{})},methods:{async getLimitedSkinConfig(){if(!window.limitedSkinList){const t=await this.$api.system.getLimitedSkinConfig(),e=[];for(const i in t)for(const s in t[i])e.push(s);window.limitedSkinList=e}this.limitedSkinList=window.limitedSkinList},getPetRightLock(t){return t.lock_type?.filter(t=>9!==t&&"protect"!==t&&"huoyue"!==t)},getPetLeftLock(t){return t.lock_type?.filter(t=>9===t||"protect"===t||"huoyue"===t)},onPetAvatarClick(t){this.current_pet=t},get_using_equip(t){const e="number"===typeof t?this.using_equips.find(({pos:e})=>e===t):t;if(e)return{equip_sn:e.equip_sn,equip_face_img:e.small_icon,equip_name:e.name,equip_type_desc:e.static_desc,large_equip_desc:e.desc,lock_type:e.lock_type,src:e.small_icon,data_equip_name:e.name,data_equip_type:e.type,data_equip_desc:e.desc,data_equip_type_desc:e.static_desc}},get_using_fabao(t){const e="number"===typeof t?this.using_fabao.find(({pos:e})=>e===t):t;if(e)return{equip_sn:e.type,equip_face_img:e.icon,equip_name:e.name,equip_type_desc:e.static_desc,large_equip_desc:e.desc,icon:e.icon,data_equip_name:e.name,data_equip_type:e.type,data_equip_desc:e.desc,data_equip_type_desc:e.static_desc}},htmlEncode(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""},toggle_display(t){this.currentDisplayIndex=t},skillRows(t,e){if(!t||0===t.length)return[];const i=[];for(let s=0;s<t.length;s+=e)i.push(t.slice(s,s+e));return i},switchShenqiTab(t){const e="shenqi"+(t+1),i=this.shenqi_components[e];i&&(Object.keys(this.shenqi_components).forEach(t=>{this.shenqi_components[t]&&(this.shenqi_components[t].actived=!1)}),this.shenqi_components[e].actived=!0)},getClothesList(t){return this[t]||[]},getTotalAvatar(){return this.basic_info.total_avatar?this.basic_info.total_avatar:this.clothes.length<20?this.clothes.length:"大于等于20"}}},I=P,T=(0,v.A)(I,q,S,!1,null,"ce614f1a",null),$=T.exports,F={name:"SimilarRoleTable",components:{RoleImage:$},mixins:[C.B],props:{anchors:{type:Array,required:!0}},methods:{getServerHeatLabel(t){const e=window.hotServersConfig?.find(e=>e.children.find(e=>e.server_id===t));return e?.server_name||""},getSimilarityTagType(t){return t>=.9?"success":t>=.7?"primary":t>=.5?"info":t>=.3?"warning":"danger"}}},V=F,j=(0,v.A)(V,w,x,!1,null,"1beaf4f1",null),z=j.exports,N={name:"SimilarRoleModal",components:{SimilarRoleTable:z,RoleImage:$},mixins:[C.B],props:{role:{type:Object,required:!0},placement:{type:String,default:"left-end"},searchParams:{type:Object,default:()=>({selectedDate:"2025-01",roleType:"empty"})}},data(){return{visible:!1,valuationLoading:!1,anchorsLoading:!1,error:!1,similarData:null,hotServersConfig:window.hotServersConfig||[]}},computed:{loading(){return this.valuationLoading||this.anchorsLoading},confidenceClass(){if(!this.similarData?.valuation?.confidence)return"confidence-extremely-low";const t=this.similarData.valuation.confidence;return t>=.8?"confidence-high":t>=.6?"confidence-medium":t>=.4?"confidence-low":t>=.2?"confidence-very-low":"confidence-extremely-low"},confidenceTextClass(){if(!this.similarData?.valuation?.confidence)return"text-danger";const t=this.similarData.valuation.confidence;return t>=.8?"text-success":t>=.6?"text-primary":t>=.4?"text-info":t>=.2?"text-warning":"text-danger"},confidenceIcon(){if(!this.similarData?.valuation?.confidence)return"el-icon-warning";const t=this.similarData.valuation.confidence;return t>=.8?"el-icon-success":t>=.6?"el-icon-info":t>=.4?"el-icon-question":t>=.2?"el-icon-warning":"el-icon-error"},confidenceLevel(){if(!this.similarData?.valuation?.confidence)return"(数据缺失)";const t=this.similarData.valuation.confidence;return t>=.8?"(高)":t>=.6?"(中)":t>=.4?"(偏低)":t>=.2?"(很低)":"(极低)"}},watch:{visible:{handler(t){t&&this.loadHotServers()},immediate:!0}},methods:{getServerHeatLabel(t){const e=this.hotServersConfig.find(e=>e.children.find(e=>e.server_id===t));return e?.server_name||""},async loadHotServers(){window.hotServersConfig||(window.hotServersConfig=await this.$api.system.getHotServers()),this.hotServersConfig=window.hotServersConfig},async handleShow(){this.$emit("show",this.role),await this.loadSimilarRoles()},async refresh(){await this.loadSimilarRoles()},async loadSimilarRoles(){this.error=!1,this.similarData=null;try{await this.loadRoleValuation()}catch(t){console.error("加载相似角色失败:",t),this.error=!0}},async loadRoleValuation(){try{this.valuationLoading=!0;const e=await this.$api.role.getRoleValuation({eid:this.role.eid,role_type:this.searchParams.roleType,strategy:"fair_value",similarity_threshold:.7,max_anchors:30}),i=e.data,s=i.anchors,a=i.estimated_price_yuan;if(this.$emit("update-role-price",{eid:this.role.eid,basePrice:i.estimated_price}),this.similarData={anchor_count:i.anchor_count,similarity_threshold:i.similarity_threshold||.7,max_anchors:i.max_anchors||30,anchors:[],statistics:{price_range:i.anchor_count?{min:Math.min(...s.map(t=>t.price||0)),max:Math.max(...s.map(t=>t.price||0)),avg:s.reduce((t,e)=>t+(e.price||0),0)/s.length}:{min:0,max:0,avg:0},similarity_range:i.anchor_count?{min:Math.min(...s.map(t=>t.similarity||0)),max:Math.max(...s.map(t=>t.similarity||0)),avg:s.reduce((t,e)=>t+(e.similarity||0),0)/s.length}:{min:0,max:0,avg:0}},valuation:{estimated_price_yuan:a,confidence:i.confidence,strategy:i.strategy||"fair_value"}},this.valuationLoading=!1,i?.anchor_count>0&&i?.anchors?.length>0){this.anchorsLoading=!0;try{const t=await this.$api.role.getRoleApi({page_size:99,eid_list:s.map(t=>t.eid),role_type:"empty"});if(this.anchorsLoading=!1,200===t.code&&t.data?.data){const e=t.data.data,i=e.map((t,e)=>{const i=new window.RoleInfoParser(t.large_equip_desc,{equip_level:t.equip_level});return t.RoleInfoParser=i,i.result&&(t.roleInfo=i.result),t.similarity=s[e].similarity,t.features=s[e].features,t});this.$set(this.similarData,"anchors",i)}else console.warn("未获取到相似角色锚点数据:",t.message)}catch(t){console.error("查询相似角色锚点失败:",t)}}}catch(t){throw console.error("角色估价失败:",t),this.$notify.error({title:"估价请求失败",message:"网络请求异常，请稍后重试",duration:3e3}),t}finally{this.valuationLoading=!1,this.anchorsLoading=!1}},getStrategyName(t){const e={fair_value:"公允价值",competitive:"竞争价格",premium:"溢价估值"};return e[t]||t||"-"}}},E=N,M=(0,v.A)(E,b,k,!1,null,"4a8cedb4",null),B=M.exports,O={name:"RoleList",mixins:[C.B],components:{RoleImage:$,EquipBatchValuationResult:n.A,PetBatchValuationResult:y,SimilarRoleModal:B},computed:{roleType(){return this.$route.params.type||"normal"}},watch:{roleType(){this.currentPage=1;const t={type:this.roleType,levelRange:this.$route.params.levelRange};this.$router.replace({name:"RoleList",params:t}),this.fetchData()},"$route.params.levelRange":{handler(t){if(t){const[e,i]=t.split(",").map(Number);isNaN(e)||isNaN(i)||(this.searchForm.level_min=e,this.searchForm.level_max=i)}else this.searchForm.level_min=void 0,this.searchForm.level_max=void 0},immediate:!0},"$route.params.page":{handler(t){if(t){const e=parseInt(t);!isNaN(e)&&e>0?this.currentPage=e:this.currentPage=1}else this.currentPage=1},immediate:!0},"$route.query":{handler(t){if(t.selectedDate&&(this.searchForm.selectedDate=t.selectedDate),void 0!==t.equip_num&&(this.searchForm.equip_num=t.equip_num?parseInt(t.equip_num):void 0),void 0!==t.pet_num&&(this.searchForm.pet_num=t.pet_num?parseInt(t.pet_num):void 0),void 0!==t.pet_num_level&&(this.searchForm.pet_num_level=t.pet_num_level?parseInt(t.pet_num_level):void 0),void 0!==t.accept_bargain&&(this.searchForm.accept_bargain=t.accept_bargain),t.sort_by&&t.sort_order){const e=t.sort_by.split(","),i=t.sort_order.split(",");this.sortState={},e.forEach((t,e)=>{const s=i[e];"ASC"===s?this.sortState[t]="ascending":"DESC"===s&&(this.sortState[t]="descending")}),this.$set(this.searchForm,"sort_by",t.sort_by),this.$set(this.searchForm,"sort_order",t.sort_order)}else this.sortState={},this.$set(this.searchForm,"sort_by",void 0),this.$set(this.searchForm,"sort_order",void 0)},immediate:!0}},data(){return{valuationDialogTitle:{nickname:"",school:"",server_name:"",eid:""},stickyRoleList:[],checkedList:[],valuationLoading:!1,batchValuateParams:{similarity_threshold:.8,max_anchors:30,serverid:void 0,server_name:void 0},valuationResults:[],valuationTotalValue:0,valuationEquipmentList:[],valuationDialogVisible:!1,petValuationResults:[],petValuationTotalValue:0,petValuationList:[],petValuationDialogVisible:!1,petValuationLoading:!1,petValuationDialogTitle:{nickname:"",school:"",server_name:"",eid:""},loadingStates:{},loading:!1,tableData:[],currentPage:1,pageSize:10,total:0,searchForm:{selectedDate:o()().format("YYYY-MM"),level_min:void 0,level_max:void 0,equip_num:void 0,pet_num:void 0,pet_num_level:void 0,sort_by:void 0,sort_order:void 0,accept_bargain:void 0},activeCollapse:[],sortState:{price:null,level:null,create_time:null}}},mounted(){const t=this.$refs.roleTable.$refs.tableHeader.getHeaderCellClass;this.$refs.roleTable.$refs.tableHeader.getHeaderCellClass=(e,i,s,a)=>{let l=t(e,i,s,a);return this.sortState[a.property]&&(l+=" "+this.sortState[a.property]),l},this.loadStickyRoleList(),this.fetchData()},beforeDestroy(){this.saveStickyRoleList()},methods:{formatFullPriceWithoutPerfix(t){return this.formatFullPrice(t,!0).replace("￥","").replace("-","???")},hasRouteChanges(t,e=null){const i=JSON.stringify(t)!==JSON.stringify(this.$route.params);if(e){const t=JSON.stringify(e)!==JSON.stringify(this.$route.query);return i||t}return i},safeRouteUpdate(t,e=null){this.hasRouteChanges(t,e)&&this.$router.replace({name:this.$route.name,params:t,query:e||this.$route.query})},get_price_change({price:t,history_price:e}){const i=JSON.parse(e).map(t=>t.price);if(0===i.length)return;const s=Math.max(...i);return(t-s)/100},saveStickyRoleList(){try{const t=this.stickyRoleList.map(t=>{const e=JSON.parse(JSON.stringify(t));return e.timestamp=Date.now(),e});localStorage.setItem("cbg_sticky_role_list",JSON.stringify(t)),console.log("锁定角色列表已全量保存到localStorage:",t.length)}catch(t){console.error("保存锁定角色列表失败:",t)}},loadStickyRoleList(){try{const t=localStorage.getItem("cbg_sticky_role_list");if(t){const e=JSON.parse(t),i=e.map(t=>({...t,is_sticky:!0}));this.stickyRoleList=i,this.checkedList=i.map(t=>t.eid),console.log("从localStorage加载锁定角色列表:",i.length)}}catch(t){console.error("加载锁定角色列表失败:",t),localStorage.removeItem("cbg_sticky_role_list"),this.stickyRoleList=[],this.checkedList=[]}},handleSingleCheckboxChange(t,e){const i=e.target.value||e.target.labels[0].textContent;if(t){const t=this.tableData.find(t=>t.eid===i);if(t){const e=this.stickyRoleList.find(t=>t.eid===i);e||(t.is_sticky=!0,this.stickyRoleList.push(t),this.saveStickyRoleList(),this.$notify.success({title:"锁定成功",message:`已锁定角色: ${t.seller_nickname}`,duration:2e3}))}}else{this.stickyRoleList=this.stickyRoleList.filter(t=>t.eid!==i),this.saveStickyRoleList();const t=this.tableData.find(t=>t.eid===i);t&&this.$notify.info({title:"解锁成功",message:`已解锁角色: ${t.seller_nickname}`,duration:2e3})}},clearAllStickyRoles(){this.$confirm("确定要解锁所有锁定的角色吗？","确认解锁",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.stickyRoleList=[],this.checkedList=[],localStorage.removeItem("cbg_sticky_role_list"),this.$notify.success({title:"批量解锁成功",message:"已解锁所有锁定的角色",duration:2e3})}).catch(()=>{})},getLevelEffect(t){const[e,i]=this.$route.params.levelRange.split(",").map(Number);return t>=e&&t<=i?"dark":"light"},async changeRoleType(t){try{await this.$confirm(`确定要转移角色 ${t.seller_nickname} 吗？`,"确认转移",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await this.$api.role.switchRoleType(t.eid,{role_type:this.roleType,target_role_type:"empty"===this.roleType?"normal":"empty"});200===e.code?(this.$notify.success({title:"成功",message:"角色转移成功"}),await this.fetchData()):this.$notify.error({title:"错误",message:e.message||"转移失败"})}catch(e){"cancel"!==e&&(console.error("转移角色失败:",e),this.$notify.error({title:"错误",message:"转移角色失败"}))}},async handleDelete(t){try{await this.$confirm(`确定要删除角色 ${t.seller_nickname} 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await this.$api.role.deleteRole(t.eid,{role_type:this.roleType});200===e.code?(this.$notify.success({title:"成功",message:"角色删除成功"}),await this.fetchData()):this.$notify.error({title:"错误",message:e.message||"删除失败"})}catch(e){"cancel"!==e&&(console.error("删除角色失败:",e),this.$notify.error({title:"错误",message:"删除角色失败"}))}},closeValuationDialog(){this.valuationDialogVisible=!1,this.valuationResults=[],this.valuationTotalValue=0,this.valuationEquipmentList=[],this.valuationLoading=!1,this.valuationDialogTitle={nickname:"",school:"",server_name:"",eid:""}},closePetValuationDialog(){this.petValuationDialogVisible=!1,this.petValuationResults=[],this.petValuationTotalValue=0,this.petValuationList=[],this.petValuationLoading=!1,this.petValuationDialogTitle={nickname:"",school:"",server_name:"",eid:""}},handleRolePriceUpdate({eid:t,basePrice:e}){const i=this.tableData.find(e=>e.eid===t);i&&this.$set(i,"base_price",e)},async handlSummonePrice(t,e){const i=[...t.roleInfo.pet_info,...t.roleInfo.split_pets];let s=JSON.parse(t.all_summon_json);if(console.log("pet_list",s),s&&0!==s.length){s=s.map(e=>{const s=window.CBG_GAME_CONFIG.pet_equip_type_to_grade_mapping[e.iType],a=[];for(var l in e.all_skills)a.push(""+l);const o=this.calculateEvolSkillList(e),n=JSON.stringify(e.jinjie?.core),r=e.jinjie?.lx||0,c=[];for(var _=0;_<3;_++){var u=e["summon_equip"+(_+1)],h=window.CBG_GAME_CONFIG.equip_info[u?.iType]||{};u?c.push({type:u.iType,desc:u.cDesc,name:h.name,icon:window.ResUrl+`/images/equip/small/${u?.iType}.gif`,static_desc:h.desc?.replace(/#R/g,"<br />")}):c.push(null)}const d=[];if(void 0!=e.summon_core)for(var p in e.summon_core){var g=e.summon_core[p];d.push({name:window.CBG_GAME_CONFIG.pet_neidans[p]||"",level:g[0],isNeiDan:!0})}const m=i.find(t=>t.equip_sn===e.equip_sn);return{pet_detail:m,equip_sn:e.equip_sn,role_grade_limit:s,equip_level:e.iGrade,growth:e.grow/1e3,is_baobao:1==e.iBaobao?"是":"否",all_skill:a.join("|"),evol_skill_list:JSON.stringify(o),sp_skill:m.genius,texing:n,lx:r,equip_list:JSON.stringify(c),neidan:JSON.stringify(d),serverid:t.serverid,server_name:t.server_name}}),this.petValuationDialogTitle={nickname:t.roleInfo.basic_info.nickname,school:t.roleInfo.basic_info.school,server_name:t.server_name,eid:t.eid};try{this.petValuationDialogVisible=!0,this.petValuationLoading=!0,this.petValuationResults=[],this.petValuationTotalValue=0,this.petValuationList=s;const i=await this.$api.pet.batchPetValuation({eid:t.eid,pet_list:s.map(({pet_detail:t,...e})=>e),strategy:"fair_value",similarity_threshold:this.batchValuateParams.similarity_threshold,max_anchors:this.batchValuateParams.max_anchors});if(200===i.code){const t=i.data,s=t.results||[],a=s.reduce((t,e)=>t+(e.estimated_price||0)+(e.equip_estimated_price||0),0);this.$set(this.tableData[e],"pet_price",t.pet_price),this.petValuationResults=s,this.petValuationTotalValue=a,this.petValuationLoading=!1}else this.$notify.error({title:"错误",message:i.message||"宠物估价失败"}),this.closePetValuationDialog()}catch(a){console.error("宠物估价失败:",a),this.$notify.error({title:"错误",message:"宠物估价失败"}),this.closePetValuationDialog()}finally{this.petValuationLoading=!1}}else this.$notify.warning({title:"提示",message:"没有可估价的宠物"})},calculateEvolSkillList(t){const e=[];if(!t.EvolSkill||!window.CBG_GAME_CONFIG.pet_skill_high_to_other_level_mapping)return e;const i=t.EvolSkill.split("|").map(Number),s={};i.forEach(function(t){s[t]=1});const a=s;if(!a)return e;const l=[];for(const o in a)l.push(""+o);for(let o=0,n=l.length;o<n;o++){const i=l[o],s=window.CBG_GAME_CONFIG.pet_skill_high_to_other_level_mapping[i];if(!s)continue;const n={skill_type:i,level:a[i],evol_type:i};if(t.all_skills){const e=t.all_skills[String(s.high_skill)],i=t.all_skills[String(s.low_skill)];e||i?(n.hlightLight=!0,e||(n.evol_type=s.low_skill)):n.hlightLight=!1}e.push(n)}return e},get_pet_num(t){return t?.pet_info?.length+t?.split_pets?.length},get_equip_num(t){return t?.using_equips?.length+t?.not_using_equips?.length+t?.split_equips?.length},async handleEquipPrice({roleInfo:{using_equips:t,not_using_equips:e,split_equips:i,basic_info:s},serverid:a,server_name:l,eid:o},n){console.log({rowIndex:n});const r=[...t,...e,...i].map(t=>({...t,iType:t.type,cDesc:t.desc,serverid:a,server_name:l}));this.valuationDialogTitle={nickname:s.nickname,school:s.school,server_name:l,eid:o};try{this.valuationDialogVisible=!0,this.valuationLoading=!0,this.valuationResults=[],this.valuationTotalValue=0,this.valuationEquipmentList=r;const t=await this.$api.equipment.batchEquipmentValuation({eid:o,equipment_list:r,strategy:"fair_value",similarity_threshold:this.batchValuateParams.similarity_threshold,max_anchors:this.batchValuateParams.max_anchors});if(200===t.code){const e=t.data,i=e.results||[],s=i.reduce((t,e)=>t+(e.estimated_price||0),0);this.$set(this.tableData[n],"equip_price",e.equip_price),this.valuationResults=i,this.valuationTotalValue=s,this.valuationLoading=!1}else this.$notify.error({title:"错误",message:t.message||"装备估价失败"}),this.closeValuationDialog()}catch(c){console.error("装备估价失败:",c),this.$notify.error({title:"错误",message:"装备估价失败"}),this.closeValuationDialog()}finally{this.valuationLoading=!1}},get_school_name:window.get_school_name,handleSortChange({prop:t,order:e}){this.sortState[t]=e;const i=[],s=[];for(const[n,r]of Object.entries(this.sortState))r&&(i.push(n),s.push("ascending"===r?"ASC":"DESC"));this.$set(this.searchForm,"sort_by",i.join(",")),this.$set(this.searchForm,"sort_order",s.join(","));const a={...this.$route.query},l=this.$route.query.sort_by,o=this.$route.query.sort_order;i.length>0?(a.sort_by=i.join(","),a.sort_order=s.join(",")):(delete a.sort_by,delete a.sort_order),a.sort_by===l&&a.sort_order===o||(this.$router.replace({name:this.$route.name,params:this.$route.params,query:a}),this.handleSearch())},async fetchData(){this.loading=!0;try{const t={page:this.currentPage,page_size:this.pageSize,role_type:this.roleType};this.searchForm.level_min&&(t.level_min=this.searchForm.level_min),this.searchForm.level_max&&(t.level_max=this.searchForm.level_max),void 0!==this.searchForm.equip_num&&(t.equip_num=this.searchForm.equip_num),this.searchForm.pet_num&&(t.pet_num=this.searchForm.pet_num),this.searchForm.pet_num_level&&(t.pet_num_level=this.searchForm.pet_num_level),this.searchForm.accept_bargain&&(t.accept_bargain=this.searchForm.accept_bargain),this.searchForm.sort_by&&(t.sort_by=this.searchForm.sort_by),this.searchForm.sort_order&&(t.sort_order=this.searchForm.sort_order);const e=await this.$api.role.getRoleApi(t);200===e.code?(this.tableData=e.data.data.map(t=>{const e=t.large_equip_desc?new window.RoleInfoParser(t.large_equip_desc,{equip_level:t.equip_level}):"";return t.RoleInfoParser=e,e.result?t.roleInfo=e.result:t.roleInfo={},t.is_sticky=this.stickyRoleList.some(e=>e.eid===t.eid),t})||[],this.total=e.data.total||0):this.$notify.error({title:"错误",message:e.message||"获取数据失败"})}catch(t){console.error("获取数据失败:",t),this.$notify.error({title:"错误",message:"获取数据失败"})}finally{this.loading=!1}},handleSizeChange(t){this.pageSize=t,this.currentPage=1;const e={type:this.roleType,levelRange:this.$route.params.levelRange};this.safeRouteUpdate(e),this.fetchData()},handleCurrentChange(t){this.currentPage=t;const e={type:this.roleType,levelRange:this.$route.params.levelRange};t>1&&(e.page=t.toString()),this.safeRouteUpdate(e),this.fetchData()},handleDateChange(){this.currentPage=1;const t={type:this.roleType,levelRange:this.$route.params.levelRange};this.safeRouteUpdate(t),this.fetchData()},handleQuickLevelSelect(t){this.searchForm.level_min=t,this.searchForm.level_max=t;const e=this.$route.params.levelRange,i=`${t},${t}`;e!==i&&this.$router.replace({name:"RoleList",params:{type:this.roleType,levelRange:i,page:1},query:this.$route.query}),this.fetchData()},handleLevelChange(){const t=this.searchForm.level_min&&this.searchForm.level_max?`${this.searchForm.level_min},${this.searchForm.level_max}`:void 0,e=this.$route.params.levelRange;t!==e&&this.$router.replace({name:"RoleList",params:{type:this.roleType,levelRange:t},query:this.$route.query})},handleSearch(){const t=this.searchForm.level_min&&this.searchForm.level_max?`${this.searchForm.level_min},${this.searchForm.level_max}`:void 0,e={...this.$route.query};this.searchForm.selectedDate?e.selectedDate=this.searchForm.selectedDate:delete e.selectedDate,void 0!==this.searchForm.equip_num&&""!==this.searchForm.equip_num?e.equip_num=this.searchForm.equip_num.toString():delete e.equip_num,void 0!==this.searchForm.pet_num&&""!==this.searchForm.pet_num?e.pet_num=this.searchForm.pet_num.toString():delete e.pet_num,void 0!==this.searchForm.pet_num_level&&""!==this.searchForm.pet_num_level?e.pet_num_level=this.searchForm.pet_num_level.toString():delete e.pet_num_level,void 0!==this.searchForm.accept_bargain&&""!==this.searchForm.accept_bargain?e.accept_bargain=this.searchForm.accept_bargain:delete e.accept_bargain;const i={type:this.roleType,levelRange:t};this.currentPage>1&&(i.page=this.currentPage.toString());const s=JSON.stringify(i)!==JSON.stringify(this.$route.params),a=JSON.stringify(e)!==JSON.stringify(this.$route.query);(s||a)&&this.$router.replace({name:"RoleList",params:i,query:e}),this.fetchData()},handleReset(){this.searchForm={selectedDate:o()().format("YYYY-MM"),level_min:void 0,level_max:void 0,equip_num:void 0,pet_num:void 0,pet_num_level:void 0,sort_by:void 0,sort_order:void 0,accept_bargain:void 0},this.sortState={},this.currentPage=1;const t={type:this.roleType,levelRange:void 0},e={...this.$route.query};delete e.selectedDate,delete e.equip_num,delete e.pet_num,delete e.pet_num_level,delete e.accept_bargain,delete e.sort_by,delete e.sort_order;const i=JSON.stringify(t)!==JSON.stringify(this.$route.params),s=JSON.stringify(e)!==JSON.stringify(this.$route.query);(i||s)&&this.$router.replace({name:"RoleList",params:t,query:e}),this.fetchData()},handleRoleTypeChange(){this.currentPage=1;const t={type:this.roleType,levelRange:this.$route.params.levelRange};this.safeRouteUpdate(t),this.fetchData()},extractServerId(t){const e=t.split("-");return e[1]||null}}},A=O,G=(0,v.A)(A,s,a,!1,null,"cc7e25e0",null),J=G.exports}}]);
//# sourceMappingURL=985.7de9d719.js.map