{"version":3,"file":"js/296.c32d8263.js","mappings":"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","sources":["webpack://web/./src/components/SimilarGetMore.vue","webpack://web/src/components/SimilarGetMore.vue","webpack://web/./src/components/SimilarGetMore.vue?d53d","webpack://web/./src/components/SimilarGetMore.vue?c050","webpack://web/./src/components/SimilarEquipmentModal.vue","webpack://web/./src/components/EquipmentValuation.vue","webpack://web/src/components/EquipmentValuation.vue","webpack://web/./src/components/EquipmentValuation.vue?2d7c","webpack://web/./src/components/EquipmentValuation.vue?4ad3","webpack://web/./src/components/SimilarEquipmentTable.vue","webpack://web/src/components/SimilarEquipmentTable.vue","webpack://web/./src/components/SimilarEquipmentTable.vue?2461","webpack://web/./src/components/SimilarEquipmentTable.vue?323d","webpack://web/src/components/SimilarEquipmentModal.vue","webpack://web/./src/components/SimilarEquipmentModal.vue?2056","webpack://web/./src/components/SimilarEquipmentModal.vue?193d"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-button',{attrs:{\"type\":\"success\"},on:{\"click\":_vm.goToMoreSimilar}},[_vm._v(\" 查看更多相似 \")])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-button type=\"success\" @click=\"goToMoreSimilar\">\n    查看更多相似\n  </el-button>\n</template>\n\n<script>\nimport qs from 'qs'\nimport windowReuseManager from '@/utils/windowReuseManager'\n\nexport default {\n  name: 'SimilarGetMore',\n  props: {\n    message: {\n      type: String,\n      default: ''\n    },\n    targetEquipment: {\n      type: Object,\n      default: () => ({})\n    },\n    type: {\n      type: String,\n      default: 'equip'\n    }\n  },\n  methods: {\n    async goToMoreSimilar() {\n      let externalParams = {}\n      if (this.type === 'equip') {\n        console.log(this.targetEquipment, 'this.targetEquipment')\n        const { equip_name, large_equip_desc, equip_type_desc, icon, equip_face_img, equip_level, kindid, equip_type, iType, serverid, server_name } = this.targetEquipment\n        externalParams = {\n          action: 'similar_equip',\n          equip_type: 'normal',\n          activeTab: 'equip',\n          equip_name,\n          large_equip_desc,\n          equip_type_desc,\n          equip_face_img: equip_face_img || icon,\n          equip_level,\n          kindid,\n          type: iType || equip_type || undefined,\n          serverid,\n          server_name\n        }\n\n        if (window.is_pet_equip(externalParams.kindid)) {\n          externalParams.equip_type = 'pet'\n          //TODO:sssssssssssssssssssss\n        } else if (window.lingshiKinds.some(([kId]) => kId === externalParams.kindid)) {\n          externalParams.equip_type = 'lingshi'\n        }\n\n        if (!externalParams.equip_name) {\n          externalParams.equip_name = this.targetEquipment.name\n        }\n        if (!externalParams.equip_type_desc) {\n          externalParams.equip_type_desc = this.targetEquipment.static_desc\n        }\n      } else if (this.type === 'pet') {\n        //TODO: RoleList跳转的参数需要处理\n        const { equip_sn, role_grade_limit, equip_level, growth, is_baobao, all_skill, sp_skill, evol_skill_list, texing, lx, equip_list, neidan, equip_face_img, serverid, server_name } = this.targetEquipment\n        externalParams = {\n          action: 'similar_pet',\n          activeTab: 'pet',\n          equip_face_img,\n          equip_sn,\n          role_grade_limit,\n          equip_level,\n          growth,\n          is_baobao,\n          all_skill,\n          sp_skill,\n          evol_skill_list,\n          texing,\n          lx,\n          equip_list,\n          neidan,\n          serverid,\n          server_name\n        }\n        console.log(externalParams, 'externalParams')\n      }\n\n      // 尝试复用已存在的窗口\n      console.log('🔍 开始检查可复用的窗口，参数:', externalParams)\n      const existingWindow = await windowReuseManager.checkForExistingWindow(externalParams, 1000)\n      \n      if (existingWindow) {\n        console.log('✅ 找到可复用的窗口:', existingWindow.windowId)\n        \n        // 聚焦到已存在的窗口\n        windowReuseManager.requestFocus(existingWindow.windowId)\n        \n        // 直接更新窗口参数，强制刷新页面\n        console.log('🔄 直接更新窗口参数，强制刷新页面...')\n        windowReuseManager.requestUpdateParams(existingWindow.windowId, externalParams)\n        \n        console.log('🎯 复用已存在的窗口:', existingWindow.windowId)\n        return\n      }\n\n      console.log('❌ 没有找到可复用的窗口，创建新窗口')\n      // 如果没有可复用的窗口，则创建新窗口\n      this.createNewWindow(externalParams)\n    },\n\n    createNewWindow(params) {\n      // 使用qs库将参数转换为URL查询字符串\n      const queryString = qs.stringify(params)\n      const url = `/#/auto-params?${queryString}`\n\n      // 计算窗口位置，使其显示在右下角\n      const screenWidth = window.screen.availWidth\n      const screenHeight = window.screen.availHeight\n      const windowWidth = 1000\n      const windowHeight = 700\n      const left = screenWidth - windowWidth - 20  // 距离右边缘20px\n      const top = screenHeight - windowHeight - 20  // 距离下边缘20px\n      \n      const newWindow = window.open(url, '_blank', `popup=1,location=no,width=${windowWidth},height=${windowHeight},left=${left},top=${top}`)\n      \n      if (newWindow) {\n        console.log('创建新窗口:', url)\n      }\n    }\n  },\n  mounted() {\n    console.log(this.targetEquipment, 'this.targetEquipment')\n  }\n}\n</script>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SimilarGetMore.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SimilarGetMore.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./SimilarGetMore.vue?vue&type=template&id=3602ab8d\"\nimport script from \"./SimilarGetMore.vue?vue&type=script&lang=js\"\nexport * from \"./SimilarGetMore.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-popover',{attrs:{\"data-equip-sn\":_vm.equipment.equip_sn,\"placement\":_vm.placement,\"width\":\"720\",\"trigger\":\"click\",\"popper-class\":\"similar-equip-popper\"},on:{\"show\":_vm.handleShow},scopedSlots:_vm._u([{key:\"reference\",fn:function(){return [_vm._t(\"default\",function(){return [_c('el-link',{staticStyle:{\"font-size\":\"12px\"},attrs:{\"type\":\"primary\"}},[_vm._v(\"查看相似\")])]})]},proxy:true}],null,true),model:{value:(_vm.visible),callback:function ($$v) {_vm.visible=$$v},expression:\"visible\"}},[(_vm.visible)?_c('div',[(_vm.valuationLoading)?_c('div',{staticClass:\"loading-info\"},[_c('el-skeleton',{attrs:{\"rows\":12,\"animated\":\"\"}})],1):(_vm.similarData)?_c('div',[_c('div',{staticClass:\"similar-header\"},[_c('h4',[_vm._v(\"相似装备 (共\"+_vm._s(_vm.similarData.anchor_count)+\"个) \"),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_c('el-tag',{attrs:{\"type\":\"info\",\"size\":\"mini\"}},[_vm._v(\"相似度阈值: \"+_vm._s(_vm.similarData.similarity_threshold))]),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_c('el-tag',{attrs:{\"type\":\"info\",\"size\":\"mini\"}},[_vm._v(\"最大锚点数: \"+_vm._s(_vm.similarData.max_anchors))])],1),_c('EquipmentValuation',{attrs:{\"valuation\":_vm.equipmentValuation,\"target-equipment\":_vm.getEquipImageProps(_vm.equipment)},on:{\"refresh\":_vm.refresh}}),(_vm.similarData.statistics)?_c('div',{staticClass:\"stats\"},[_c('span',[_vm._v(\" 价格范围: \"),_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.formatPrice(_vm.similarData.statistics.price_range.min))}}),_vm._v(\" - \"),_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.formatPrice(_vm.similarData.statistics.price_range.max))}})]),_c('span',[_vm._v(\" 平均相似度: \"+_vm._s(_vm.similarData.statistics.similarity_range.avg.toFixed(3))+\" \")])]):_vm._e()],1),(!_vm.anchorsLoading && !_vm.similarData?.anchors?.length)?_c('el-empty',{attrs:{\"description\":\"暂无数据\"}}):_c('SimilarEquipmentTable',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.anchorsLoading),expression:\"anchorsLoading\"}],attrs:{\"anchors\":_vm.similarData.anchors,\"element-loading-text\":\"正在加载相似装备\"}})],1):_vm._e()]):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"valuation-info\",class:_vm.confidenceClass},[_c('el-row',{attrs:{\"type\":\"flex\",\"align\":\"middle\",\"justify\":\"space-between\"}},[_c('el-row',{attrs:{\"type\":\"flex\",\"align\":\"middle\"}},[_c('EquipmentImage',{attrs:{\"equipment\":_vm.targetEquipment,\"width\":\"50px\",\"height\":\"50px\",\"placement\":\"left\"}}),(_vm.targetEquipment.price)?_c('span',{staticStyle:{\"margin-left\":\"10px\"},domProps:{\"innerHTML\":_vm._s(_vm.formatFullPrice(_vm.targetEquipment))}}):_vm._e(),(_vm.isWeapon)?_c('div',{staticStyle:{\"margin-left\":\"10px\"}},[_c('div',{staticStyle:{\"margin-bottom\":\"5px\"}},[_c('el-tag',{attrs:{\"type\":\"success\"}},[_vm._v(\"属性：+\"+_vm._s(_vm.valuation.feature.addon_total)+\"点\"+_vm._s(_vm.addon_total_standards?.[_vm.valuation.feature.equip_level]))]),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_c('el-tag',{attrs:{\"type\":\"primary\"}},[_vm._v(\"总伤：\"+_vm._s(_vm.valuation.feature.all_damage)+\"/\"+_vm._s(parseInt(_vm.all_damage_standards?.[_vm.valuation.feature.equip_level][1] + (25 * _vm.valuation.feature.equip_level / 30))))])],1),_c('div',[_c('el-tag',{attrs:{\"type\":\"danger\"}},[_vm._v(\"初伤：\"+_vm._s(_vm.valuation.feature.init_damage_raw)+\"点\"+_vm._s(_vm.init_damage_raw_standards?.[_vm.valuation.feature.equip_level]))]),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_c('el-tag',{attrs:{\"type\":\"danger\"}},[_vm._v(\"初总伤：\"+_vm._s(_vm.valuation.feature.init_damage)+\"点\"+_vm._s(_vm.all_damage_standards?.[_vm.valuation.feature.equip_level]))])],1)]):_vm._e()],1),_c('div',{staticStyle:{\"width\":\"170px\",\"flex-shrink\":\"0\"}},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.$emit('refresh')}}},[_vm._v(\"刷新\")]),_c('SimilarGetMore',{attrs:{\"target-equipment\":_vm.targetEquipment}})],1)],1),_c('div',{staticClass:\"valuation-main\"},[_c('span',{staticClass:\"valuation-label\"},[_vm._v(\"装备估价:\")]),_c('span',{staticClass:\"valuation-price\"},[_vm._v(_vm._s(_vm.valuation?.estimated_price_yuan || '-')+\"元\")]),_c('span',{staticClass:\"valuation-strategy\"},[_vm._v(\"(\"+_vm._s(_vm.valuation ? _vm.getStrategyName(_vm.valuation.strategy) : '-')+\")\")]),_c('el-link',{attrs:{\"type\":\"danger\",\"size\":\"mini\"},nativeOn:{\"click\":function($event){return _vm.markAsAbnormal.apply(null, arguments)}}},[_vm._v(\"标记为异常\")]),(_vm.priceRatio)?_c('span',{staticClass:\"price-ratio\"},[_c('el-tag',{attrs:{\"type\":_vm.priceRatioTagType,\"disable-transitions\":\"\"}},[_vm._v(\" \"+_vm._s(_vm.priceRatioText)+\" \")])],1):_vm._e()],1),_c('div',{staticClass:\"valuation-details\"},[_c('span',{staticClass:\"confidence-display\",class:_vm.confidenceTextClass},[_c('i',{class:_vm.confidenceIcon}),_vm._v(\" 置信度: \"+_vm._s(_vm.valuation ? (_vm.valuation.confidence * 100).toFixed(1) + '%' : '-')+\" \"),_c('span',{staticClass:\"confidence-level\"},[_vm._v(_vm._s(_vm.confidenceLevel))])]),_c('span',[_vm._v(\"基于\"+_vm._s(_vm.valuation.anchor_count)+\"个锚点\")]),(_vm.priceRatio)?_c('span',[_vm._v(\"估价比率: \"+_vm._s((_vm.priceRatio * 100).toFixed(1))+\"%\")]):_vm._e()])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"valuation-info\" :class=\"confidenceClass\">\r\n    <el-row type=\"flex\" align=\"middle\" justify=\"space-between\">\r\n      <el-row type=\"flex\" align=\"middle\">\r\n        <EquipmentImage :equipment=\"targetEquipment\" width=\"50px\" height=\"50px\" placement=\"left\" />\r\n        <span v-if=\"targetEquipment.price\" v-html=\"formatFullPrice(targetEquipment)\" style=\"margin-left: 10px\"></span>\r\n        <div v-if=\"isWeapon\" style=\"margin-left: 10px\">\r\n          <div style=\"margin-bottom: 5px\"> <el-tag type=\"success\">属性：+{{ valuation.feature.addon_total }}点{{\r\n            addon_total_standards?.[valuation.feature.equip_level] }}</el-tag>\r\n            <el-divider direction=\"vertical\" />\r\n            <el-tag type=\"primary\">总伤：{{ valuation.feature.all_damage }}/{{\r\n              parseInt(all_damage_standards?.[valuation.feature.equip_level][1]\r\n                + (25 * valuation.feature.equip_level / 30)) }}</el-tag>\r\n          </div>\r\n          <div>\r\n            <el-tag type=\"danger\">初伤：{{ valuation.feature.init_damage_raw }}点{{\r\n              init_damage_raw_standards?.[valuation.feature.equip_level] }}</el-tag>\r\n            <el-divider direction=\"vertical\" />\r\n            <el-tag type=\"danger\">初总伤：{{ valuation.feature.init_damage }}点{{\r\n              all_damage_standards?.[valuation.feature.equip_level] }}</el-tag>\r\n          </div>\r\n        </div>\r\n      </el-row>\r\n      <!-- 刷新和相似装备界面 -->\r\n      <div style=\"width: 170px;flex-shrink: 0;\">\r\n        <el-button type=\"primary\" @click=\"$emit('refresh')\" size=\"mini\">刷新</el-button>\r\n        <SimilarGetMore :target-equipment=\"targetEquipment\" />\r\n      </div>\r\n    </el-row>\r\n    <div class=\"valuation-main\">\r\n      <span class=\"valuation-label\">装备估价:</span>\r\n      <span class=\"valuation-price\">{{ valuation?.estimated_price_yuan || '-' }}元</span>\r\n      <span class=\"valuation-strategy\">({{ valuation ? getStrategyName(valuation.strategy) : '-' }})</span>\r\n      <el-link type=\"danger\" @click.native=\"markAsAbnormal\" size=\"mini\">标记为异常</el-link>\r\n\r\n      <!-- 价格比率显示 -->\r\n      <span v-if=\"priceRatio\" class=\"price-ratio\">\r\n        <el-tag :type=\"priceRatioTagType\" disable-transitions>\r\n          {{ priceRatioText }}\r\n        </el-tag>\r\n      </span>\r\n    </div>\r\n    <div class=\"valuation-details\">\r\n      <span class=\"confidence-display\" :class=\"confidenceTextClass\">\r\n        <i :class=\"confidenceIcon\"></i>\r\n        置信度: {{ valuation ? (valuation.confidence * 100).toFixed(1) + '%' : '-' }}\r\n        <span class=\"confidence-level\">{{ confidenceLevel }}</span>\r\n      </span>\r\n      <span>基于{{ valuation.anchor_count }}个锚点</span>\r\n      <span v-if=\"priceRatio\">估价比率: {{ (priceRatio * 100).toFixed(1) }}%</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport EquipmentImage from './EquipmentImage/EquipmentImage.vue'\r\nimport { equipmentMixin } from '@/utils/mixins/equipmentMixin'\r\nimport { commonMixin } from '@/utils/mixins/commonMixin'\r\nimport SimilarGetMore from './SimilarGetMore.vue'\r\n\r\nexport default {\r\n  name: 'EquipmentValuation',\r\n  components: {\r\n    EquipmentImage,\r\n    SimilarGetMore\r\n  },\r\n  mixins: [equipmentMixin, commonMixin],\r\n  props: {\r\n    valuation: {\r\n      type: Object,\r\n      default: null\r\n    },\r\n    targetEquipment: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      weaponConfig: null,\r\n      addon_total_standards: null,\r\n      all_damage_standards: null,\r\n      init_damage_raw_standards: null,\r\n    }\r\n  },\r\n  computed: {\r\n    isWeapon() {\r\n      return window.is_weapon_equip(this.valuation?.feature?.kindid)\r\n    },\r\n    // 计算估价与售价的比率\r\n    priceRatio() {\r\n      if (!this.valuation || !this.valuation.estimated_price_yuan || !this.targetEquipment.price) {\r\n        return null\r\n      }\r\n\r\n      const estimatedPrice = parseFloat(this.valuation.estimated_price_yuan)\r\n      const sellingPrice = parseFloat(this.targetEquipment.price) / 100 // 转换为元\r\n\r\n      if (sellingPrice === 0) return null\r\n\r\n      return estimatedPrice / sellingPrice\r\n    },\r\n    priceRatioTagType() {\r\n      if (!this.priceRatio) return ''\r\n      const ratio = this.priceRatio\r\n      const deviation = Math.abs(ratio - 1) * 100\r\n      if (deviation < 5) {\r\n        return 'success'\r\n      } else if (deviation < 10) {\r\n        return 'info'\r\n      } else if (deviation < 20) {\r\n        return 'warning'\r\n      } else {\r\n        return 'danger'\r\n      }\r\n    },\r\n    priceRatioText() {\r\n      if (!this.priceRatio) return ''\r\n      const ratio = this.priceRatio\r\n      const deviation = Math.abs(ratio - 1) * 100\r\n      if (deviation < 5) {\r\n        return `估价极为贴合市场（±${deviation.toFixed(1)}%）`\r\n      } else if (deviation < 10) {\r\n        return `估价较为贴合（±${deviation.toFixed(1)}%）`\r\n      } else if (deviation < 20) {\r\n        return `估价有一定偏差（±${deviation.toFixed(1)}%）`\r\n      } else if (ratio > 1) {\r\n        return `估价高于市场（+${((ratio - 1) * 100).toFixed(1)}%）`\r\n      } else {\r\n        return `估价低于市场（-${((1 - ratio) * 100).toFixed(1)}%）`\r\n      }\r\n    },\r\n    // 根据置信度返回对应的CSS类\r\n    confidenceClass() {\r\n      if (!this.valuation || !this.valuation.confidence) {\r\n        return 'confidence-extremely-low'\r\n      }\r\n      \r\n      const confidence = this.valuation.confidence\r\n      \r\n      if (confidence >= 0.8) {\r\n        return 'confidence-high'        // >= 80%: 高置信度 (绿色)\r\n      } else if (confidence >= 0.6) {\r\n        return 'confidence-medium'      // 60-79%: 中等置信度 (蓝色)\r\n      } else if (confidence >= 0.4) {\r\n        return 'confidence-low'         // 40-59%: 较低置信度 (灰色)\r\n      } else if (confidence >= 0.2) {\r\n        return 'confidence-very-low'    // 20-39%: 很低置信度 (橙色)\r\n      } else {\r\n        return 'confidence-extremely-low' // < 20%: 极低置信度 (红色)\r\n      }\r\n    },\r\n    // 置信度文本颜色类\r\n    confidenceTextClass() {\r\n      if (!this.valuation || !this.valuation.confidence) {\r\n        return 'text-danger'\r\n      }\r\n      \r\n      const confidence = this.valuation.confidence\r\n      \r\n      if (confidence >= 0.8) {\r\n        return 'text-success'\r\n      } else if (confidence >= 0.6) {\r\n        return 'text-primary'\r\n      } else if (confidence >= 0.4) {\r\n        return 'text-info'\r\n      } else if (confidence >= 0.2) {\r\n        return 'text-warning'\r\n      } else {\r\n        return 'text-danger'\r\n      }\r\n    },\r\n    // 置信度图标\r\n    confidenceIcon() {\r\n      if (!this.valuation || !this.valuation.confidence) {\r\n        return 'el-icon-warning'\r\n      }\r\n      \r\n      const confidence = this.valuation.confidence\r\n      \r\n      if (confidence >= 0.8) {\r\n        return 'el-icon-success'\r\n      } else if (confidence >= 0.6) {\r\n        return 'el-icon-info'\r\n      } else if (confidence >= 0.4) {\r\n        return 'el-icon-question'\r\n      } else if (confidence >= 0.2) {\r\n        return 'el-icon-warning'\r\n      } else {\r\n        return 'el-icon-error'\r\n      }\r\n    },\r\n    // 置信度等级描述\r\n    confidenceLevel() {\r\n      if (!this.valuation || !this.valuation.confidence) {\r\n        return '(数据缺失)'\r\n      }\r\n      \r\n      const confidence = this.valuation.confidence\r\n      \r\n      if (confidence >= 0.8) {\r\n        return '(高)'\r\n      } else if (confidence >= 0.6) {\r\n        return '(中)'\r\n      } else if (confidence >= 0.4) {\r\n        return '(偏低)'\r\n      } else if (confidence >= 0.2) {\r\n        return '(很低)'\r\n      } else {\r\n        return '(极低)'\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    getWeaponConfig() {\r\n      this.$api.equipment.getWeaponConfig().then(res => {\r\n        if (res.code === 200) {\r\n          this.weaponConfig = res.data\r\n          this.addon_total_standards = res.data.addon_total_standards\r\n          this.all_damage_standards = res.data.all_damage_standards\r\n          this.init_damage_raw_standards = res.data.init_damage_raw_standards\r\n        }\r\n      })\r\n    },\r\n    async markAsAbnormal() {\r\n      try {\r\n        // 调用API标记装备为异常\r\n        const response = await this.$api.equipment.markEquipmentAsAbnormal({\r\n          equipment_data: this.targetEquipment,\r\n          reason: '标记异常',\r\n          notes: '用户手动标记的异常装备'\r\n        })\r\n\r\n        if (response.code === 200) {\r\n          this.$notify.success({\r\n            title: '提示',\r\n            message: '装备已标记为异常'\r\n          })\r\n          // 可以触发父组件刷新或其他操作\r\n          this.$emit('abnormal-marked', this.targetEquipment)\r\n        } else {\r\n          this.$notify.error({\r\n            title: '提示',\r\n            message: response.message || '标记异常失败'\r\n          })\r\n        }\r\n      } catch (error) {\r\n        console.error('标记异常失败:', error)\r\n        this.$notify.error({\r\n          title: '提示',\r\n          message: '标记异常失败，请稍后重试'\r\n        })\r\n      }\r\n    },\r\n    getStrategyName(strategy) {\r\n      const strategyNames = {\r\n        fair_value: '公允价值',\r\n        competitive: '竞争价格',\r\n        premium: '溢价估值'\r\n      }\r\n      return strategyNames[strategy] || strategy\r\n    },\r\n  },\r\n  mounted() {\r\n    if (this.isWeapon) {\r\n      this.getWeaponConfig()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.valuation-info {\r\n  margin: 12px 0;\r\n  padding: 12px;\r\n  background-color: #f8f9fa;\r\n  border-radius: 6px;\r\n  border-left: 4px solid #409eff;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.valuation-main {\r\n  font-size: 14px;\r\n  display: flex;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n}\r\n\r\n.valuation-label {\r\n  color: #606266;\r\n  font-weight: 500;\r\n}\r\n\r\n.valuation-price {\r\n  color: #e6a23c;\r\n  font-weight: 600;\r\n  font-size: 16px;\r\n}\r\n\r\n.valuation-strategy {\r\n  color: #909399;\r\n  font-size: 12px;\r\n}\r\n\r\n.valuation-details {\r\n  display: flex;\r\n  gap: 15px;\r\n  font-size: 12px;\r\n  color: #909399;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.confidence-display {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n  font-weight: 500;\r\n}\r\n\r\n.confidence-display i {\r\n  font-size: 14px;\r\n}\r\n\r\n.confidence-level {\r\n  font-size: 11px;\r\n  opacity: 0.8;\r\n}\r\n\r\n/* 置信度文本颜色 */\r\n.text-success {\r\n  color: #67c23a !important;\r\n}\r\n\r\n.text-primary {\r\n  color: #409eff !important;\r\n}\r\n\r\n.text-info {\r\n  color: #909399 !important;\r\n}\r\n\r\n.text-warning {\r\n  color: #e6a23c !important;\r\n}\r\n\r\n.text-danger {\r\n  color: #f56c6c !important;\r\n}\r\n/* 根据置信度的颜色变化 */\r\n.valuation-info.confidence-high {\r\n  border-left: 4px solid #67c23a;\r\n  /* 绿色 - 高置信度 */\r\n  background: linear-gradient(270deg, #f0f9ff 0%, #e1f3d8 100%);\r\n}\r\n\r\n.valuation-info.confidence-medium {\r\n  border-left: 4px solid #409eff;\r\n  /* 蓝色 - 中等置信度 */\r\n  background: linear-gradient(270deg, #f0f8ff 0%, #e1f5fe 100%);\r\n}\r\n\r\n.valuation-info.confidence-low {\r\n  border-left: 4px solid #909399;\r\n  /* 灰色 - 较低置信度 */\r\n  background: linear-gradient(270deg, #f8f9fa 0%, #e9ecef 100%);\r\n}\r\n\r\n.valuation-info.confidence-very-low {\r\n  border-left: 4px solid #e6a23c;\r\n  /* 橙色 - 很低置信度 */\r\n  background: linear-gradient(270deg, #fdf6ec 0%, #fdf2e9 100%);\r\n}\r\n\r\n.valuation-info.confidence-extremely-low {\r\n  border-left: 4px solid #f56c6c;\r\n  /* 红色 - 极低置信度 */\r\n  background: linear-gradient(270deg, #fef0f0 0%, #fde2e2 100%);\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EquipmentValuation.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EquipmentValuation.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./EquipmentValuation.vue?vue&type=template&id=c5a9f81a&scoped=true\"\nimport script from \"./EquipmentValuation.vue?vue&type=script&lang=js\"\nexport * from \"./EquipmentValuation.vue?vue&type=script&lang=js\"\nimport style0 from \"./EquipmentValuation.vue?vue&type=style&index=0&id=c5a9f81a&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c5a9f81a\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.anchors,\"stripe\":\"\",\"max-height\":\"300\",\"sortable\":\"\",\"sort-by\":['price', 'similarity'],\"sort-order\":['ascending', 'descending']}},[_c('el-table-column',{attrs:{\"fixed\":\"\",\"prop\":\"price\",\"label\":\"价格 (元)\",\"width\":\"100\",\"sortable\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.formatFullPrice(scope.row,true))}})]}}])}),_c('el-table-column',{attrs:{\"fixed\":\"\",\"label\":\"装备\",\"width\":\"70\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('equipment-image',{attrs:{\"equipment\":scope.row}})]}}])}),_c('el-table-column',{attrs:{\"prop\":\"similarity\",\"label\":\"相似度\",\"width\":\"80\",\"sortable\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tag',{attrs:{\"type\":_vm.getSimilarityTagType(scope.row.similarity)}},[_vm._v(\" \"+_vm._s(scope.row.similarity)+\" \")])]}}])}),_c('el-table-column',{attrs:{\"prop\":\"equip_level\",\"label\":\"等级\",\"width\":\"60\"}}),_c('el-table-column',{attrs:{\"label\":\"特技/特效/套装\",\"min-width\":\"120\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('div',{staticClass:\"special-info\"},[_c('div',{staticClass:\"equip_desc_blue\",attrs:{\"data-specia-effet\":scope.row.special_effect,\"data-special-skill\":scope.row.special_skill}}),_c('p',{domProps:{\"innerHTML\":_vm._s(_vm.formatSpecialSkillsAndEffects(scope.row))}}),_c('p',[_vm._v(\" \"+_vm._s(_vm.formatSuitEffect(scope.row)))])])]}}])}),_c('el-table-column',{attrs:{\"prop\":\"server_name\",\"label\":\"服务器\",\"width\":\"80\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(_vm._s(scope.row.server_name))]),_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.formatFullPrice(scope.row,'cross'))}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"80\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-link',{attrs:{\"href\":_vm.getCBGLinkByType(scope.row.eid, 'equip'),\"type\":\"danger\",\"target\":\"_blank\"}},[_vm._v(\"藏宝阁\")])]}}])})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-table\r\n    v-loading=\"loading\"\r\n    :data=\"anchors\"\r\n    stripe\r\n    max-height=\"300\"\r\n    style=\"width: 100%\"\r\n    sortable\r\n    :sort-by=\"['price', 'similarity']\"\r\n    :sort-order=\"['ascending', 'descending']\"\r\n  >\r\n    <el-table-column fixed prop=\"price\" label=\"价格 (元)\" width=\"100\" sortable>\r\n      <template #default=\"scope\">\r\n        <div v-html=\"formatFullPrice(scope.row,true)\"></div>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column fixed label=\"装备\" width=\"70\">\r\n      <template #default=\"scope\">\r\n        <equipment-image :equipment=\"scope.row\" />\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column prop=\"similarity\" label=\"相似度\" width=\"80\" sortable>\r\n      <template #default=\"scope\">\r\n        <el-tag :type=\"getSimilarityTagType(scope.row.similarity)\">\r\n          {{ scope.row.similarity }}\r\n        </el-tag>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column prop=\"equip_level\" label=\"等级\" width=\"60\"></el-table-column>\r\n    <el-table-column label=\"特技/特效/套装\" min-width=\"120\">\r\n      <template #default=\"scope\">\r\n        <div class=\"special-info\">\r\n          <div\r\n            class=\"equip_desc_blue\"\r\n            :data-specia-effet=\"scope.row.special_effect\"\r\n            :data-special-skill=\"scope.row.special_skill\"\r\n          ></div>\r\n         <p v-html=\"formatSpecialSkillsAndEffects(scope.row)\"></p>\r\n          <p>  {{ formatSuitEffect(scope.row) }}</p>\r\n        </div>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column prop=\"server_name\" label=\"服务器\" width=\"80\">\r\n      <template #default=\"scope\">\r\n        <span>{{ scope.row.server_name }}</span>\r\n        <div v-html=\"formatFullPrice(scope.row,'cross')\"></div>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column label=\"操作\" width=\"80\">\r\n      <template #default=\"scope\">\r\n        <el-link :href=\"getCBGLinkByType(scope.row.eid, 'equip')\" type=\"danger\" target=\"_blank\">藏宝阁</el-link>\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n</template>\r\n\r\n<script>\r\nimport EquipmentImage from './EquipmentImage/EquipmentImage.vue'\r\nimport { equipmentMixin } from '@/utils/mixins/equipmentMixin'\r\nimport { commonMixin } from '@/utils/mixins/commonMixin'\r\n\r\nexport default {\r\n  name: 'SimilarEquipmentTable',\r\n  components: {\r\n    EquipmentImage\r\n  },\r\n  mixins: [equipmentMixin, commonMixin],\r\n  props: {\r\n    anchors: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    loading: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  methods: {\r\n\r\n    // 获取特效名称\r\n    getSpecialEffectName(id) {\r\n      // 直接使用全局变量\r\n      if (window.AUTO_SEARCH_CONFIG && window.AUTO_SEARCH_CONFIG.equip_special_effect) {\r\n        const effectName = window.AUTO_SEARCH_CONFIG.equip_special_effect[id.toString()]\r\n        if (effectName) return effectName\r\n      }\r\n\r\n      return `特效${id}`\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.special-info {\r\n  font-size: 12px;\r\n  color: #409eff;\r\n}\r\n\r\n.special-info .skill {\r\n  margin-bottom: 2px;\r\n}\r\n\r\n.cbg-link {\r\n  color: #409eff;\r\n  padding: 0;\r\n}\r\n\r\n.cbg-link:hover {\r\n  color: #66b1ff;\r\n}\r\n</style> ","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SimilarEquipmentTable.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SimilarEquipmentTable.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./SimilarEquipmentTable.vue?vue&type=template&id=9e54bfd6&scoped=true\"\nimport script from \"./SimilarEquipmentTable.vue?vue&type=script&lang=js\"\nexport * from \"./SimilarEquipmentTable.vue?vue&type=script&lang=js\"\nimport style0 from \"./SimilarEquipmentTable.vue?vue&type=style&index=0&id=9e54bfd6&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9e54bfd6\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <el-popover :data-equip-sn=\"equipment.equip_sn\" :placement=\"placement\" width=\"720\" trigger=\"click\"\r\n    popper-class=\"similar-equip-popper\" v-model=\"visible\" @show=\"handleShow\">\r\n    <template #reference>\r\n      <slot>\r\n        <el-link type=\"primary\" style=\"font-size: 12px;\">查看相似</el-link>\r\n      </slot>\r\n    </template>\r\n\r\n    <!-- 相似装备内容 -->\r\n    <div v-if=\"visible\">\r\n      <!-- 加载状态 -->\r\n      <div v-if=\"valuationLoading\" class=\"loading-info\">\r\n        <el-skeleton :rows=\"12\" animated />\r\n      </div>\r\n      <div v-else-if=\"similarData\">\r\n        <div class=\"similar-header\">\r\n          <h4>相似装备 (共{{ similarData.anchor_count }}个) <el-divider direction=\"vertical\" />\r\n            <el-tag type=\"info\" size=\"mini\">相似度阈值: {{ similarData.similarity_threshold }}</el-tag>\r\n            <el-divider direction=\"vertical\" />\r\n            <el-tag type=\"info\" size=\"mini\">最大锚点数: {{ similarData.max_anchors }}</el-tag>\r\n          </h4>\r\n          <!-- 装备估价信息 -->\r\n          <EquipmentValuation :valuation=\"equipmentValuation\" :target-equipment=\"getEquipImageProps(equipment)\"\r\n            @refresh=\"refresh\" />\r\n          <div v-if=\"similarData.statistics\" class=\"stats\">\r\n            <span>\r\n              价格范围:\r\n              <span v-html=\"formatPrice(similarData.statistics.price_range.min)\"></span>\r\n              -\r\n              <span v-html=\"formatPrice(similarData.statistics.price_range.max)\"></span>\r\n            </span>\r\n            <span> 平均相似度: {{ similarData.statistics.similarity_range.avg.toFixed(3) }} </span>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 相似装备表格 -->\r\n        <el-empty v-if=\"!anchorsLoading && !similarData?.anchors?.length\" description=\"暂无数据\"></el-empty>\r\n        <SimilarEquipmentTable v-else :anchors=\"similarData.anchors\" v-loading=\"anchorsLoading\" element-loading-text=\"正在加载相似装备\"/>\r\n      </div>\r\n    </div>\r\n  </el-popover>\r\n</template>\r\n\r\n<script>\r\nimport EquipmentValuation from './EquipmentValuation.vue'\r\nimport SimilarEquipmentTable from './SimilarEquipmentTable.vue'\r\nimport { equipmentMixin } from '@/utils/mixins/equipmentMixin'\r\nimport { commonMixin } from '@/utils/mixins/commonMixin'\r\n\r\nexport default {\r\n  name: 'SimilarEquipmentModal',\r\n  components: {\r\n    EquipmentValuation,\r\n    SimilarEquipmentTable\r\n  },\r\n  mixins: [equipmentMixin, commonMixin],\r\n  props: {\r\n    equipment: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    placement: {\r\n      type: String,\r\n      default: 'left-end'\r\n    },\r\n    similarityThreshold: {\r\n      type: Number,\r\n      default: 0.8\r\n    },\r\n    maxAnchors: {\r\n      type: Number,\r\n      default: 30\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      valuationLoading: false,  // 装备估价接口加载状态\r\n      anchorsLoading: false,    // 相似装备锚点接口加载状态\r\n      error: false,\r\n      similarData: null,\r\n      equipmentValuation: {}\r\n    }\r\n  },\r\n  computed: {\r\n    // 整体加载状态\r\n    loading() {\r\n      return this.valuationLoading || this.anchorsLoading\r\n    }\r\n  },\r\n  methods: {\r\n    async handleShow() {\r\n      if (!this.similarData) {\r\n        await this.loadSimilarEquipments()\r\n      }\r\n    },\r\n\r\n    async refresh() {\r\n      await this.loadSimilarEquipments()\r\n    },\r\n\r\n    // 加载相似装备\r\n    async loadSimilarEquipments() {\r\n      this.error = false\r\n      this.equipmentValuation = {}\r\n      this.similarData = null\r\n\r\n      try {\r\n        await this.loadEquipmentValuation(this.equipment, this.similarityThreshold)\r\n      } catch (error) {\r\n        console.error('加载相似装备失败:', error)\r\n        this.error = true\r\n      }\r\n    },\r\n\r\n    // 统一的装备估价加载方法\r\n    async loadEquipmentValuation(equipment, similarityThreshold) {\r\n      try {\r\n        // 第一个接口：获取装备估价信息\r\n        this.valuationLoading = true\r\n        if (window.is_pet_equip(equipment.kindid)) {\r\n          equipment = {\r\n            kindid: 29,\r\n            desc: equipment.desc\r\n          }\r\n        }\r\n        const response = await this.$api.equipment.getEquipmentValuation({\r\n          equipment_data: equipment,\r\n          strategy: 'fair_value',\r\n          similarity_threshold: similarityThreshold,\r\n          max_anchors: this.maxAnchors\r\n        })\r\n\r\n        const result = response.data\r\n        this.equipmentValuation = result\r\n\r\n        // 向父组件发出估价结果更新事件\r\n        this.$emit('valuation-updated', result)\r\n\r\n        // 初始化相似装备数据\r\n        this.similarData = {\r\n          anchor_count: result.anchor_count,\r\n          similarity_threshold: result.similarity_threshold || similarityThreshold,\r\n          max_anchors: result.max_anchors || this.maxAnchors,\r\n          anchors: [],\r\n          statistics: {\r\n            price_range: result.anchor_count?{\r\n              min: Math.min(...result.anchors.map((a) => a.price || 0)),\r\n              max: Math.max(...result.anchors.map((a) => a.price || 0)),\r\n              avg: result.anchors.reduce((sum, a) => sum + (a.price || 0), 0) / result.anchors.length\r\n            }:{\r\n              min:0,\r\n              max:0,\r\n              avg:0\r\n            },\r\n            similarity_range: result.anchor_count?{\r\n              min: Math.min(...result.anchors.map((a) => a.similarity || 0)),\r\n              max: Math.max(...result.anchors.map((a) => a.similarity || 0)),\r\n              avg: result.anchors.reduce((sum, a) => sum + (a.similarity || 0), 0) / result.anchors.length\r\n            }:{\r\n              min:0,\r\n              max:0,\r\n              avg:0\r\n            }\r\n          }\r\n        }\r\n\r\n        this.valuationLoading = false\r\n\r\n        // 处理估价响应，如果有锚点数据则加载详细信息\r\n        if (result?.anchor_count > 0 && result?.anchors?.length > 0) {\r\n          // 第二个接口：获取相似装备锚点详细数据\r\n          this.anchorsLoading = true\r\n\r\n          try {\r\n            // 使用估价结果中的equip_sn_list直接获取相似装备列表，避免重复计算\r\n            const anchorsResponse = await this.$api.equipment.getEquipmentList({\r\n              page_size: 99,\r\n              equip_sn_list: result.anchors.map(item => item.equip_sn)\r\n            })\r\n\r\n            this.anchorsLoading = false\r\n            // 合并相似度和数据\r\n            if (anchorsResponse.code === 200 && anchorsResponse.data?.data) {\r\n              const anchorsData = anchorsResponse.data.data\r\n              const parsedAnchors = anchorsData.map((item, index) => {\r\n                // 添加相似度信息\r\n                item.similarity = result.anchors[index].similarity\r\n                item.features = result.anchors[index].features\r\n                return item\r\n              })\r\n\r\n              // 更新相似装备数据\r\n              this.$set(this.similarData, 'anchors', parsedAnchors)\r\n            } else {\r\n              console.warn('未获取到相似装备锚点数据:', anchorsResponse.message)\r\n            }\r\n          } catch (error) {\r\n            console.error('查询相似装备锚点失败:', error)\r\n            // 锚点查询失败不影响估价结果显示\r\n          }\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('装备估价失败:', error)\r\n        this.$notify.error({\r\n          title: '估价请求失败',\r\n          message: '网络请求异常，请稍后重试',\r\n          duration: 3000\r\n        })\r\n        throw error\r\n      } finally {\r\n        // 确保在出现异常时也重置加载状态\r\n        this.valuationLoading = false\r\n        this.anchorsLoading = false\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.similar-header {\r\n  margin-bottom: 16px;\r\n  padding-bottom: 12px;\r\n  border-bottom: 1px solid #ebeef5;\r\n}\r\n\r\n.similar-header h4 {\r\n  margin: 0 0 8px 0;\r\n  color: #303133;\r\n  font-size: 16px;\r\n}\r\n\r\n.similar-header p {\r\n  margin: 0 0 8px 0;\r\n  color: #606266;\r\n  font-size: 14px;\r\n}\r\n\r\n.stats {\r\n  display: flex;\r\n  gap: 20px;\r\n  font-size: 12px;\r\n  color: #909399;\r\n}\r\n\r\n.error-info {\r\n  padding: 20px 0;\r\n}\r\n\r\n.loading-info {\r\n  padding: 20px;\r\n}\r\n\r\n.loading-status {\r\n  margin-bottom: 16px;\r\n}\r\n\r\n.loading-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 8px;\r\n  color: #409eff;\r\n  font-size: 14px;\r\n}\r\n\r\n.loading-item i {\r\n  margin-right: 8px;\r\n  animation: rotating 2s linear infinite;\r\n}\r\n\r\n@keyframes rotating {\r\n  from {\r\n    transform: rotate(0deg);\r\n  }\r\n\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SimilarEquipmentModal.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SimilarEquipmentModal.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./SimilarEquipmentModal.vue?vue&type=template&id=8d4f6d00&scoped=true\"\nimport script from \"./SimilarEquipmentModal.vue?vue&type=script&lang=js\"\nexport * from \"./SimilarEquipmentModal.vue?vue&type=script&lang=js\"\nimport style0 from \"./SimilarEquipmentModal.vue?vue&type=style&index=0&id=8d4f6d00&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8d4f6d00\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","on","goToMoreSimilar","_v","staticRenderFns","name","props","message","type","String","default","targetEquipment","Object","methods","externalParams","console","log","equip_name","large_equip_desc","equip_type_desc","icon","equip_face_img","equip_level","kindid","equip_type","iType","serverid","server_name","action","activeTab","undefined","window","is_pet_equip","lingshiKinds","some","kId","static_desc","equip_sn","role_grade_limit","growth","is_baobao","all_skill","sp_skill","evol_skill_list","texing","lx","equip_list","neidan","existingWindow","windowReuseManager","checkForExistingWindow","windowId","requestFocus","requestUpdateParams","createNewWindow","params","queryString","qs","url","screenWidth","screen","availWidth","screenHeight","availHeight","windowWidth","windowHeight","left","top","newWindow","open","mounted","component","equipment","placement","handleShow","scopedSlots","_u","key","fn","_t","staticStyle","proxy","model","value","visible","callback","$$v","expression","valuationLoading","staticClass","similarData","_s","anchor_count","similarity_threshold","max_anchors","equipmentValuation","getEquipImageProps","refresh","statistics","domProps","formatPrice","price_range","min","max","similarity_range","avg","toFixed","_e","anchorsLoading","anchors","length","directives","rawName","class","confidenceClass","price","formatFullPrice","isWeapon","valuation","feature","addon_total","addon_total_standards","all_damage","parseInt","all_damage_standards","init_damage_raw","init_damage_raw_standards","init_damage","$event","$emit","estimated_price_yuan","getStrategyName","strategy","nativeOn","markAsAbnormal","apply","arguments","priceRatio","priceRatioTagType","priceRatioText","confidenceTextClass","confidenceIcon","confidence","confidenceLevel","components","EquipmentImage","SimilarGetMore","mixins","equipmentMixin","commonMixin","required","data","weaponConfig","computed","is_weapon_equip","estimatedPrice","parseFloat","sellingPrice","ratio","deviation","Math","abs","getWeaponConfig","$api","then","res","code","response","markEquipmentAsAbnormal","equipment_data","reason","notes","$notify","success","title","error","strategyNames","fair_value","competitive","premium","loading","scope","row","getSimilarityTagType","similarity","special_effect","special_skill","formatSpecialSkillsAndEffects","formatSuitEffect","getCBGLinkByType","eid","Array","Boolean","getSpecialEffectName","id","AUTO_SEARCH_CONFIG","equip_special_effect","effectName","toString","EquipmentValuation","SimilarEquipmentTable","similarityThreshold","Number","maxAnchors","loadSimilarEquipments","loadEquipmentValuation","desc","getEquipmentValuation","result","map","a","reduce","sum","anchorsResponse","getEquipmentList","page_size","equip_sn_list","item","anchorsData","parsedAnchors","index","features","$set","warn","duration"],"sourceRoot":""}